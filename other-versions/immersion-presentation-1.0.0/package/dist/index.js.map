{"version":3,"file":"index.js","sources":["../src/utils.js","../src/Citations.js","../src/PresenterNotes.js","../node_modules/lodash/_arrayPush.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/_isFlattenable.js","../node_modules/lodash/_baseFlatten.js","../node_modules/lodash/flattenDeep.js","../src/lib/morph.js","../src/AnimationEditor.js","../src/Morph.js","../src/staticAnalysis.js","../src/animations.js","../src/Presentation.js","../src/themes/modern/index.js","../src/AnimateSVG.js","../src/LaTeX.js","../src/MObject.js","../src/Portal.js","../src/index.js"],"sourcesContent":["import memoize from 'memoizee'\n\nimport { useEffect, useRef, useState } from 'react'\n\nimport md5 from 'md5'\n\nexport const range = (n) => [...Array(n).keys()]\n\nconst defaultTranslations = {\n  _: '',\n  h: { opacity: 0 },\n  v: { opacity: 1 },\n  p: { opacity: 0.3 },\n  d: { drawSVG: 0 },\n  D: { drawSVG: '0 100%' },\n  x: true\n}\n\nexport function timeline(obj) {\n  const stepsByKey = Object.entries(obj).map(([key, thing]) => {\n    let steps, translations\n    if (typeof thing == 'string') {\n      steps = thing\n      translations = {}\n    } else {\n      ;[steps, translations = {}] = thing\n    }\n    const translated = []\n    let number = 0\n    const translate = (s) =>\n      translations.hasOwnProperty(s)\n        ? translations[s]\n        : defaultTranslations.hasOwnProperty(s)\n        ? defaultTranslations[s]\n        : s\n    steps.split('').forEach((step) => {\n      const prev = translated[translated.length - 1]\n      if (step === ' ') {\n        translated.push(prev)\n        return\n      }\n      if (step === '+') {\n        number += 1\n        translated.push(translate(number))\n        return\n      }\n      if (step === '-') {\n        number -= 1\n        translated.push(translate(number))\n        return\n      }\n      // if (step === ' ') { translated.push(null); return; }\n\n      const n = parseInt(step)\n      if (!isNaN(n)) {\n        number = n\n        translated.push(translate(number))\n        return\n      }\n      translated.push(translate(step))\n    })\n    return [key, translated]\n  })\n\n  const result = range(stepsByKey[0][1].length).map((stepIndex) => {\n    return Object.fromEntries(\n      stepsByKey.map(([key, steps]) => [key, steps[stepIndex]])\n    )\n  })\n  // console.table(result)\n  return result\n}\n\nexport const hashString = function (str) {\n  var hash = 0,\n    i,\n    chr\n  if (str.length === 0) return hash\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i)\n    hash = (hash << 5) - hash + chr\n    hash |= 0 // Convert to 32bit integer\n  }\n  return hash\n}\n\n// TODO: memoize , but be more smart => each time return different id!\nexport const fetchLaTeXSvg = async (tex) => {\n  const text = await fetchLaTeXSvghelper(tex)\n  const ele = document.createElement('div')\n  ele.innerHTML = text\n\n  const svg = ele.querySelector('svg')\n  if (!svg) {\n    console.error(`Couldn't compile ${tex}`)\n    return null\n  }\n\n  // This makes the id's of the elements in the svg unique over the whole document.\n  const rootId = 'r' + Math.floor(Math.random() * 100000)\n  ;[...svg.querySelectorAll('[id]')].forEach((ele) => {\n    ele.classList.add(ele.id)\n    ele.id = rootId + ele.id\n  })\n\n  // Fix use tags\n  ;[...svg.querySelectorAll('use')].forEach((ele) => {\n    const selector = ele.getAttribute('xlink:href')\n    const originalId = selector.slice(1)\n    ele.setAttribute('xlink:href', '#' + rootId + originalId)\n  })\n\n  return svg\n}\n\n// TODO!\nconst fetchLaTeXSvghelper = (() => {\n  const cacheBust = 8\n  const environment = process.env.NODE_ENV\n  if (environment === 'development') {\n    const HOST = `http://${window.location.hostname}:3001`\n    // const HOST = 'https://latex-web-nbaek4micq-ew.a.run.app'\n    return memoize((tex) =>\n      fetch(\n        `${HOST}/latex?cachebust=${cacheBust}&tex=${encodeURIComponent(tex)}`\n      ).then((res) => res.text())\n    )\n  } else if (environment === 'production') {\n    return memoize((tex) => {\n      const filename = `${cacheBust}${md5(tex)}.svg`\n      return fetch(`/latex/${filename}`).then((res) => res.text())\n    })\n  } else {\n    // unrecognized environment\n  }\n})()\n\nexport function usePrevious(value) {\n  const ref = useRef()\n  useEffect(() => {\n    ref.current = value\n  })\n  return ref.current\n}\n\n// Hook\nexport function useLocalStorage(key, initialValue) {\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      // Get from local storage by key\n      const item = window.localStorage.getItem(key)\n      // Parse stored json or if none return initialValue\n      return item ? JSON.parse(item) : initialValue\n    } catch (error) {\n      // If error also return initialValue\n      console.log(error)\n      return initialValue\n    }\n  })\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue = (value) => {\n    try {\n      // Allow value to be a function so we have same API as useState\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value\n      // Save state\n      setStoredValue(valueToStore)\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(valueToStore))\n    } catch (error) {\n      // A more advanced implementation would handle the error case\n      console.log(error)\n    }\n  }\n  return [storedValue, setValue]\n}\n","import React from 'react'\nimport { useEffect, useState, useContext } from 'react'\n\nimport Citation from 'citation-js'\n\nexport const CitationContext = React.createContext(null)\n\nexport function CitationProvider({ bibUrl, citationMap, children }) {\n  const [bibliography, setBibliography] = useState(null)\n\n  useEffect(() => {\n    ;(async () => {\n      if (!bibUrl) {\n        return\n      }\n      const text = await fetch(bibUrl).then((res) => res.text())\n      const result = Citation.parse.bibtex.text(text)\n      setBibliography(result)\n    })()\n  }, [])\n\n  return (\n    <CitationContext.Provider\n      value={{\n        bibliography,\n        citationMap\n      }}\n    >\n      {children}\n    </CitationContext.Provider>\n  )\n}\n\nexport function RenderCite({ id, render }) {\n  const { citationMap, bibliography } = useContext(CitationContext)\n\n  return render({\n    text: bibliography\n      ? new Citation(bibliography.find((e) => e.label === id)).format(\n          'bibliography',\n          {\n            format: 'text',\n            template: 'apa',\n            lang: 'en-US'\n          }\n        )\n      : null,\n    number:\n      bibliography && !bibliography.find((e) => e.label === id)\n        ? `?? ${id}`\n        : citationMap[id] || null\n  })\n}\n\nexport function RenderBibliography({ render }) {\n  const { citationMap, bibliography } = useContext(CitationContext)\n  // TODO: Slide header should work here!\n\n  const sortedEntries = Object.entries(citationMap).sort(\n    ([i1, n1], [i2, n2]) => n1 - n2\n  )\n\n  if (!bibliography) return render([])\n  return render(\n    sortedEntries.map(([id, n]) => {\n      const entry = bibliography.find((e) => e.label === id)\n      const html = new Citation(entry).format('bibliography', {\n        format: 'html',\n        template: 'apa',\n        lang: 'en-US'\n      })\n      return { id, n, html }\n    })\n  )\n}\n","import React from 'react'\n\n// The presenter notes get picked up by staticAnalysis.js and it's children get rendered elsewhere\nexport default function Notes({}) {\n  return <div />\n}\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseFlatten = require('./_baseFlatten');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Recursively flattens `array`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flattenDeep([1, [2, [3, [4]], 5]]);\n * // => [1, 2, 3, 4, 5]\n */\nfunction flattenDeep(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, INFINITY) : [];\n}\n\nmodule.exports = flattenDeep;\n","import {pathParse, serializePath} from 'svg-path-parse';\nimport {fetchLaTeXSvg} from '../utils'\n\n// import '../external/TweenMax.min'\nimport gsap from 'gsap';\nimport MorphSVGPlugin from 'gsap-bonus/MorphSVGPlugin';\nimport DrawSVGPlugin from 'gsap-bonus/DrawSVGPlugin';\n\ngsap.registerPlugin(MorphSVGPlugin, DrawSVGPlugin);\n\n// temp 'hack', should add colors={[...]} to <Morph>?\n\nconst whiteListedColors = [\n  '#00d56f'\n]\n\n// TODO: syntax highlighting vim per groups?\nfunction elementToPath(child, transform='') {\n  const svg = child.ownerSVGElement;\n  if (child.tagName === 'use') {\n    const offsetX = parseFloat(child.getAttribute('x'), 10) || 0;\n    const offsetY = parseFloat(child.getAttribute('y'), 10) || 0;\n\n    const id = child.getAttribute('xlink:href');\n\n    const element = svg.querySelector(id)\n    if (element.tagName == 'path') {\n      const path = element.getAttribute('d');\n      const {err, segments, type} = pathParse(path).relNormalize({\n        transform: `translate(${offsetX}, ${offsetY}) ${transform}`.trim()\n      });\n\n      const newPath = serializePath({err, segments: segments, type});\n\n      return newPath;\n    } else if (element.tagName == 'use') {\n      const tr = element.getAttribute('transform') || '';\n      return elementToPath(element,  `translate(${offsetX}, ${offsetY}) ${tr}`.trim());\n    } else {\n      console.error('Unrecognized use of element', element);\n    }\n  }\n\n  if (child.tagName === 'rect') {\n    const x = +child.getAttribute('x');\n    const y = +child.getAttribute('y');\n    const width = +child.getAttribute('width');\n    const height = +child.getAttribute('height');\n\n    const pathData = 'M' + x + ' ' + y + 'H' + (x + width) + 'V' + (y + height) + 'H' + x + 'z';\n    return pathData;\n  }\n  // TODO polyline or something like that\n  console.error('Unrecognized:', child);\n  return null;\n}\n\nfunction groupIdFromElement(element) {\n  const fill = element.getAttribute('fill');\n  if (!fill) {\n    return 'g0';\n  }\n  return 'g' + fill.slice(1);\n}\n\nfunction colorFromGroupId(id) {\n  if (id == 'g0')\n    return 'black'\n  return '#' + id.slice(1)\n}\n\nfunction svgToGroupedPaths(svg) {\n  const rest = [...svg.querySelectorAll('.page1 > :not(g)')].map(child => ({\n    id: groupIdFromElement(child),\n    path: elementToPath(child)\n  }));\n\n  const gs = [...svg.querySelectorAll('.page1 > g')].map(group => {\n    return {\n      id: groupIdFromElement(group),\n      path: [...group.children]\n        .map(child => elementToPath(child))\n        .filter(Boolean)\n        .join(' ')\n    };\n  });\n\n  const byGroupId = [...rest, ...gs].reduce(function(acum, {id, path}) {\n    if (!acum[id]) {\n      acum[id] = '';\n    }\n    acum[id] += ' ' + path;\n    return acum;\n  }, {});\n\n  return byGroupId;\n}\n\nfunction colorHash(str) {\n  str = String(str);\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let colour = '';\n  for (let i = 0; i < 3; i++) {\n    let value = (hash >> (i * 8)) & 0xff;\n    colour += ('00' + value.toString(16)).substr(-2).toUpperCase();\n  }\n  return colour;\n}\n\nconst DEFAULT_TIMING = 0.4;\n\nexport async function animate(svgEl, text, replaceImediately=false, TIMING=DEFAULT_TIMING, setSvgData = (() => {})) {\n\n  text = text.replace(/\\\\g(\\d)/g, (match, p1) => `\\\\g{${colorHash(p1)}}`);\n  text = text.replace(\n    /\\\\g\\{(.*?)\\}/g,\n    (match, p1) => `\\\\g{${colorHash(p1)}}`\n  );\n\n  let newSvg;\n  if (text == '') {\n    // empty svg\n    newSvg = document.createElement('svg');\n    newSvg.setAttribute('width', '0pt')\n    newSvg.setAttribute('height', '0pt')\n    newSvg.setAttribute('viewBox', '0 0 0 0')\n  } else {\n    newSvg = await fetchLaTeXSvg(text);\n  }\n\n  if (!newSvg) {\n    return;\n  }\n\n  const newPaths = svgToGroupedPaths(newSvg);\n\n  // svgEl.setAttribute('width', newSvg.getAttribute('width'))\n  // svgEl.setAttribute('height', newSvg.getAttribute('height'))\n  // svgEl.setAttribute('viewBox', newSvg.getAttribute('viewBox'))\n\n  setSvgData({\n    width: parseFloat(newSvg.getAttribute('width').replace('pt', ''), 10),\n    height:parseFloat(newSvg.getAttribute('height').replace('pt', ''), 10),\n    viewBox: newSvg.getAttribute('viewBox').split(' ').map(s => parseFloat(s, 10))\n  })\n\n  const afterIds = Object.keys(newPaths);\n  const beforeIds = [...svgEl.querySelectorAll('[id]')].map(e => e.id);\n  const allIds = [...new Set([...afterIds, ...beforeIds])];\n\n  return Promise.all(allIds.map(id => {\n    const shouldRemove = beforeIds.includes(id) && !afterIds.includes(id);\n    const isNew = afterIds.includes(id) && !beforeIds.includes(id);\n\n    if (shouldRemove) {\n      const element = svgEl.querySelector(`#${id}`);\n      if (replaceImediately) {\n        element.remove()\n        return true\n      } else {\n        return new Promise(res => gsap.to(element, TIMING, {\n          opacity: 0,\n          onComplete:() => {\n            element.remove()\n            res()\n          }\n        }))\n      }\n    }\n\n    if (isNew) {\n      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      path.id = id;\n      path.setAttribute('d', newPaths[id]);\n\n      const color = colorFromGroupId(id)\n      if (whiteListedColors.includes(color)) {\n        path.setAttribute('fill', color)\n      }\n\n      path.style.opacity = 0;\n      svgEl.appendChild(path);\n\n      if (replaceImediately) {\n        path.style.opacity = 1\n        return true\n      } else {\n        return new Promise(res => gsap.to(path, TIMING, {\n          opacity: 1,\n          onComplete:res\n        }))\n      }\n    }\n\n    // morphing\n    const element = svgEl.querySelector(`#${id}`);\n\n\n    if (replaceImediately) {\n      element.setAttribute('d', newPaths[id]);\n      element.style.opacity = 1;\n      return true\n    } else {\n      return new Promise(res => gsap.to(element, TIMING, {\n        morphSVG: newPaths[id],\n        // TODO test if makes difference!\n        // type:\"rotational\",\n        opacity: 1,\n        onComplete: res\n      }))\n    }\n  }));\n}\n","import React from 'react'\nimport { useEffect, useState, useRef, useContext } from 'react'\n\nimport { useLocalStorage } from './utils'\nimport Morph from './Morph'\n\nimport './AnimationEditor.css'\n// import localStorageData from './localStorage.json'\n\nconst allColors = [\n  '#D32F2F',\n  '#7B1FA2',\n  '#512DA8',\n  '#303F9F',\n  '#1976D2',\n  '#0288D1',\n  '#0097A7',\n  '#00796B',\n  '#388E3C',\n  '#689F38',\n  '#AFB42B',\n  '#FBC02D',\n  '#FFA000',\n  '#F57C00',\n  '#E64A19'\n]\n\nfunction convertToTeX(tex, selections) {\n  return (\n    tex\n      .split('')\n      .map((c, i) => {\n        const ending = selections.filter(([c, s, e]) => e === i)\n        const starting = selections\n          .filter(([c, s, e]) => s === i)\n          .sort((a, b) => b[3] - a[3]) // descending on `end`\n          .map(([c, s, e]) => c)\n\n        return (\n          ending.map((e) => '}').join('') +\n          starting.map((col) => `\\\\g{${col + 1}}{`).join('') +\n          c\n        )\n      })\n      .join('') +\n    selections\n      .filter(([c, s, e]) => e === tex.length)\n      .map((e) => '}')\n      .join('')\n  )\n}\n\nexport const lookupAnimationGroups = (() => {\n  // TODO: use hashmap?\n  return (start, end) => {\n    const data = JSON.parse(localStorage.animationGroups || '[]')\n    const result = data.find(({ start: s, end: e }) => {\n      return (start === s && end === e) || (start === e && end === s)\n    })\n\n    // no result found\n    if (!result) {\n      return [start, end]\n    }\n\n    if (result.start === start) {\n      // not reversed\n      return [\n        convertToTeX(result.start, result.startGroups),\n        convertToTeX(result.end, result.endGroups)\n      ]\n    } else {\n      // reversed\n      return [\n        convertToTeX(result.end, result.endGroups),\n        convertToTeX(result.start, result.startGroups)\n      ]\n    }\n  }\n})()\n\nexport default function AnimationEditor({ animations: playedAnimations }) {\n  const [animations, setAnimations] = useLocalStorage('animationGroups', [])\n  const [colorIndex, setColorIndex] = useState(0)\n\n  const onKeyPress = (e) => {\n    try {\n      const i = parseInt(e.key, 10)\n      setColorIndex((i + 9) % 10)\n    } catch (e) {}\n  }\n  useEffect(() => {\n    window.addEventListener('keypress', onKeyPress)\n    return () => window.removeEventListener('keypress', onKeyPress)\n  }, [])\n\n  useEffect(() => {\n    const newOnes = playedAnimations\n      .filter((animation) => {\n        const animated = animations.find(\n          (a) =>\n            (animation.start == a.start && animation.end == a.end) ||\n            (animation.start == a.end && animation.end == a.start)\n        )\n        const inDataBase = !animated\n        return inDataBase\n      })\n      .map((anim) => ({\n        ...anim,\n        startGroups: [],\n        endGroups: []\n      }))\n\n    if (newOnes.length >= 1) {\n      setAnimations((animations) => [...animations, ...newOnes])\n    }\n  }, [animations, setAnimations, playedAnimations])\n\n  return (\n    <div className='animation-editor'>\n      <div className='colors'>\n        {allColors.map((c, i) => (\n          <span\n            key={i}\n            className='color'\n            style={{\n              backgroundColor: c,\n              transform: colorIndex === i ? 'scale(1.4)' : 'scale(1)'\n            }}\n            onClick={() => setColorIndex(i)}\n          ></span>\n        ))}\n      </div>\n      <style>{` .formula *::selection { background: ${allColors[colorIndex]} } `}</style>\n\n      <div className='animations'>\n        {playedAnimations\n          .map((animation) => {\n            const index = animations.findIndex(\n              (a) =>\n                (animation.start == a.start && animation.end == a.end) ||\n                (animation.start == a.end && animation.end == a.start)\n            )\n\n            const a = animations[index]\n\n            if (!a) return null\n\n            return {\n              ...a,\n              start: '' + a.start,\n              end: '' + a.end,\n              index\n            }\n          })\n          .filter(Boolean)\n          .map((animation) => {\n            const i = animation.index\n            return (\n              <Animation\n                animation={animation}\n                setAnimation={(f) =>\n                  setAnimations([\n                    ...animations.slice(0, i),\n                    f,\n                    ...animations.slice(i + 1)\n                  ])\n                }\n                removeAnimation={() =>\n                  setAnimations([\n                    ...animations.slice(0, i),\n                    ...animations.slice(i + 1)\n                  ])\n                }\n                colorIndex={colorIndex}\n                setColorIndex={setColorIndex}\n                i={i}\n              />\n            )\n          })\n          .filter(Boolean)}\n      </div>\n    </div>\n  )\n}\n\nfunction Animation({\n  colorIndex,\n  setColorIndex,\n  animation,\n  setAnimation,\n  i,\n  removeAnimation\n}) {\n  const handleSelection = (ev, part, background) => {\n    //remove\n    if (ev.button === 2) {\n      const index = ev.target.dataset.index\n      const groups = part + 'Groups'\n      const selections = determineSelections(animation[part], animation[groups])\n      const activeSelection = selections[index]\n\n      if (!activeSelection) {\n        return\n      }\n\n      setAnimation({\n        ...animation,\n        [groups]: animation[groups].filter((s) => s !== activeSelection)\n      })\n\n      return\n    }\n\n    // pick color\n    if (ev.button === 1) {\n      ev.preventDefault()\n      const group = ev.target.dataset.group\n      setColorIndex(+group)\n      return\n    }\n\n    const sel = window.getSelection()\n\n    try {\n      var s =\n        parseInt(sel.anchorNode.parentNode.dataset.index, 10) + sel.anchorOffset\n      var e =\n        parseInt(sel.focusNode.parentNode.dataset.index, 10) + sel.focusOffset\n      var start = Math.min(s, e)\n      var end = Math.max(s, e)\n      if (start === end) {\n        return\n      }\n      const newAnimation = {\n        ...animation,\n        [part + 'Groups']: mergeSelections([\n          ...animation[part + 'Groups'],\n          [colorIndex, start, end]\n        ])\n      }\n\n      // TODO\n      // \"smart\" stuff\n      // if (part === 'start') {\n      //   const text = formula.tex.substring(start, end)\n      //   if (text.length > 2 && nextFormula.tex.includes(text)) {\n      //     // setting formula\n      //     const startIndex = nextFormula.tex.indexOf(text);\n      //     const newSelection = {\n      //       start: startIndex,\n      //       end : startIndex + text.length,\n      //       color: color\n      //     }\n      //     newFormula.end = [...newFormula.end, newSelection]\n      //   }\n      // }\n\n      setAnimation(newAnimation)\n    } catch (e) {\n      console.error(e)\n    } finally {\n      sel.removeAllRanges()\n    }\n  }\n\n  // return <pre>{JSON.stringify(animation)}</pre>;\n\n  return (\n    <div className='animation' style={{}}>\n      {['start', 'end'].map((part) => {\n        const groups = part + 'Groups'\n        const selections = determineSelections(\n          animation[part],\n          animation[groups]\n        )\n        return (\n          <div>\n            <span\n              className='formula'\n              style={{ fontFamily: 'Iosevka Term, monospace' }}\n              onMouseUp={(e) => handleSelection(e, part, selections)}\n              onContextMenu={(e) => e.preventDefault()}\n            >\n              {animation[part].split('').map((c, j) => {\n                const color =\n                  null === selections[j] ? 'black' : allColors[selections[j][0]]\n                const group = null === selections[j] ? -1 : selections[j][0]\n                return (\n                  <span\n                    data-index={j}\n                    data-group={group}\n                    style={{ background: color }}\n                  >\n                    {c}\n                  </span>\n                )\n              })}\n            </span>\n          </div>\n        )\n      })}\n      <div className='preview'>\n        <AutoMorph\n          steps={[\n            convertToTeX(animation.start, animation.startGroups),\n            convertToTeX(animation.end, animation.endGroups)\n          ]}\n        />\n      </div>\n      {/*}<button className='remove' onClick={removeAnimation}>⨯</button>*/}\n    </div>\n  )\n}\n\nfunction AutoMorph({ steps }) {\n  const [step, setStep] = useState(0)\n  const onClick = () => setStep((step) => (step + 1) % 2)\n\n  return (\n    <div className='automorph' onClick={onClick}>\n      <Morph TIMING={1.0} display useAnimationDatabase={false}>\n        {steps[step]}\n      </Morph>\n    </div>\n  )\n}\n\nfunction determineSelections(tex, selections) {\n  const colors = []\n  let levels = []\n  tex.split('').forEach((c, i) => {\n    const ending = selections.filter(([c, s, e]) => e === i)\n\n    const starting = selections\n      .filter(([c, s, e]) => s === i)\n      .sort((a, b) => b[3] - a[3]) // descending on `end`\n\n    levels = levels.slice(0, levels.length - ending.length)\n    levels = [...levels, ...starting]\n\n    const currentActive = levels[levels.length - 1]\n    if (!currentActive) {\n      colors.push(null)\n    } else {\n      colors.push(currentActive)\n    }\n  })\n\n  return colors\n}\n\nfunction mergeSelections(selections) {\n  let result = []\n  selections.forEach(([color, start, end]) => {\n    const prev = result.find(([c, s, e]) => e === start && c === color)\n    if (prev) {\n      prev[3] = end\n    } else {\n      result.push([color, start, end])\n    }\n  })\n  return result\n}\n","import React from 'react'\n\nimport { useEffect, useState, useRef, useContext } from 'react'\n\nimport { animate } from './lib/morph.js'\nimport { lookupAnimationGroups } from './AnimationEditor'\n\nimport { usePrevious } from './utils.js'\n\n// DONE: if viewbox of 'after' state is smaller, only change it after the animation!\n// DONE: don't transition if replace imediately\nfunction Morph({\n  children,\n  display,\n  inline,\n  debug,\n  useAnimationDatabase = true,\n  replace,\n  TIMING = 0.6\n}) {\n  const svgEl = useRef(null)\n  const [\n    {\n      viewBox: [vx, vy, vw, vh],\n      width,\n      height\n    },\n    setSvgData\n  ] = useState({\n    viewBox: [0, 0, 0, 0],\n    width: 0,\n    height: 0\n  })\n\n  const [transition, setTransition] = useState(false)\n\n  const wrapMath = (s) => {\n    if (display) {\n      return '$\\\\displaystyle ' + s + '$'\n    } else if (inline) {\n      return '$' + s + '$'\n    }\n    return s\n  }\n\n  const { min, max, abs } = Math\n\n  const FONT_SCALING_FACTOR = 2\n\n  const updateSvgData = ({ viewBox, width, height }) => {\n    setSvgData({\n      viewBox,\n      width: FONT_SCALING_FACTOR * width,\n      height: FONT_SCALING_FACTOR * height\n    })\n  }\n\n  const previousChildren = usePrevious(children)\n\n  useEffect(() => {\n    ;(async () => {\n      const svg = svgEl.current\n      const anim = (text, replaceImediately) => {\n        // should probably tick animationframe?\n        setTransition(!replaceImediately)\n        return animate(\n          svg,\n          text,\n          replaceImediately,\n          TIMING,\n          updateSvgData,\n          debug\n        )\n      }\n\n      if (!children) {\n        await anim('', false)\n        return\n      }\n\n      if (typeof children !== 'string') {\n        console.error(\"Trying to compile something that is'nt text:\", children)\n        return\n      }\n\n      if (!previousChildren) {\n        await anim(wrapMath(children), false)\n        return\n      }\n\n      if (replace) {\n        await anim(wrapMath(children), true)\n        return\n      }\n\n      if (useAnimationDatabase) {\n        const [before, after] = lookupAnimationGroups(\n          previousChildren || '',\n          children\n        )\n\n        await anim(wrapMath(before), true)\n        await anim(wrapMath(after), false)\n      } else {\n        await anim(wrapMath(children), false)\n      }\n    })()\n  }, [children])\n\n  const inner = (\n    <div\n      style={{\n        ...(display\n          ? {\n              left: '50%',\n              transform: `translate(${-width / 2}pt, 0)`\n            }\n          : {}),\n        width: 0,\n        height: 0,\n        marginTop: `${-vy * FONT_SCALING_FACTOR}pt`,\n        marginRight: `${width}pt`,\n        verticalAlign: 'baseline',\n        position: 'relative',\n        display: 'inline-block',\n        ...(transition\n          ? {\n              transition: `${TIMING}s margin-right, ${TIMING}s margin-top, ${TIMING}s transform`\n            }\n          : {}),\n        ...(debug ? { outline: '1px solid lightblue' } : {})\n      }}\n    >\n      <svg\n        width={width + 'pt'}\n        height={height + 'pt'}\n        viewBox={[vx, vy, vw, vh].join(' ')}\n        style={{\n          display: 'inline-block',\n          position: 'absolute',\n          top: `${FONT_SCALING_FACTOR * vy}pt`,\n          verticalAlign: 'baseline',\n          ...(debug ? { outline: '1px solid yellow' } : {})\n        }}\n        ref={svgEl}\n      ></svg>\n    </div>\n  )\n\n  if (display) {\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexGrow: 1,\n          height: height + 'pt',\n          margin: '0.5em 0',\n          ...(transition ? { transition: `${TIMING}s height` } : {}),\n          ...(debug ? { outline: '1px solid red' } : {})\n        }}\n      >\n        {inner}\n      </div>\n    )\n  } else {\n    return (\n      <>\n        {/* strut*/}\n        <div\n          style={{\n            display: 'inline-block',\n            width: 0,\n            verticalAlign: 'text-top',\n            marginTop: '0.9em',\n            height: height + vy + 'pt',\n            ...(transition\n              ? { transition: `${TIMING}s height, ${TIMING}s margin-bottom` }\n              : {}),\n            ...(debug ? { width: '2px', background: 'limegreen' } : {})\n          }}\n        />\n        {inner}\n      </>\n    )\n  }\n}\n\nexport default Morph\n","import React from 'react'\nimport { PresentationContext, RenderSlide } from './Presentation'\nimport { CitationContext, RenderCite } from './Citations'\nimport Notes from './PresenterNotes'\n\nimport flattenDeep from 'lodash/flattenDeep'\nimport Morph from './Morph'\n\nwindow.React = React\n\nconst withFakeDispatcher = (ctx, cb) => {\n  // I'll guess I'll be fired then ;)\n  const {\n    ReactCurrentDispatcher\n  } = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n  const original = ReactCurrentDispatcher.current\n\n  ReactCurrentDispatcher.current = {\n    useContext: (context) => {\n      const result = ctx.find(([c, v]) => c == context)\n      if (result) {\n        return result[1]\n      }\n      return {}\n    },\n    readContext: () => null,\n    useCallback: (x) => x,\n    useEffect: () => null,\n    useImperativeHandle: () => null,\n    useLayoutEffect: () => null,\n    useMemo: (x) => x,\n    useReducer: (_, initialState) => initialState,\n    useRef: (initial) => {\n      const ref = { current: initial }\n      return ref\n    },\n    useState: (initial) => [initial, (x) => x],\n    useDebugValue: () => null,\n    useResponder: () => null,\n    useDeferredValue: () => null,\n    useTransition: () => null\n  }\n\n  let result\n  try {\n    result = cb()\n  } finally {\n    ReactCurrentDispatcher.current = original\n  }\n  return result\n}\n\nconst ignore = [Morph, RenderCite]\nconst findElementsInTree = (node, predicate) => {\n  const found = []\n\n  const handleTree = (node) => {\n    if (predicate(node)) {\n      found.push(node)\n      return\n    }\n\n    if (node.type && typeof node.type === 'function') {\n      // Do not go deeper into Morphs, ...\n      if (ignore.includes(node.type)) {\n        return\n      }\n\n      const resolved = node.type(node.props)\n      return handleTree(resolved)\n    }\n\n    if (node.props && node.props.children) {\n      const childs = flattenDeep(\n        Array.isArray(node.props.children)\n          ? node.props.children\n          : [node.props.children]\n      )\n      childs.forEach((child) => {\n        if (child) {\n          handleTree(child)\n        }\n      })\n    }\n  }\n\n  handleTree(node)\n  return found\n}\n\n// Does as it says. e.g.\n// <ProofSlide color='false'>\n//   resolves to -> <Slide header='test' />\n//\n//   the resulting props are {color: false, header: test, slide: the <Slide> component}\nconst getPropsRecursiveUntilSlideComponentIsEncountered = (node) => {\n  const props = node.props\n  const type = node.type\n\n  if (type == RenderSlide) {\n    return { ...props, slide: node }\n  }\n\n  const resolved = type({ ...props })\n  const rest = getPropsRecursiveUntilSlideComponentIsEncountered(resolved)\n  return {\n    ...props,\n    ...rest\n  }\n}\n\nexport function getSlideInfo(slides) {\n  const mockContextes = [\n    [\n      PresentationContext,\n      {\n        slideIndex: 0,\n        infos: [],\n        info: {},\n        numSlides: 0\n      }\n    ],\n    [\n      CitationContext,\n      {\n        bibliography: [],\n        citationMap: {}\n      }\n    ]\n  ]\n\n  let slideWithProps\n\n  // note that the steps prop is not yet okay: because the table of contents doesn't know yet how many sections there are, it cannot determine the number of steps ...\n  withFakeDispatcher(mockContextes, () => {\n    slideWithProps = slides.map(\n      getPropsRecursiveUntilSlideComponentIsEncountered\n    )\n  })\n\n  // this adds the current section to each of the slides\n  //\n  // slide:   1234567\n  // section: A   B\n  //\n  // gets transformed to\n  //\n  // slide:        1234567\n  // section:      AAAABBB\n  // sectionSlide: tffftff\n\n  const infos = []\n  for (let { slide, ...props } of slideWithProps) {\n    const accumulatedInfo = infos[infos.length - 1]\n    const newInfo = {\n      ...accumulatedInfo\n    }\n\n    newInfo.sectionSlide = !!props.section\n    newInfo.hideNavigation = !!props.hideNavigation\n\n    if (props.section) {\n      newInfo.section = props.section\n    }\n\n    if (props.header) {\n      newInfo.header = props.header\n    } else {\n      newInfo.header = null\n    }\n\n    infos.push(newInfo)\n  }\n\n  // Now we add this info to the presentation context\n  // Now the <TableOfContentsSlide /> knows how many sections there are, so it can calculate how many steps the slide is based on this.\n\n  const citationMap = withFakeDispatcher(mockContextes, () => {\n    return getCitations(slideWithProps.map((x) => x.slide))\n  })\n\n  mockContextes.find(([c, _]) => c == PresentationContext)[1].infos = infos\n  mockContextes.find(\n    ([c, _]) => c == CitationContext\n  )[1].citationMap = citationMap\n\n  return withFakeDispatcher(mockContextes, () => {\n    slideWithProps = slides.map(\n      getPropsRecursiveUntilSlideComponentIsEncountered\n    )\n    const slideInfo = slideWithProps.map(({ slide, ...props }, index) => ({\n      slide,\n      info: infos[index],\n      steps: props.steps || [null],\n      animations: animations(slide),\n      presenterNotes: presenterNotes(slide)\n    }))\n    console.log('slideInfo is', slideInfo)\n    return { slideInfo, citationMap }\n  })\n}\n\nconst presenterNotes = (slide) => {\n  let tree\n  if (!slide.props.steps || typeof slide.props.children !== 'function') {\n    tree = slide\n  } else {\n    tree = slide.props.children(slide.props.steps[0])\n  }\n\n  const notes = findElementsInTree(\n    tree,\n    (node) => typeof node.type === 'function' && node.type === Notes\n  )\n  if (notes.length > 1) {\n    console.error('On slide ', slide, 'you have more than one <Notes>!')\n  }\n  const note = notes[0]\n  if (!note) return null\n  return note.props.children\n}\n\nconst animations = (slide) => {\n  const morphs = {}\n\n  if (!slide.props.steps) return []\n\n  if (typeof slide.props.children !== 'function') {\n    // If type is not a function, we have no animations.\n    return []\n  }\n\n  slide.props.steps.forEach((step) => {\n    const tree = slide.props.children(step)\n\n    findElementsInTree(\n      tree,\n      (node) => typeof node.type === 'function' && node.type === Morph\n    ).forEach((node) => {\n      if (node.props.replace) {\n        // No animations to consider, is replaced immediately\n        // Is used for plain LaTeX (<Morph replace />)\n        return\n      }\n      const id = JSON.stringify(node._source)\n      const contents = node.props.children\n      morphs[id] = morphs[id] ? [...morphs[id], contents] : [contents]\n    })\n  })\n\n  const anim = []\n  for (let key in morphs) {\n    const formulas = morphs[key]\n    formulas.forEach((formula, i) => {\n      const start = formula\n      const end = formulas[i + 1]\n      if (i < formulas.length - 1 && start !== end) {\n        anim.push({ start, end })\n      }\n    })\n  }\n\n  return anim\n}\n\nfunction getCitations(slides) {\n  const citationMap = {}\n\n  slides.forEach((slide) => {\n    let trees = [slide]\n    if (typeof slide.props.children == 'function' && !!slide.props.steps) {\n      trees = slide.props.steps.map((step) => slide.props.children(step))\n    }\n\n    trees.forEach((tree) => {\n      findElementsInTree(\n        tree,\n        (node) => typeof node.type === 'function' && node.type == RenderCite\n      ).forEach((cite) => {\n        const id = cite.props.id\n        if (!citationMap[id]) {\n          const number = Math.max(0, ...Object.values(citationMap)) + 1\n          citationMap[id] = number\n        }\n      })\n    })\n  })\n  return citationMap\n}\n","import React from 'react'\n\nexport function Show({\n  when,\n  children,\n  text,\n  block,\n  opacity,\n  style,\n  className = ''\n}) {\n  const realStyle = {\n    opacity: opacity !== undefined ? opacity : when ? 1 : 0,\n    transition: '0.5s opacity ease-in-out',\n    ...style\n  }\n\n  // Div elements inside inline elements don't work as expected when opacity is 0.\n  // <span opacity=1><div>Hello</div></span> is visible in Chrome, not in firefox ...\n  if (text) {\n    return (\n      <span className='inline' style={{ ...realStyle }}>\n        {children}\n      </span>\n    )\n  }\n\n  if (block) {\n    return (\n      <div style={realStyle} className={className}>\n        {children}\n      </div>\n    )\n  }\n\n  return (\n    <React.Fragment>\n      {React.Children.map(children, (c) =>\n        React.cloneElement(c, {\n          ...(c.props && c.props.style ? c.props.style : {}),\n          style: realStyle\n        })\n      )}\n    </React.Fragment>\n  )\n}\n\n// TODO: Animate height of an element\n// export function Grow({when, children, opacity}) {\n","import React from 'react'\nimport { useEffect, useState, useContext, useCallback, useMemo } from 'react'\nimport { useLocalStorage } from './utils'\n\nimport { hashString } from './utils'\nimport { getSlideInfo } from './staticAnalysis'\n\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n  useParams,\n  generatePath,\n  useRouteMatch,\n  useHistory\n} from 'react-router-dom'\n\nimport { CitationProvider } from './Citations'\nimport AnimationEditor from './AnimationEditor'\nimport { Show } from './animations'\n\nimport { range, usePrevious } from './utils'\n\nexport function RenderPresentation({ children, bibUrl, renderSlide }) {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path='/'>\n          <Redirect to='/0/0' />\n        </Route>\n        <Route exact path='/storage'>\n          <Storage />\n        </Route>\n\n        <Route path='/overview'>\n          <PresentationOverview renderSlide={renderSlide} bibUrl={bibUrl}>\n            {children}\n          </PresentationOverview>\n        </Route>\n        <Route path='/:slideIndex/:stepIndex' exact={false}>\n          <PresentationUI renderSlide={renderSlide} bibUrl={bibUrl}>\n            {children}\n          </PresentationUI>\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport const PresentationContext = React.createContext(null)\n\nfunction PresentationUI({ children, renderSlide, bibUrl }) {\n  const reactSlides = React.Children.toArray(children)\n  const { slideInfo, citationMap } = useMemo(() => getSlideInfo(children), [\n    children\n  ])\n\n  const match = useRouteMatch()\n  const history = useHistory()\n\n  let { slideIndex = 0, stepIndex = 0 } = useParams()\n  slideIndex = parseInt(slideIndex)\n  stepIndex = parseInt(stepIndex)\n\n  const [transitions, setTransitions] = useState({})\n  const [fullScreen, setFullScreen] = useState(false)\n\n  const setSlideAndStep = (slideIndex, stepIndex) => {\n    history.push(generatePath(match.path, { slideIndex, stepIndex }))\n  }\n\n  const prev = useCallback(\n    (dontStepButGoToPrevSlide) => {\n      if (dontStepButGoToPrevSlide) {\n        if (slideIndex > 0) {\n          setSlideAndStep(slideIndex - 1, 0)\n        }\n        return\n      }\n      if (stepIndex > 0) {\n        setSlideAndStep(slideIndex, stepIndex - 1)\n        return\n      }\n      if (slideIndex > 0) {\n        setSlideAndStep(\n          slideIndex - 1,\n          slideInfo[slideIndex - 1].steps.length - 1\n        )\n      }\n    },\n    [slideIndex, stepIndex, setSlideAndStep]\n  )\n\n  const next = useCallback(\n    (dontStepButGoToNextSlide) => {\n      if (dontStepButGoToNextSlide) {\n        if (slideIndex < slideInfo.length - 1) {\n          setSlideAndStep(slideIndex + 1, 0)\n        }\n        return\n      }\n      if (stepIndex < slideInfo[slideIndex].steps.length - 1) {\n        setSlideAndStep(slideIndex, stepIndex + 1)\n        return\n      }\n      if (slideIndex < slideInfo.length - 1) {\n        setSlideAndStep(slideIndex + 1, 0)\n      }\n    },\n    [slideIndex, stepIndex, setSlideAndStep]\n  )\n\n  const handleKey = useCallback(\n    (e) => {\n      if (e.key == 'ArrowDown') {\n        next(true)\n      }\n      if (e.key == 'ArrowUp') {\n        prev(true)\n      }\n\n      if (e.key == 'PageDown' || e.key == 'ArrowRight') {\n        e.preventDefault()\n        next()\n      } else if (e.key == 'PageUp' || e.key == 'ArrowLeft') {\n        e.preventDefault()\n        prev()\n      } else if (e.key == '.') {\n        e.preventDefault()\n        setFullScreen((f) => !f)\n      }\n    },\n    [next, prev, stepIndex, slideIndex]\n  )\n\n  useEffect(() => {\n    window.addEventListener('keydown', handleKey)\n    return () => {\n      window.removeEventListener('keydown', handleKey)\n    }\n  }, [handleKey])\n\n  if (slideIndex > slideInfo.length) {\n    return <div>Too high slide number!</div>\n  }\n  return (\n    <div>\n      <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n        {renderSlide({\n          fullScreen,\n          slideInfo,\n          info: slideInfo[slideIndex].info,\n          slideIndex,\n          stepIndex,\n          numSlides: reactSlides.length,\n          slides: reactSlides.map((slide, i) => {\n            return (\n              <PresentationContext.Provider\n                key={i}\n                value={{\n                  i,\n                  slideIndex,\n                  infos: slideInfo.map((i) => i.info),\n                  info: slideInfo[i].info,\n                  setTransitions,\n                  stepIndex:\n                    i === slideIndex\n                      ? stepIndex\n                      : i < slideIndex && slideInfo[i].steps.length\n                      ? slideInfo[i].steps.length - 1\n                      : 0,\n                  numSlides: reactSlides.length,\n                  transition: transitions[i]\n                }}\n              >\n                {slide}\n              </PresentationContext.Provider>\n            )\n          })\n        })}\n        <div>{slideInfo[slideIndex].presenterNotes}</div>\n        <AnimationEditor animations={slideInfo[slideIndex].animations} />\n      </CitationProvider>\n    </div>\n  )\n}\n\nfunction PresentationOverview({ children, renderSlide, bibUrl }) {\n  const reactSlides = React.Children.toArray(children)\n  const { slideInfo, citationMap } = useMemo(() => getSlideInfo(children), [\n    children\n  ])\n\n  // console.log(citationMap);\n  // TODO: find better name\n  return (\n    <div>\n      <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n        {slideInfo.flatMap((info, slideIndex) => {\n          return info.steps.map((step, stepIndex) => {\n            return renderSlide({\n              fullScreen: false,\n              info: info.info,\n              // todo: renderSlide picks slides[slideIndex], but also uses slideIndex to show the slide number ...\n              slideIndex: 0,\n              stepIndex,\n              numSlides: reactSlides.length,\n              slides: [\n                <PresentationContext.Provider\n                  value={{\n                    infos: slideInfo.map((i) => i.info),\n                    info: info.info,\n                    i: slideIndex,\n                    slideIndex,\n                    stepIndex: stepIndex,\n                    numSlides: reactSlides.length,\n                    setTransitions: () => null,\n                    transition: {}\n                  }}\n                >\n                  {reactSlides[slideIndex]}\n                </PresentationContext.Provider>\n              ]\n            })\n          })\n        })}\n      </CitationProvider>\n    </div>\n  )\n}\n\n// Add timeline ={{ ... }} shorthand\nexport function RenderSlide({ children, steps = [], render }) {\n  const TIMING = 0.5\n  const { stepIndex, info, i, slideIndex, transition } = useContext(\n    PresentationContext\n  )\n\n  const [style, setStyle] = useState({\n    transition: `${TIMING}s transform, ${TIMING}s opacity`,\n    transform: 'scale(1) translate3d(0px, 0px, 0px)',\n    opacity: 0\n  })\n\n  const updateStyle = (style) => setStyle((s) => ({ ...s, ...style }))\n\n  // delay rendering\n  // const [shouldRender, setRender] = useState(false)\n  // useEffect(() => {\n  //   setTimeout(() => setRender(true), 500)\n  // }, [])\n\n  useEffect(() => {\n    const {\n      after = {\n        transform: `translate3d(-100%, 0px, 0px)`,\n        opacity: 0,\n        zIndex: 0\n      },\n      before = {\n        transform: `translate3d(100%, 0px, 0px)`,\n        opacity: 0,\n        zIndex: 0\n      }\n    } = transition || {}\n\n    if (i > slideIndex) {\n      updateStyle({ ...before })\n    }\n    if (i < slideIndex) {\n      updateStyle({ ...after })\n    }\n    if (i == slideIndex) {\n      updateStyle({\n        zIndex: 10,\n        opacity: 1,\n        transform: `scale(1) translate3d(0px,0px,0px)`\n      })\n    }\n  }, [slideIndex, i, transition])\n\n  // if (shouldRender) {\n  const content =\n    children && (children.call ? children(steps[stepIndex]) : children)\n  return render({ info, content, i, slideIndex, style })\n  // }\n  // return render({info, content: <div />, i, slideIndex, style});\n}\n\nfunction Storage() {\n  return (\n    <pre\n      style={{\n        whiteSpace: 'break-spaces'\n      }}\n    >\n      {localStorage.animationGroups}\n    </pre>\n  )\n}\n","import React from 'react'\nimport { useMemo, useState, useEffect, useRef, useContext } from 'react'\n\nimport {\n  RenderSlide,\n  RenderPresentation,\n  PresentationContext\n} from '../../Presentation'\nimport { RenderCite, RenderBibliography } from '../../Citations'\n\nimport { Show } from '../../animations'\n\n// import sedes from './kuleuvensedes.svg'\nimport pointer from './pointer.png'\n//\nimport './styles.css'\n\nimport step from '../../step.macro.js'\nimport { range } from '../../utils.js'\n\nexport function Presentation({ ...props }) {\n  const h = 900\n  const w = 1200\n  return (\n    <RenderPresentation\n      {...props}\n      renderSlide={({\n        slides,\n        slideIndex,\n        stepIndex,\n        info,\n        numSlides,\n        fullScreen\n      }) => {\n        const threeSlides = slides.slice(\n          Math.max(0, slideIndex - 1),\n          Math.min(numSlides, slideIndex + 2)\n        )\n        return (\n          <div className='flex justify-center items-center bg-blue h-screen'>\n            <div\n              className='inline-block relative flex-shrink-0 flex flex-col text-white bg-blue'\n              style={{\n                overflow: 'hidden',\n                fontFamily: 'Computer Modern Sans',\n                width: w,\n                height: h\n                // border: '1px solid white'\n              }}\n            >\n              <div className='flex-grow relative'>{threeSlides}</div>\n              <div\n                className='flex flex-col'\n                style={{\n                  transition: '0.5s transform',\n                  transform: `translate(0px, ${info.hideNavigation ? 100 : 0}%)`\n                }}\n              >\n                <div className='flex justify-between text-xs theme-font-open'>\n                  <div className='px-2 py-1'>\n                    {info.sectionSlide ? '\\xa0' : info.section}\n                  </div>\n                  <div className='px-2 py-1'>{slideIndex + 1}</div>\n                </div>\n                <div className='w-full inline-block' style={{ height: 2 }}>\n                  <div\n                    className='h-full bg-green'\n                    style={{\n                      width: `${(slideIndex / (numSlides - 1)) * 100}%`,\n                      transition: 'width 0.5s'\n                    }}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\nfunction MousePointer() {\n  const [position, setPosition] = useState({ x: 0, y: 0 })\n  const [hidden, setHidden] = useState(true)\n  const currentTimer = useRef(null)\n  useEffect(() => {\n    const setFromEvent = (e) => {\n      setHidden(false)\n      clearTimeout(currentTimer.current)\n      currentTimer.current = setTimeout(() => setHidden(true), 1000)\n      setPosition({ x: e.clientX, y: e.clientY })\n    }\n    window.addEventListener('mousemove', setFromEvent)\n    return () => {\n      window.removeEventListener('mousemove', setFromEvent)\n    }\n  }, [])\n  const { x, y } = position\n  const width = 8\n  const height = 8\n  return (\n    <img\n      alt=''\n      width={width}\n      height={height}\n      src={pointer}\n      style={{\n        display: hidden ? 'none' : 'inline',\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        zIndex: 10,\n        pointerEvents: 'none',\n        transform: `translate(${x - width / 2}px, ${y - height / 2}px)`\n      }}\n    />\n  )\n}\n\nexport function Slide({ className, children, ...props }) {\n  return (\n    <RenderSlide\n      children={children}\n      {...props}\n      render={({ info, content, slideIndex, i, style }) => {\n        return (\n          <div\n            className='slide'\n            style={{\n              position: 'absolute',\n              left: 0,\n              top: 0,\n              bottom: 0,\n              right: 0,\n              ...style\n            }}\n          >\n            <div className='absolute inset-0 flex flex-col'>\n              {info.header && (\n                <div className='ml-6 mt-6 text-white font-semibold text-lg flex items-center theme-font-open'>\n                  <span\n                    style={{\n                      height: '2em',\n                      width: '4px',\n                      marginRight: '1em',\n                      background: '#00D56F',\n                      borderRadius: '2px'\n                    }}\n                  />\n                  {info.header}\n                </div>\n              )}\n              <div className={`flex-grow p-6 flex flex-col ${className}`}>\n                {content}\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\nexport function SectionSlide({ section }) {\n  const { i, numSlides } = useContext(PresentationContext)\n  return (\n    <Slide\n      className='flex justify-center items-center text-3xl theme-font-open'\n      hideNavigation\n    >\n      <div>\n        <div>{section}</div>\n        <div\n          className='mt-3'\n          style={{\n            background: 'rgba(255, 255, 255, 0.2)',\n            width: '16em',\n            height: '4px',\n            borderRadius: '2px'\n          }}\n        >\n          <div\n            className='h-full bg-green'\n            style={{\n              width: `${(i / (numSlides - 1)) * 100}%`,\n              borderRadius: '2px'\n            }}\n          />\n        </div>\n      </div>\n    </Slide>\n  )\n}\n\n// TOCO conclusion slide should clear section ...\nexport function ConclusionSlide({ section }) {\n  return (\n    <Slide className='flex justify-center items-center text-3xl theme-font-open'>\n      <div>\n        <div>{section}</div>\n        <div\n          className='bg-gray-300 mt-3'\n          style={{\n            width: '16em',\n            height: '2px'\n          }}\n        >\n          <div\n            className='h-full bg-green'\n            style={{\n              width: `100%`\n            }}\n          />\n        </div>\n      </div>\n    </Slide>\n  )\n}\n\nexport function TitleSlide({ title, subtitle, names, names2, date }) {\n  return (\n    <Slide\n      className='flex flex-col items-stretch justify-between theme-font-open'\n      steps={[0, 1, 2]}\n      hideNavigation\n    >\n      <div className='flex-grow flex flex-col justify-center'>\n        <Show when={step > 0}>\n          <h1 className='text-4xl font-semibold text-green'>{title}</h1>\n        </Show>\n        {/*<Show when={step>1}><h2 className='text-lg mt-1 text-blue-900'>{subtitle}</h2></Show>*/}\n      </div>\n      <Show when={step > 1}>\n        <div className='text-sm flex items-end justify-between'>\n          <div>\n            <div>{names}</div>\n            <div>{names2}</div>\n          </div>\n          <div>{date}</div>\n        </div>\n      </Show>\n    </Slide>\n  )\n}\n\nexport function TableOfContentsSlide({ header }) {\n  const { infos } = useContext(PresentationContext)\n  const sections = infos\n    .map((i) => i.section)\n    .filter(Boolean)\n    .filter((v, i, a) => a.indexOf(v) === i)\n\n  return (\n    <Slide\n      hideNavigation\n      header={header}\n      steps={sections.map((_, i) => i)}\n      className='flex items-start'\n    >\n      <ol>\n        {sections.map((section, i) => (\n          <Show key={section} when={step >= i}>\n            <li className='my-5'>{section}</li>\n          </Show>\n        ))}\n      </ol>\n    </Slide>\n  )\n}\n\nexport function QuestionSlide({ title = 'Questions?' }) {\n  return (\n    <Slide\n      className='bg-blue text-gray-100 text-3xl flex items-center justify-center p-0'\n      hideNavigation\n    >\n      {title}\n    </Slide>\n  )\n}\n\n// TODO: svg object fit?\nexport function Figure({ children, caption }) {\n  return (\n    <div className='flex flex-col'>\n      <div className='flex-grow'>{children}</div>\n      {caption && (\n        <div className='p-1'>\n          <b>Figure:</b> {caption}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport function List({ children, step, ...props }) {\n  const childArray = React.Children.toArray(children)\n  return (\n    <ul {...props}>\n      {childArray.map((child, i) => (\n        <Show key={i} when={i < step || step === undefined}>\n          {child}\n        </Show>\n      ))}\n    </ul>\n  )\n}\n\nexport function Item({ children, name, ...props }) {\n  if (name) {\n    return (\n      <li\n        {...props}\n        style={{\n          ...(props.style || {}),\n          listStyle: 'none'\n        }}\n      >\n        <b>{name + ' '}</b>\n        {children}\n      </li>\n    )\n  } else {\n    return <li {...props}>{children}</li>\n  }\n}\n\nexport function Cite({ id, hidden }) {\n  return (\n    <RenderCite\n      id={id}\n      render={({ text, number }) => {\n        if (hidden) return <span />\n        return <span title={text || 'Loading ...'}>[{number || '??'}]</span>\n      }}\n    />\n  )\n}\n\nexport function BibliographySlide() {\n  const stride = 4\n  return (\n    <RenderBibliography\n      render={(items) => {\n        return (\n          <Slide steps={range(Math.ceil(items.length / stride))}>\n            {(step) => {\n              if (!items) return <div>Loading</div>\n\n              const start = stride * step\n              const end = start + stride\n              return (\n                <ul className='list-none text-sm'>\n                  {items.slice(start, end).map(({ id, n, html }) => {\n                    return (\n                      <li className='flex my-2'>\n                        <span className='mr-2'>[{n}]</span>\n                        <div className='inline-block'>\n                          <span dangerouslySetInnerHTML={{ __html: html }} />\n                        </div>\n                      </li>\n                    )\n                  })}\n                </ul>\n              )\n            }}\n          </Slide>\n        )\n      }}\n    />\n  )\n}\n\nexport function Box({ title, children, className, smallTitle, style }) {\n  return (\n    <div\n      className={`theme-border theme-shadow ${className || ''}`}\n      style={style}\n    >\n      <div className='p-2'>\n        {title && (\n          <span\n            className={`pr-2 text-green font-semibold ${\n              smallTitle ? 'text-xs block' : ''\n            }`}\n          >\n            {title}.\n          </span>\n        )}\n        {children}\n      </div>\n    </div>\n  )\n}\n\nexport function Qed(props) {\n  return (\n    <div className='flex justify-end' {...props}>\n      <div className='inline-block w-2 h-2 bg-white m-1' />\n    </div>\n  )\n}\n","import React, { useEffect, useRef } from 'react'\n\nimport { fetchLaTeXSvg } from './utils'\n\nimport { animate } from './lib/morph'\n\nimport gsap from 'gsap'\nimport MorphSVGPlugin from 'gsap-bonus/MorphSVGPlugin'\nimport DrawSVGPlugin from 'gsap-bonus/DrawSVGPlugin'\n\ngsap.registerPlugin(MorphSVGPlugin, DrawSVGPlugin)\n\nconst positionSvg = (textSvg) => {\n  // This function posititions the generated svg of some LaTeX code correctly in the parent svg.\n\n  let [, vy, ,] = textSvg\n    .getAttribute('viewBox')\n    .split(' ')\n    .map((s) => parseFloat(s, 10))\n  let width = parseFloat(textSvg.getAttribute('width').replace('pt', ''), 10)\n  let height = parseFloat(textSvg.getAttribute('height').replace('pt', ''), 10)\n\n  let { scale, textX, textY } = textSvg.dataset\n\n  const FONT_SCALING_FACTOR = 2\n  textX = parseFloat(textX, 10)\n  textY = parseFloat(textY, 10)\n\n  // The (x, y) of the text refers to the text anchor.\n  // The (x, y) of the svg refers to the top left corner\n  // Therefore, as the base line of the svg generated by latex is (0, 0),\n  // we translate the svg by vy, keeping in mind the SCALE and the conversion between px and pt (*1.3)\n\n  textSvg.dataset.scale = scale\n\n  textSvg.setAttribute('x', textX)\n  textSvg.setAttribute('y', textY + FONT_SCALING_FACTOR * scale * vy * 1.3)\n  textSvg.setAttribute('width', FONT_SCALING_FACTOR * scale * width + 'pt')\n  textSvg.setAttribute('height', FONT_SCALING_FACTOR * scale * height + 'pt')\n}\n\nconst replaceText = async (textEle) => {\n  // Replace text elements with their LaTeX SVG rendered equivalent\n  //\n  const text = textEle.textContent\n  if (!text) return\n\n  const textSvg = await fetchLaTeXSvg(text)\n\n  if (!textSvg) {\n    console.error('No svg for:', textEle, text)\n    return\n  }\n\n  // To make all text properly sized, we calculate the transformation matrix of the element.\n  // It is very important that the element is in the DOM (see (1))\n  // Otherwise, getScreenCTM returns null\n  const matrix = textEle.getScreenCTM()\n\n  if (!matrix) return\n\n  // Then we undo the scaling We're only using `a`, so we're assuming that the element is not skewed and scale uniformly ...\n  // FIXME later?\n  // a c e\n  // b d f\n  // 0 0 1\n\n  let scale = 1 / matrix.a\n\n  textSvg.dataset.textX = textEle.getAttribute('x')\n  textSvg.dataset.textY = textEle.getAttribute('y')\n  textSvg.dataset.scale = scale\n\n  positionSvg(textSvg)\n\n  const textContentToId = (textContent) =>\n    textContent.replace(/[^a-zA-z]+/g, '')\n\n  textSvg.id = textContentToId(textEle.textContent)\n\n  // Finally, we replace the text node with the svg.\n  textEle.parentNode.replaceChild(textSvg, textEle)\n}\n\nconst TIMING = 0.4\n\n// make awaitable?\nfunction update(svg, step, replaceImediately) {\n  for (let key in step) {\n    if (step[key] === null) {\n      continue\n    }\n    if (key.startsWith('text:')) {\n      const id = key.replace(/^text:/, '')\n      const textSvg = svg.querySelector(`svg#${id}`)\n      if (textSvg) {\n        if (replaceImediately) {\n          // remove the placeholder of the text\n          textSvg.innerHTML = ''\n        }\n        // TODO: use that animation groups database!\n        animate(\n          textSvg,\n          step[key] || '',\n          replaceImediately,\n          0.3,\n          ({ width, height, viewBox }) => {\n            textSvg.setAttribute('width', width + 'pt')\n            textSvg.setAttribute('height', height + 'pt')\n            textSvg.setAttribute('viewBox', viewBox.join(' '))\n            positionSvg(textSvg)\n          }\n        )\n      }\n    } else {\n      const ele = svg.querySelector(`#${key}`)\n      const { css = {}, ...rest } = step[key]\n      if (ele) {\n        for (let key in css) {\n          ele.style[key] = css[key]\n        }\n\n        if (replaceImediately) {\n          gsap.set(ele, { ...rest })\n        } else {\n          console.log('timing is ', rest.seconds, TIMING)\n          gsap.to(ele, rest.seconds || TIMING, { ...rest })\n        }\n      }\n    }\n  }\n}\n\nfunction AnimateSVG({ src, step = {}, width = '100%', height = 'auto' }) {\n  const element = useRef(null)\n  useEffect(() => {\n    ;(async () => {\n      // Load the svg\n      const text = await fetch(src).then((r) => r.text())\n      const div = element.current\n      if (!element.current) return\n      div.style.opacity = 0\n      // (1)\n      div.innerHTML = text\n      div.querySelector('svg').style.width = width\n      div.querySelector('svg').style.height = height\n\n      // Replace text\n      await Promise.all(\n        [...div.querySelectorAll('text')].map(async (textEle) => {\n          if (textEle.matches('.dont-replace *')) {\n            return\n          }\n\n          // Simply <text></text>\n          if (textEle.children.length === 0) {\n            await replaceText(textEle)\n          } else {\n            // Text of the form <text><tspan></tspan> ... <tspan></tspan></text>\n            const g = document.createElementNS(\n              'http://www.w3.org/2000/svg',\n              'g'\n            )\n\n            // replace text\n            await Promise.all([...textEle.children].map(replaceText))\n            // Put the svgs from the replaced text in a group\n            ;[...textEle.children].forEach((e) => g.appendChild(e))\n\n            // Replace <text><tspan/><tspan/>...</text> element with <g><svg/><svg/>...</g>\n            textEle.parentNode.replaceChild(g, textEle)\n          }\n        })\n      )\n\n      // Set the correct opacity, ... of the elements\n      if (element.current) {\n        update(element.current, step, true)\n      }\n\n      // Fade in the picture\n      div.style.transition = '0.3s opacity'\n      div.style.opacity = 1\n    })()\n  }, [element.current])\n\n  // When the step changes, animate the new opacities\n  useEffect(() => {\n    if (!element.current) return\n\n    update(element.current, step, false)\n  }, [step, element])\n\n  return (\n    <div\n      ref={element}\n      style={{\n        margin: '-1rem'\n      }}\n    />\n  )\n}\n\nexport default AnimateSVG\n","import React from 'react'\n\nimport Morph from './Morph'\n\nexport function InlineMath({ children }) {\n  return (\n    <Morph inline replace>\n      {children}\n    </Morph>\n  )\n}\n\nexport function DisplayMath({ children }) {\n  return (\n    <Morph display replace>\n      {children}\n    </Morph>\n  )\n}\n\nexport const m = (...args) => <InlineMath>{String.raw(...args)}</InlineMath>\nexport const M = (...args) => <DisplayMath>{String.raw(...args)}</DisplayMath>\n","import React from 'react'\nimport { useEffect, useState, useContext } from 'react'\n\nfunction measureText(text, style = {}) {\n  const div = document.createElement('div')\n\n  document.body.appendChild(div)\n  div.style.position = 'absolute'\n  div.style.left = -1000\n  div.style.top = -1000\n  for (let key in style) {\n    div.style[key] = style[key]\n  }\n\n  // TODO: this assumes text!\n  div.innerHTML = text\n\n  const result = {\n    width: div.clientWidth,\n    height: div.clientHeight\n  }\n\n  document.body.removeChild(div)\n\n  return result\n}\n\nfunction MObject({ children }) {\n  const [child, setChild] = useState(null)\n  const [opacity, setOpacity] = useState(1)\n  const [width, setWidth] = useState(0)\n\n  useEffect(() => {\n    setOpacity(0)\n    setWidth(measureText(children).width)\n    setTimeout(() => setChild(children), 500)\n    setTimeout(() => setOpacity(1), 500)\n  }, [children])\n\n  return (\n    <div\n      style={{\n        opacity,\n        display: 'inline-block',\n        transition: '0.5s opacity, 0.7s width',\n        width: width,\n        overflow: 'hidden',\n        verticalAlign: 'top'\n      }}\n    >\n      {child}\n    </div>\n  )\n}\n\nexport default MObject\n","import React from 'react'\nimport { useRef, useEffect, useContext } from 'react'\nimport { PresentationContext } from './Presentation'\n\nfunction getRect(element) {\n  let el = element\n  let offsetLeft = 0\n  let offsetTop = 0\n\n  do {\n    offsetLeft += el.offsetLeft // + el.clientLeft;\n    offsetTop += el.offsetTop // + el.clientTop;\n\n    el = el.offsetParent\n  } while (!el.classList.contains('slide'))\n  return {\n    left: offsetLeft,\n    top: offsetTop,\n    width: element.offsetWidth,\n    height: element.offsetHeight,\n    parentWidth: el.offsetWidth,\n    parentHeight: el.offsetHeight\n  }\n}\n\nconst addPortal = ({ i, setTransitions }, portal) => {\n  const {\n    rect: { width, height, left, top, parentWidth, parentHeight }\n  } = portal\n  const sx = parentWidth / width\n  const sy = parentHeight / height\n\n  const s = Math.max(sx, sy)\n\n  const x = left\n  const y = top\n\n  const enlarge = {\n    transformOrigin: `${x + width / 2}px ${y + height / 2}px`,\n    transform: `translate3d(${-(x + width / 2) + parentWidth / 2}px, ${\n      -(y + height / 2) + parentHeight / 2\n    }px, 0px) scaleX(${s}) scaleY(${s})`,\n    opacity: 0\n  }\n\n  const shrink = {\n    transformOrigin: `${parentWidth / 2}px ${parentHeight / 2}px`,\n    transform: `translate3d(${-parentWidth / 2 + x + width / 2}px, ${\n      -parentHeight / 2 + y + height / 2\n    }px, 0px) scaleX(${1 / s}) scaleY(${1 / s})`,\n    opacity: 0\n  }\n\n  setTransitions((transitions) => {\n    const newTransitions = { ...transitions }\n    if (portal.zoom === 'in') {\n      newTransitions[i] = {\n        ...(newTransitions[i] || {}),\n        after: enlarge\n      }\n      newTransitions[i + 1] = {\n        ...(newTransitions[i + 1] || {}),\n        before: shrink\n      }\n    }\n\n    // Problem: if out and in: current transformOrigin gets set twice!\n    // FIXME\n    if (portal.zoom === 'out') {\n      newTransitions[i - 1] = {\n        ...(newTransitions[i - 1] || {}),\n        after: shrink\n      }\n      newTransitions[i] = {\n        ...(newTransitions[i] || {}),\n        before: enlarge\n      }\n    }\n    return newTransitions\n  })\n}\n\nexport default function Portal({ children, zoomin, zoomout, ...props }) {\n  const context = useContext(PresentationContext)\n  const zoom = zoomin ? 'in' : zoomout ? 'out' : null\n\n  const domEle = useRef()\n  useEffect(() => {\n    if (!zoom) return\n    setTimeout(() => {\n      if (!domEle.current) return\n      const rect = getRect(domEle.current)\n      addPortal(context, { zoom, rect })\n    }, 200)\n  }, [domEle])\n  return (\n    <div ref={domEle} {...props}>\n      {children}\n    </div>\n  )\n}\n","import './external/tailwind.min.css'\nimport './index.css'\nimport * as modern from './themes/modern'\n\nconst themes = {\n  modern\n}\n\nexport { default as AnimateSVG } from './AnimateSVG'\nexport { Show } from './animations.js'\nexport { InlineMath, DisplayMath, m, M } from './LaTeX.js'\nexport { default as MObject } from './MObject.js'\nexport { default as Portal } from './Portal.js'\n// Presentation.js\nexport { default as Notes } from './PresenterNotes.js'\nexport { timeline, range } from './utils.js'\nexport { default as Morph } from './Morph'\nexport { themes }\n"],"names":["range","n","Array","keys","defaultTranslations","_","h","opacity","v","p","d","drawSVG","D","x","timeline","obj","stepsByKey","Object","entries","map","key","thing","steps","translations","translated","number","translate","s","hasOwnProperty","split","forEach","step","prev","length","push","parseInt","isNaN","result","stepIndex","fromEntries","fetchLaTeXSvg","tex","fetchLaTeXSvghelper","text","ele","document","createElement","innerHTML","svg","querySelector","console","error","rootId","Math","floor","random","querySelectorAll","classList","add","id","selector","getAttribute","originalId","slice","setAttribute","cacheBust","environment","process","env","NODE_ENV","HOST","window","location","hostname","memoize","fetch","encodeURIComponent","then","res","filename","md5","usePrevious","value","ref","useRef","useEffect","current","useLocalStorage","initialValue","useState","item","localStorage","getItem","JSON","parse","log","storedValue","setStoredValue","setValue","valueToStore","Function","setItem","stringify","CitationContext","React","createContext","CitationProvider","bibUrl","citationMap","children","bibliography","setBibliography","Citation","bibtex","RenderCite","render","useContext","find","e","label","format","template","lang","RenderBibliography","sortedEntries","sort","n1","n2","entry","html","Notes","global","freeGlobal","Symbol","root","objectProto","nativeObjectToString","symToStringTag","getRawTag","objectToString","isObjectLike","baseGetTag","baseIsArguments","isArray","isArguments","isFlattenable","arrayPush","baseFlatten","animate","svgEl","replaceImediately","TIMING","setSvgData","DEFAULT_TIMING","newSvg","newPaths","svgToGroupedPaths","width","parseFloat","replace","height","viewBox","afterIds","beforeIds","allIds","Set","Promise","all","shouldRemove","includes","isNew","element","remove","gsap","to","onComplete","path","createElementNS","color","colorFromGroupId","whiteListedColors","style","appendChild","morphSVG","match","p1","colorHash","registerPlugin","MorphSVGPlugin","DrawSVGPlugin","elementToPath","child","transform","ownerSVGElement","tagName","offsetX","offsetY","pathParse","relNormalize","trim","err","segments","type","newPath","serializePath","tr","y","pathData","groupIdFromElement","fill","rest","gs","group","filter","Boolean","join","byGroupId","reduce","acum","str","String","hash","i","charCodeAt","colour","toString","substr","toUpperCase","allColors","convertToTeX","selections","c","ending","starting","a","b","col","lookupAnimationGroups","start","end","data","animationGroups","startGroups","endGroups","AnimationEditor","playedAnimations","animations","setAnimations","colorIndex","setColorIndex","onKeyPress","addEventListener","removeEventListener","newOnes","animation","animated","inDataBase","anim","backgroundColor","index","findIndex","f","Animation","setAnimation","handleSelection","ev","part","background","button","target","dataset","groups","determineSelections","activeSelection","preventDefault","sel","getSelection","anchorNode","parentNode","anchorOffset","focusNode","focusOffset","min","max","newAnimation","mergeSelections","removeAllRanges","fontFamily","j","AutoMorph","setStep","onClick","colors","levels","currentActive","Morph","display","inline","debug","useAnimationDatabase","vx","vy","vw","vh","transition","setTransition","wrapMath","FONT_SCALING_FACTOR","updateSvgData","previousChildren","before","after","inner","left","marginTop","marginRight","verticalAlign","position","outline","top","flexGrow","margin","withFakeDispatcher","ctx","cb","ReactCurrentDispatcher","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","original","context","readContext","useCallback","useImperativeHandle","useLayoutEffect","useMemo","useReducer","initialState","initial","useDebugValue","useResponder","useDeferredValue","useTransition","ignore","findElementsInTree","node","predicate","found","handleTree","resolved","props","childs","flattenDeep","getPropsRecursiveUntilSlideComponentIsEncountered","RenderSlide","slide","getSlideInfo","slides","mockContextes","PresentationContext","slideIndex","infos","info","numSlides","slideWithProps","accumulatedInfo","newInfo","sectionSlide","section","hideNavigation","header","getCitations","slideInfo","presenterNotes","tree","notes","note","morphs","_source","contents","formulas","formula","trees","cite","values","Show","when","block","className","realStyle","undefined","Children","cloneElement","RenderPresentation","renderSlide","Router","Switch","Route","Redirect","PresentationUI","reactSlides","toArray","useRouteMatch","history","useHistory","useParams","transitions","setTransitions","fullScreen","setFullScreen","setSlideAndStep","generatePath","dontStepButGoToPrevSlide","next","dontStepButGoToNextSlide","handleKey","PresentationOverview","flatMap","setStyle","updateStyle","zIndex","content","call","Storage","whiteSpace","Presentation","w","threeSlides","overflow","Slide","bottom","right","borderRadius","SectionSlide","ConclusionSlide","TitleSlide","title","subtitle","names","names2","date","TableOfContentsSlide","sections","indexOf","QuestionSlide","Figure","caption","List","childArray","Item","name","listStyle","Cite","hidden","BibliographySlide","stride","items","ceil","__html","Box","smallTitle","Qed","positionSvg","textSvg","scale","textX","textY","replaceText","textEle","textContent","matrix","getScreenCTM","textContentToId","replaceChild","update","startsWith","css","set","seconds","AnimateSVG","src","r","div","matches","g","InlineMath","DisplayMath","m","raw","M","measureText","body","clientWidth","clientHeight","removeChild","MObject","setChild","setOpacity","setWidth","setTimeout","getRect","el","offsetLeft","offsetTop","offsetParent","contains","offsetWidth","offsetHeight","parentWidth","parentHeight","addPortal","portal","rect","sx","sy","enlarge","transformOrigin","shrink","newTransitions","zoom","Portal","zoomin","zoomout","domEle","themes","modern"],"mappings":"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"}