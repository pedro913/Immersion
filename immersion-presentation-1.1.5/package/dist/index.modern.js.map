{"version":3,"file":"index.modern.js","sources":["../src/Citations.tsx","../src/PresenterNotes.tsx","../node_modules/lodash/_arrayPush.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_Symbol.js","../node_modules/lodash/_getRawTag.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/_baseGetTag.js","../node_modules/lodash/isObjectLike.js","../node_modules/lodash/_baseIsArguments.js","../node_modules/lodash/isArguments.js","../node_modules/lodash/isArray.js","../node_modules/lodash/_isFlattenable.js","../node_modules/lodash/_baseFlatten.js","../node_modules/lodash/flattenDeep.js","../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/utils.ts","../src/gsap/utils/paths.js","../src/gsap/MorphSVGPlugin.js","../src/gsap/DrawSVGPlugin.js","../src/lib/morph.ts","../src/AnimationEditor.tsx","../src/Morph.tsx","../src/staticAnalysis.ts","../src/Presentation.tsx","../src/Show.tsx","../src/themes/modern/index.tsx","../src/themes/principiae/index.tsx","../src/AnimateSVG.tsx","../src/LaTeX.tsx","../src/MObject.tsx","../src/Portal.tsx","../src/timeline.ts","../src/formulas.ts","../src/index.ts"],"sourcesContent":["import React, {useEffect, useState, useContext} from 'react'\n\nimport Citation from 'citation-js'\n\n/* global fetch */\n\nexport type CitationMap = {[key: string]: number}\ntype Bibliography = {\n  label: string\n}[]\n\nexport interface CitationContextInterface {\n  citationMap: CitationMap\n  bibliography: Bibliography | null\n}\n\nexport const CitationContext = React.createContext<CitationContextInterface | null>(\n  null\n)\n\ntype CitationProviderProps = {\n  bibUrl?: string\n  citationMap: CitationMap\n  children: React.ReactNode\n}\n\nexport function CitationProvider({\n  bibUrl,\n  citationMap,\n  children\n}: CitationProviderProps): React.ReactElement {\n  const [bibliography, setBibliography] = useState<Bibliography | null>(null)\n\n  useEffect(() => {\n    ; (async () => {\n      if (!bibUrl) {\n        return\n      }\n      const text = await fetch(bibUrl).then((res) => res.text())\n      const result = Citation.parse.bibtex.text(text)\n      setBibliography(result)\n    })()\n  }, [])\n\n  return (\n    <CitationContext.Provider\n      value={{\n        bibliography,\n        citationMap\n      }}\n    >\n      {children}\n    </CitationContext.Provider>\n  )\n}\n\ntype CiteRenderFunction = (arg: {\n  text: string | null\n  number: string | number | null\n}) => React.ReactElement\n\ntype RenderCiteProps = {\n  id: string\n  render: CiteRenderFunction\n}\n\ntype BibliographyRenderFunction = (\n  items: {id: string; n: number; html: string}[]\n) => React.ReactElement\n\nexport function RenderCite({\n  id,\n  render\n}: RenderCiteProps): React.ReactElement {\n  const {citationMap = {}, bibliography} = useContext(CitationContext) || {}\n\n  return render({\n    text: bibliography\n      ? new Citation(bibliography.find((e) => e.label === id)).format(\n        'bibliography',\n        {\n          format: 'text',\n          template: 'apa',\n          lang: 'en-US'\n        }\n      )\n      : null,\n    number:\n      bibliography && !bibliography.find((e) => e.label === id)\n        ? `?? ${id}`\n        : citationMap[id] || null\n  })\n}\n\nexport function RenderBibliography({\n  render\n}: {\n  render: BibliographyRenderFunction\n}): React.ReactElement {\n  const {citationMap = {}, bibliography = []} =\n    useContext(CitationContext) || {}\n  // TODO: Slide header should work here!\n\n  const sortedEntries = Object.entries(citationMap).sort((a, b) => a[1] - b[1])\n\n  if (!bibliography) return render([])\n  return render(\n    sortedEntries.map(([id, n]) => {\n      const entry = bibliography.find((e) => e.label === id)\n      const html = new Citation(entry).format('bibliography', {\n        format: 'html',\n        template: 'apa',\n        lang: 'en-US'\n      })\n      return {id, n, html}\n    })\n  )\n}\n","import React from 'react'\n\n// FIXME would be more logical if this simply returned null\n// The presenter notes get picked up by staticAnalysis.js and it's children get rendered elsewhere\nexport default function Notes(): React.ReactNode {\n  return <div />\n}\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseFlatten = require('./_baseFlatten');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Recursively flattens `array`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flattenDeep([1, [2, [3, [4]], 5]]);\n * // => [1, 2, 3, 4, 5]\n */\nfunction flattenDeep(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, INFINITY) : [];\n}\n\nmodule.exports = flattenDeep;\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import memoize from 'memoizee'\n\nimport { pathParse, serializePath } from 'svg-path-parse'\n\nimport { useEffect, useRef, useState, useLayoutEffect } from 'react'\n\nimport { LaTeXSVGData } from './types'\n\nexport const range = (n: number): number[] => Array.from(Array(n).keys())\n\n/* global fetch */\n\nexport const hashString = function (str: string): number {\n  let hash = 0\n  let i: number\n  let chr: number\n  if (str.length === 0) return hash\n  for (i = 0; i < str.length; i++) {\n    chr = str.charCodeAt(i)\n    hash = (hash << 5) - hash + chr\n    hash |= 0 // Convert to 32bit integer\n  }\n  return hash\n}\n\nconst queryParameters = (obj: { [key: string]: string }): string => {\n  return Object.entries(obj)\n    .map(([key, value]) => `${key}=${encodeURIComponent(value)}`)\n    .join('&')\n}\n\nconst cacheBust = '8'\nexport const LaTeX = {\n  _preamble: ``,\n  _host: `http://${\n    typeof window !== 'undefined' ? window.location.hostname : 'example.com'\n  }:3001`,\n  getHost: (): string => LaTeX._host,\n  setHost: (h: string): void => {\n    LaTeX._host = h\n  },\n  getPreamble: (): string => LaTeX._preamble,\n  setPreamble: (p: string): void => {\n    LaTeX._preamble = normalizeLaTeXPreamble(p)\n  },\n  fetchSVG: async (tex: string): Promise<string> => {\n    const result = await fetch(\n      `${LaTeX.getHost()}/latex?${queryParameters({\n        cachebust: cacheBust,\n        tex: tex,\n        preamble: LaTeX.getPreamble()\n      })}`\n    )\n    if (result.ok) {\n      return await result.text()\n    } else {\n      const error = await result.json()\n      if (error.name === 'CompilationError') {\n        throw new Error(\n          `Could not compile '${error.tex}': ${error.latexErrors.join('\\n')}`\n        )\n      } else {\n        throw new Error(error.message)\n      }\n    }\n  }\n}\n\nfunction normalizeLaTeXPreamble(preamble: string) {\n  return preamble\n    .split('\\n')\n    .map((line) => line.trim())\n    .filter((line) => line !== '')\n    .join('\\n')\n}\n\nfunction elementToPath(child: SVGElement, transform = ''): string | null {\n  if (!child.ownerSVGElement) {\n    throw new Error('Found a child without ownerSVGElement')\n  }\n  const svg: SVGSVGElement = child.ownerSVGElement\n  if (child.tagName === 'use') {\n    const offsetX = parseFloat(child.getAttribute('x') || '0')\n    const offsetY = parseFloat(child.getAttribute('y') || '0')\n\n    const id = child.getAttribute('xlink:href')\n    if (!id) {\n      throw new Error('Found a use tag without an id.')\n    }\n\n    const element: SVGElement | null = svg.querySelector(id)\n    if (!element) {\n      console.error(\n        'I found a use tag with id',\n        id,\n        child,\n        \"but I didn't find a definition in the svg: \",\n        svg\n      )\n      return null\n    }\n    if (element.tagName === 'path') {\n      const path = element.getAttribute('d')\n      const { err, segments, type } = pathParse(path).relNormalize({\n        transform: `translate(${offsetX}, ${offsetY}) ${transform}`.trim()\n      })\n\n      const newPath = serializePath({ err, segments: segments, type })\n\n      return newPath\n    } else if (element.tagName === 'use') {\n      const tr = element.getAttribute('transform') || ''\n      return elementToPath(\n        element,\n        `translate(${offsetX}, ${offsetY}) ${tr}`.trim()\n      )\n    } else {\n      console.error('Unrecognized use of element', element)\n      return null\n    }\n  }\n\n  if (child.tagName === 'rect') {\n    const x = +child.getAttribute('x')!\n    const y = +child.getAttribute('y')!\n    const width = +child.getAttribute('width')!\n    const height = +child.getAttribute('height')!\n\n    const pathData =\n      'M' + x + ' ' + y + 'H' + (x + width) + 'V' + (y + height) + 'H' + x + 'z'\n    return pathData\n  }\n  // TODO polyline or something like that\n  console.error('Unrecognized:', child)\n  return null\n}\n\nfunction groupIdFromElement(element: SVGElement): string {\n  const fill = element.getAttribute('fill')\n  if (!fill) {\n    return 'g0'\n  }\n  return 'g' + fill.slice(1)\n}\n\nfunction svgToGroupedPaths(svg: SVGSVGElement) {\n  const byGroupId: { [key: string]: string } = {}\n\n  for (const child of Array.from(svg.getElementById('page1').children)) {\n    const id = groupIdFromElement(child as SVGElement)\n    let path: string | null\n    if (child.tagName === 'g') {\n      path = Array.from(child.children)\n        .map((subchild) => elementToPath(subchild as SVGElement))\n        .filter(Boolean)\n        .join(' ')\n    } else {\n      path = elementToPath(child as SVGElement)\n    }\n    if (!path) continue\n\n    if (!byGroupId[id]) {\n      byGroupId[id] = ''\n    }\n    byGroupId[id] += path\n  }\n\n  return byGroupId\n}\n\nfunction colorHash(str: string): string {\n  str = String(str)\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash)\n  }\n  let colour = ''\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xff\n    colour += ('00' + value.toString(16)).substr(-2).toUpperCase()\n  }\n  return colour\n}\n\nexport const fetchLaTeXSvg = memoize(\n  async (tex: string): Promise<LaTeXSVGData | null> => {\n    /* console.log('compiling', tex) */\n    tex = tex.replace(/\\\\g(\\d)/g, (_, p1) => `\\\\g{${colorHash(p1)}}`)\n    tex = tex.replace(/\\\\g\\{(.*?)\\}/g, (_, p1) => `\\\\g{${colorHash(p1)}}`)\n\n    // console.log('COMPILING', tex)\n    let text: string\n    try {\n      text = await LaTeX.fetchSVG(tex)\n    } catch (e) {\n      console.error(`%cLaTeXError: ${e.message}`, 'color: #AD1457')\n      return null\n    }\n\n    const ele = document.createElement('div')\n    ele.innerHTML = text\n\n    const svg = ele.querySelector('svg')\n\n    if (!svg) {\n      throw new Error(`Could not find SVG in compiled LaTeX ${tex}`)\n    }\n\n    const groups = svgToGroupedPaths(svg)\n\n    const width = svg.getAttribute('width')\n    const height = svg.getAttribute('height')\n    const viewBox = svg.getAttribute('viewBox')\n    if (!width || !height || !viewBox) {\n      throw new Error('Compiled LaTeX SVG has no height or width or viewBox')\n    }\n    return {\n      groups,\n      width: parseFloat(width.replace('pt', '')),\n      height: parseFloat(height.replace('pt', '')),\n      viewBox: viewBox.split(' ').map((s) => parseFloat(s))\n    }\n  }\n)\n\nexport function usePrevious<T>(value: T): T | undefined {\n  const ref = useRef<T>()\n  useEffect(() => {\n    ref.current = value\n  })\n  return ref.current\n}\n\n// Hook\nexport function useLocalStorage<T>(key: string, initialValue: T) {\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState<T>(() => {\n    try {\n      // Get from local storage by key\n      const item = window.localStorage.getItem(key)\n      // Parse stored json or if none return initialValue\n      return item ? JSON.parse(item) : initialValue\n    } catch (error) {\n      // If error also return initialValue\n      console.log(error)\n      return initialValue\n    }\n  })\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue = (value: T | ((t: T) => T)) => {\n    try {\n      // Allow value to be a function so we have same API as useState\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value\n      // Save state\n      setStoredValue(valueToStore)\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(valueToStore))\n    } catch (error) {\n      // A more advanced implementation would handle the error case\n      console.log(error)\n    }\n  }\n  return [storedValue, setValue] as const\n}\n\nexport const isBrowser = typeof window !== 'undefined'\nexport const useIsomorphicLayoutEffect = isBrowser ? useLayoutEffect : useEffect\n","/* eslint-disable */\n\n/*!\n * paths 3.0.5\n * https://greensock.com\n *\n * Copyright 2008-2020, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n */\n\n/* eslint-disable */\nvar _svgPathExp = /[achlmqstvz]|(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[0-9]/gi,\n  _numbersExp = /(?:(-)?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[0-9]/gi,\n  _scientific = /[\\+\\-]?\\d*\\.?\\d+e[\\+\\-]?\\d+/gi,\n  _selectorExp = /(^[#\\.][a-z]|[a-y][a-z])/i,\n  _DEG2RAD = Math.PI / 180,\n  _RAD2DEG = 180 / Math.PI,\n  _sin = Math.sin,\n  _cos = Math.cos,\n  _abs = Math.abs,\n  _sqrt = Math.sqrt,\n  _atan2 = Math.atan2,\n  _largeNum = 1e8,\n  _isString = function _isString(value) {\n    return typeof value === 'string'\n  },\n  _isNumber = function _isNumber(value) {\n    return typeof value === 'number'\n  },\n  _isUndefined = function _isUndefined(value) {\n    return typeof value === 'undefined'\n  },\n  _temp = {},\n  _temp2 = {},\n  _roundingNum = 1e5,\n  _wrapProgress = function _wrapProgress(progress) {\n    return (\n      Math.round(((progress + _largeNum) % 1) * _roundingNum) / _roundingNum ||\n      (progress < 0 ? 0 : 1)\n    )\n  },\n  //if progress lands on 1, the % will make it 0 which is why we || 1, but not if it's negative because it makes more sense for motion to end at 0 in that case.\n  _round = function _round(value) {\n    return ~~(value * _roundingNum + (value < 0 ? -0.5 : 0.5)) / _roundingNum\n  },\n  _splitSegment = function _splitSegment(rawPath, segIndex, i, t) {\n    var segment = rawPath[segIndex],\n      shift = t === 1 ? 6 : subdivideSegment(segment, i, t)\n\n    if (shift && shift + i + 2 < segment.length) {\n      rawPath.splice(segIndex, 0, segment.slice(0, i + shift + 2))\n      segment.splice(0, i + shift)\n      return 1\n    }\n  },\n  _reverseRawPath = function _reverseRawPath(rawPath, skipOuter) {\n    var i = rawPath.length\n\n    if (!skipOuter) {\n      rawPath.reverse()\n    }\n\n    while (i--) {\n      if (!rawPath[i].reversed) {\n        reverseSegment(rawPath[i])\n      }\n    }\n  },\n  _copyMetaData = function _copyMetaData(source, copy) {\n    copy.totalLength = source.totalLength\n\n    if (source.samples) {\n      //segment\n      copy.samples = source.samples.slice(0)\n      copy.lookup = source.lookup.slice(0)\n      copy.minLength = source.minLength\n      copy.resolution = source.resolution\n    } else {\n      //rawPath\n      copy.totalPoints = source.totalPoints\n    }\n\n    return copy\n  },\n  //pushes a new segment into a rawPath, but if its starting values match the ending values of the last segment, it'll merge it into that same segment (to reduce the number of segments)\n  _appendOrMerge = function _appendOrMerge(rawPath, segment) {\n    var index = rawPath.length,\n      prevSeg = rawPath[index - 1] || [],\n      l = prevSeg.length\n\n    if (segment[0] === prevSeg[l - 2] && segment[1] === prevSeg[l - 1]) {\n      segment = prevSeg.concat(segment.slice(2))\n      index--\n    }\n\n    rawPath[index] = segment\n  },\n  _bestDistance\n/* TERMINOLOGY\n - RawPath - an array of arrays, one for each Segment. A single RawPath could have multiple \"M\" commands, defining Segments (paths aren't always connected).\n - Segment - an array containing a sequence of Cubic Bezier coordinates in alternating x, y, x, y format. Starting anchor, then control point 1, control point 2, and ending anchor, then the next control point 1, control point 2, anchor, etc. Uses less memory than an array with a bunch of {x, y} points.\n - Bezier - a single cubic Bezier with a starting anchor, two control points, and an ending anchor.\n - the variable \"t\" is typically the position along an individual Bezier path (time) and it's NOT linear, meaning it could accelerate/decelerate based on the control points whereas the \"p\" or \"progress\" value is linearly mapped to the whole path, so it shouldn't really accelerate/decelerate based on control points. So a progress of 0.2 would be almost exactly 20% along the path. \"t\" is ONLY in an individual Bezier piece.\n */\n//accepts basic selector text, a path instance, a RawPath instance, or a Segment and returns a RawPath (makes it easy to homogenize things). If an element or selector text is passed in, it'll also cache the value so that if it's queried again, it'll just take the path data from there instead of parsing it all over again (as long as the path data itself hasn't changed - it'll check).\n\nexport function getRawPath(value) {\n  value =\n    _isString(value) && _selectorExp.test(value)\n      ? document.querySelector(value) || value\n      : value\n  var e = value.getAttribute ? value : 0,\n    rawPath\n\n  if (e && (value = value.getAttribute('d'))) {\n    //implements caching\n    if (!e._gsPath) {\n      e._gsPath = {}\n    }\n\n    rawPath = e._gsPath[value]\n    return rawPath && !rawPath._dirty\n      ? rawPath\n      : (e._gsPath[value] = stringToRawPath(value))\n  }\n\n  return !value\n    ? console.warn('Expecting a <path> element or an SVG path data string')\n    : _isString(value)\n    ? stringToRawPath(value)\n    : _isNumber(value[0])\n    ? [value]\n    : value\n} //copies a RawPath WITHOUT the length meta data (for speed)\n\nexport function copyRawPath(rawPath) {\n  var a = [],\n    i = 0\n\n  for (; i < rawPath.length; i++) {\n    a[i] = _copyMetaData(rawPath[i], rawPath[i].slice(0))\n  }\n\n  return _copyMetaData(rawPath, a)\n}\nexport function reverseSegment(segment) {\n  var i = 0,\n    y\n  segment.reverse() //this will invert the order y, x, y, x so we must flip it back.\n\n  for (; i < segment.length; i += 2) {\n    y = segment[i]\n    segment[i] = segment[i + 1]\n    segment[i + 1] = y\n  }\n\n  segment.reversed = !segment.reversed\n}\n\nvar _createPath = function _createPath(e, ignore) {\n    var path = document.createElementNS('http://www.w3.org/2000/svg', 'path'),\n      attr = [].slice.call(e.attributes),\n      i = attr.length,\n      name\n    ignore = ',' + ignore + ','\n\n    while (--i > -1) {\n      name = attr[i].nodeName.toLowerCase() //in Microsoft Edge, if you don't set the attribute with a lowercase name, it doesn't render correctly! Super weird.\n\n      if (ignore.indexOf(',' + name + ',') < 0) {\n        path.setAttributeNS(null, name, attr[i].nodeValue)\n      }\n    }\n\n    return path\n  },\n  _typeAttrs = {\n    rect: 'rx,ry,x,y,width,height',\n    circle: 'r,cx,cy',\n    ellipse: 'rx,ry,cx,cy',\n    line: 'x1,x2,y1,y2'\n  },\n  _attrToObj = function _attrToObj(e, attrs) {\n    var props = attrs ? attrs.split(',') : [],\n      obj = {},\n      i = props.length\n\n    while (--i > -1) {\n      obj[props[i]] = +e.getAttribute(props[i]) || 0\n    }\n\n    return obj\n  } //converts an SVG shape like <circle>, <rect>, <polygon>, <polyline>, <ellipse>, etc. to a <path>, swapping it in and copying the attributes to match.\n\nexport function convertToPath(element, swap) {\n  var type = element.tagName.toLowerCase(),\n    circ = 0.552284749831,\n    data,\n    x,\n    y,\n    r,\n    ry,\n    path,\n    rcirc,\n    rycirc,\n    points,\n    w,\n    h,\n    x2,\n    x3,\n    x4,\n    x5,\n    x6,\n    y2,\n    y3,\n    y4,\n    y5,\n    y6,\n    attr\n\n  if (type === 'path' || !element.getBBox) {\n    return element\n  }\n\n  path = _createPath(\n    element,\n    'x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points'\n  )\n  attr = _attrToObj(element, _typeAttrs[type])\n\n  if (type === 'rect') {\n    r = attr.rx\n    ry = attr.ry\n    x = attr.x\n    y = attr.y\n    w = attr.width - r * 2\n    h = attr.height - ry * 2\n\n    if (r || ry) {\n      //if there are rounded corners, render cubic beziers\n      x2 = x + r * (1 - circ)\n      x3 = x + r\n      x4 = x3 + w\n      x5 = x4 + r * circ\n      x6 = x4 + r\n      y2 = y + ry * (1 - circ)\n      y3 = y + ry\n      y4 = y3 + h\n      y5 = y4 + ry * circ\n      y6 = y4 + ry\n      data =\n        'M' +\n        x6 +\n        ',' +\n        y3 +\n        ' V' +\n        y4 +\n        ' C' +\n        [\n          x6,\n          y5,\n          x5,\n          y6,\n          x4,\n          y6,\n          x4 - (x4 - x3) / 3,\n          y6,\n          x3 + (x4 - x3) / 3,\n          y6,\n          x3,\n          y6,\n          x2,\n          y6,\n          x,\n          y5,\n          x,\n          y4,\n          x,\n          y4 - (y4 - y3) / 3,\n          x,\n          y3 + (y4 - y3) / 3,\n          x,\n          y3,\n          x,\n          y2,\n          x2,\n          y,\n          x3,\n          y,\n          x3 + (x4 - x3) / 3,\n          y,\n          x4 - (x4 - x3) / 3,\n          y,\n          x4,\n          y,\n          x5,\n          y,\n          x6,\n          y2,\n          x6,\n          y3\n        ].join(',') +\n        'z'\n    } else {\n      data =\n        'M' +\n        (x + w) +\n        ',' +\n        y +\n        ' v' +\n        h +\n        ' h' +\n        -w +\n        ' v' +\n        -h +\n        ' h' +\n        w +\n        'z'\n    }\n  } else if (type === 'circle' || type === 'ellipse') {\n    if (type === 'circle') {\n      r = ry = attr.r\n      rycirc = r * circ\n    } else {\n      r = attr.rx\n      ry = attr.ry\n      rycirc = ry * circ\n    }\n\n    x = attr.cx\n    y = attr.cy\n    rcirc = r * circ\n    data =\n      'M' +\n      (x + r) +\n      ',' +\n      y +\n      ' C' +\n      [\n        x + r,\n        y + rycirc,\n        x + rcirc,\n        y + ry,\n        x,\n        y + ry,\n        x - rcirc,\n        y + ry,\n        x - r,\n        y + rycirc,\n        x - r,\n        y,\n        x - r,\n        y - rycirc,\n        x - rcirc,\n        y - ry,\n        x,\n        y - ry,\n        x + rcirc,\n        y - ry,\n        x + r,\n        y - rycirc,\n        x + r,\n        y\n      ].join(',') +\n      'z'\n  } else if (type === 'line') {\n    data = 'M' + attr.x1 + ',' + attr.y1 + ' L' + attr.x2 + ',' + attr.y2 //previously, we just converted to \"Mx,y Lx,y\" but Safari has bugs that cause that not to render properly when using a stroke-dasharray that's not fully visible! Using a cubic bezier fixes that issue.\n  } else if (type === 'polyline' || type === 'polygon') {\n    points = (element.getAttribute('points') + '').match(_numbersExp) || []\n    x = points.shift()\n    y = points.shift()\n    data = 'M' + x + ',' + y + ' L' + points.join(',')\n\n    if (type === 'polygon') {\n      data += ',' + x + ',' + y + 'z'\n    }\n  }\n\n  path.setAttribute(\n    'd',\n    rawPathToString((path._gsRawPath = stringToRawPath(data)))\n  )\n\n  if (swap && element.parentNode) {\n    element.parentNode.insertBefore(path, element)\n    element.parentNode.removeChild(element)\n  }\n\n  return path\n} //returns the rotation (in degrees) at a particular progress on a rawPath (the slope of the tangent)\n\nexport function getRotationAtProgress(rawPath, progress) {\n  var d = getProgressData(\n    rawPath,\n    progress >= 1 ? 1 - 1e-9 : progress ? progress : 1e-9\n  )\n  return getRotationAtBezierT(d.segment, d.i, d.t)\n}\n\nfunction getRotationAtBezierT(segment, i, t) {\n  var a = segment[i],\n    b = segment[i + 2],\n    c = segment[i + 4],\n    x\n  a += (b - a) * t\n  b += (c - b) * t\n  a += (b - a) * t\n  x = b + (c + (segment[i + 6] - c) * t - b) * t - a\n  a = segment[i + 1]\n  b = segment[i + 3]\n  c = segment[i + 5]\n  a += (b - a) * t\n  b += (c - b) * t\n  a += (b - a) * t\n  return _round(\n    _atan2(b + (c + (segment[i + 7] - c) * t - b) * t - a, x) * _RAD2DEG\n  )\n}\n\nexport function sliceRawPath(rawPath, start, end) {\n  if (_isUndefined(end)) {\n    end = 1\n  }\n\n  start = start || 0\n  var reverse = start > end,\n    loops = Math.max(0, ~~(_abs(end - start) - 1e-8))\n\n  if (reverse) {\n    reverse = end\n    end = start\n    start = reverse\n    reverse = 1\n    loops -= loops ? 1 : 0\n  }\n\n  if (start < 0 || end < 0) {\n    var offset = ~~Math.min(start, end) + 1\n    start += offset\n    end += offset\n  }\n\n  var path = copyRawPath(\n      rawPath.totalLength ? rawPath : cacheRawPathMeasurements(rawPath)\n    ),\n    wrap = end > 1,\n    s = getProgressData(path, start, _temp),\n    e = getProgressData(path, end, _temp2),\n    eSeg = e.segment,\n    sSeg = s.segment,\n    eSegIndex = e.segIndex,\n    sSegIndex = s.segIndex,\n    ei = e.i,\n    si = s.i,\n    sameSegment = sSegIndex === eSegIndex,\n    sameBezier = ei === si && sameSegment,\n    invertedOrder = (sameSegment && si > ei) || (sameBezier && s.t > e.t),\n    sShift,\n    eShift,\n    i,\n    copy,\n    totalSegments,\n    l,\n    j\n\n  if (wrap || loops) {\n    if (_splitSegment(path, sSegIndex, si, s.t)) {\n      sShift = 1\n      sSegIndex++\n\n      if (sameBezier) {\n        if (invertedOrder) {\n          e.t /= s.t\n        } else {\n          e.t = (e.t - s.t) / (1 - s.t)\n          eSegIndex++\n          ei = 0\n        }\n      } else if (sSegIndex <= eSegIndex + 1 && !invertedOrder) {\n        eSegIndex++\n\n        if (sameSegment) {\n          ei -= si\n        }\n      }\n    }\n\n    if (!e.t) {\n      eSegIndex--\n\n      if (reverse) {\n        sSegIndex--\n      }\n    } else if (_splitSegment(path, eSegIndex, ei, e.t)) {\n      if (invertedOrder && sShift) {\n        sSegIndex++\n      }\n\n      if (reverse) {\n        eSegIndex++\n      }\n    }\n\n    copy = []\n    totalSegments = path.length\n    l = 1 + totalSegments * loops\n    j = sSegIndex\n\n    if (reverse) {\n      eSegIndex = (eSegIndex || totalSegments) - 1\n      l += (totalSegments - eSegIndex + sSegIndex) % totalSegments\n\n      for (i = 0; i < l; i++) {\n        _appendOrMerge(copy, path[j])\n\n        j = (j || totalSegments) - 1\n      }\n    } else {\n      l += (totalSegments - sSegIndex + eSegIndex) % totalSegments\n\n      for (i = 0; i < l; i++) {\n        _appendOrMerge(copy, path[j++ % totalSegments])\n      }\n    }\n\n    path = copy\n  } else {\n    eShift = e.t === 1 ? 6 : subdivideSegment(eSeg, ei, e.t)\n\n    if (start !== end) {\n      sShift = subdivideSegment(sSeg, si, sameBezier ? s.t / e.t : s.t)\n\n      if (sameSegment) {\n        eShift += sShift\n      }\n\n      eSeg.splice(ei + eShift + 2)\n\n      if (sShift) {\n        sSeg.splice(0, si + sShift)\n      }\n\n      i = path.length\n\n      while (i--) {\n        //chop off any extra segments\n        if (i < sSegIndex || i > eSegIndex) {\n          path.splice(i, 1)\n        }\n      }\n    } else {\n      eSeg.angle = getRotationAtBezierT(eSeg, ei + eShift, 0) //record the value before we chop because it'll be impossible to determine the angle after its length is 0!\n\n      ei += eShift\n      s = eSeg[ei]\n      e = eSeg[ei + 1]\n      eSeg.length = eSeg.totalLength = 0\n      eSeg.totalPoints = path.totalPoints = 8\n      eSeg.push(s, e, s, e, s, e, s, e)\n    }\n  }\n\n  if (reverse) {\n    _reverseRawPath(path, wrap || loops)\n  }\n\n  path.totalLength = 0\n  return path\n} //measures a Segment according to its resolution (so if segment.resolution is 6, for example, it'll take 6 samples equally across each Bezier) and create/populate a \"samples\" array that has the length up to each of those sample points (always increasing from the start) as well as a \"lookup\" array that's broken up according to the smallest distance between 2 samples. This gives us a very fast way of looking up a progress position rather than looping through all the points/Beziers. You can optionally have it only measure a subset, starting at startIndex and going for a specific number of beziers (remember, there are 3 x/y pairs each, for a total of 6 elements for each Bezier). It will also populate a \"totalLength\" property, but that's not generally super accurate because by default it'll only take 6 samples per Bezier. But for performance reasons, it's perfectly adequate for measuring progress values along the path. If you need a more accurate totalLength, either increase the resolution or use the more advanced bezierToPoints() method which keeps adding points until they don't deviate by more than a certain precision value.\n\nfunction measureSegment(segment, startIndex, bezierQty) {\n  startIndex = startIndex || 0\n\n  if (!segment.samples) {\n    segment.samples = []\n    segment.lookup = []\n  }\n\n  var resolution = ~~segment.resolution || 12,\n    inc = 1 / resolution,\n    endIndex = bezierQty ? startIndex + bezierQty * 6 + 1 : segment.length,\n    x1 = segment[startIndex],\n    y1 = segment[startIndex + 1],\n    samplesIndex = startIndex ? (startIndex / 6) * resolution : 0,\n    samples = segment.samples,\n    lookup = segment.lookup,\n    min = (startIndex ? segment.minLength : _largeNum) || _largeNum,\n    prevLength = samples[samplesIndex + bezierQty * resolution - 1],\n    length = startIndex ? samples[samplesIndex - 1] : 0,\n    i,\n    j,\n    x4,\n    x3,\n    x2,\n    xd,\n    xd1,\n    y4,\n    y3,\n    y2,\n    yd,\n    yd1,\n    inv,\n    t,\n    lengthIndex,\n    l,\n    segLength\n  samples.length = lookup.length = 0\n\n  for (j = startIndex + 2; j < endIndex; j += 6) {\n    x4 = segment[j + 4] - x1\n    x3 = segment[j + 2] - x1\n    x2 = segment[j] - x1\n    y4 = segment[j + 5] - y1\n    y3 = segment[j + 3] - y1\n    y2 = segment[j + 1] - y1\n    xd = xd1 = yd = yd1 = 0\n\n    if (_abs(x4) < 1e-5 && _abs(y4) < 1e-5 && _abs(x2) + _abs(y2) < 1e-5) {\n      //dump points that are sufficiently close (basically right on top of each other, making a bezier super tiny or 0 length)\n      if (segment.length > 8) {\n        segment.splice(j, 6)\n        j -= 6\n        endIndex -= 6\n      }\n    } else {\n      for (i = 1; i <= resolution; i++) {\n        t = inc * i\n        inv = 1 - t\n        xd = xd1 - (xd1 = (t * t * x4 + 3 * inv * (t * x3 + inv * x2)) * t)\n        yd = yd1 - (yd1 = (t * t * y4 + 3 * inv * (t * y3 + inv * y2)) * t)\n        l = _sqrt(yd * yd + xd * xd)\n\n        if (l < min) {\n          min = l\n        }\n\n        length += l\n        samples[samplesIndex++] = length\n      }\n    }\n\n    x1 += x4\n    y1 += y4\n  }\n\n  if (prevLength) {\n    prevLength -= length\n\n    for (; samplesIndex < samples.length; samplesIndex++) {\n      samples[samplesIndex] += prevLength\n    }\n  }\n\n  if (samples.length && min) {\n    segment.totalLength = segLength = samples[samples.length - 1] || 0\n    segment.minLength = min\n    l = lengthIndex = 0\n\n    for (i = 0; i < segLength; i += min) {\n      lookup[l++] = samples[lengthIndex] < i ? ++lengthIndex : lengthIndex\n    }\n  } else {\n    segment.totalLength = samples[0] = 0\n  }\n\n  return startIndex ? length - samples[startIndex / 2 - 1] : length\n}\n\nexport function cacheRawPathMeasurements(rawPath, resolution) {\n  var pathLength, points, i\n\n  for (i = pathLength = points = 0; i < rawPath.length; i++) {\n    rawPath[i].resolution = ~~resolution || 12 //steps per Bezier curve (anchor, 2 control points, to anchor)\n\n    points += rawPath[i].length\n    pathLength += measureSegment(rawPath[i])\n  }\n\n  rawPath.totalPoints = points\n  rawPath.totalLength = pathLength\n  return rawPath\n} //divide segment[i] at position t (value between 0 and 1, progress along that particular cubic bezier segment that starts at segment[i]). Returns how many elements were spliced into the segment array (either 0 or 6)\n\nexport function subdivideSegment(segment, i, t) {\n  if (t <= 0 || t >= 1) {\n    return 0\n  }\n\n  var ax = segment[i],\n    ay = segment[i + 1],\n    cp1x = segment[i + 2],\n    cp1y = segment[i + 3],\n    cp2x = segment[i + 4],\n    cp2y = segment[i + 5],\n    bx = segment[i + 6],\n    by = segment[i + 7],\n    x1a = ax + (cp1x - ax) * t,\n    x2 = cp1x + (cp2x - cp1x) * t,\n    y1a = ay + (cp1y - ay) * t,\n    y2 = cp1y + (cp2y - cp1y) * t,\n    x1 = x1a + (x2 - x1a) * t,\n    y1 = y1a + (y2 - y1a) * t,\n    x2a = cp2x + (bx - cp2x) * t,\n    y2a = cp2y + (by - cp2y) * t\n  x2 += (x2a - x2) * t\n  y2 += (y2a - y2) * t\n  segment.splice(\n    i + 2,\n    4,\n    _round(x1a), //first control point\n    _round(y1a),\n    _round(x1), //second control point\n    _round(y1),\n    _round(x1 + (x2 - x1) * t), //new fabricated anchor on line\n    _round(y1 + (y2 - y1) * t),\n    _round(x2), //third control point\n    _round(y2),\n    _round(x2a), //fourth control point\n    _round(y2a)\n  )\n\n  if (segment.samples) {\n    segment.samples.splice(\n      ((i / 6) * segment.resolution) | 0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0\n    )\n  }\n\n  return 6\n} // returns an object {path, segment, segIndex, i, t}\n\nfunction getProgressData(rawPath, progress, decoratee) {\n  decoratee = decoratee || {}\n\n  if (!rawPath.totalLength) {\n    cacheRawPathMeasurements(rawPath)\n  }\n\n  if (progress < 0 || progress > 1) {\n    progress = _wrapProgress(progress)\n  }\n\n  var segIndex = 0,\n    segment = rawPath[0],\n    samples,\n    resolution,\n    length,\n    min,\n    max,\n    i\n\n  if (rawPath.length > 1) {\n    //speed optimization: most of the time, there's only one segment so skip the recursion.\n    length = rawPath.totalLength * progress\n    max = i = 0\n\n    while ((max += rawPath[i++].totalLength) < length) {\n      segIndex = i\n    }\n\n    segment = rawPath[segIndex]\n    min = max - segment.totalLength\n    progress = (length - min) / (max - min) || 0\n  }\n\n  samples = segment.samples\n  resolution = segment.resolution //how many samples per cubic bezier chunk\n\n  length = segment.totalLength * progress\n  i = segment.lookup[~~(length / segment.minLength)] || 0\n  min = i ? samples[i - 1] : 0\n  max = samples[i]\n\n  if (max < length) {\n    min = max\n    max = samples[++i]\n  }\n\n  decoratee.path = rawPath\n  decoratee.segment = segment\n  decoratee.segIndex = segIndex\n  decoratee.i = ~~(i / resolution) * 6\n  decoratee.t =\n    (1 / resolution) * ((length - min) / (max - min) + (i % resolution))\n  return decoratee\n}\n\nexport function getPositionOnPath(rawPath, progress, includeAngle, point) {\n  var segment = rawPath[0],\n    result = point || {},\n    samples,\n    resolution,\n    length,\n    min,\n    max,\n    i,\n    t,\n    a,\n    inv\n\n  if (progress < 0 || progress > 1) {\n    progress = _wrapProgress(progress)\n  }\n\n  if (rawPath.length > 1) {\n    //speed optimization: most of the time, there's only one segment so skip the recursion.\n    length = rawPath.totalLength * progress\n    max = i = 0\n\n    while ((max += rawPath[i++].totalLength) < length) {\n      segment = rawPath[i]\n    }\n\n    min = max - segment.totalLength\n    progress = (length - min) / (max - min) || 0\n  }\n\n  samples = segment.samples\n  resolution = segment.resolution\n  length = segment.totalLength * progress\n  i = segment.lookup[~~(length / segment.minLength)] || 0\n  min = i ? samples[i - 1] : 0\n  max = samples[i]\n\n  if (max < length) {\n    min = max\n    max = samples[++i]\n  }\n\n  t = (1 / resolution) * ((length - min) / (max - min) + (i % resolution)) || 0\n  inv = 1 - t\n  i = ~~(i / resolution) * 6\n  a = segment[i]\n  result.x = _round(\n    (t * t * (segment[i + 6] - a) +\n      3 * inv * (t * (segment[i + 4] - a) + inv * (segment[i + 2] - a))) *\n      t +\n      a\n  )\n  result.y = _round(\n    (t * t * (segment[i + 7] - (a = segment[i + 1])) +\n      3 * inv * (t * (segment[i + 5] - a) + inv * (segment[i + 3] - a))) *\n      t +\n      a\n  )\n\n  if (includeAngle) {\n    result.angle = segment.totalLength\n      ? getRotationAtBezierT(segment, i, t >= 1 ? 1 - 1e-9 : t ? t : 1e-9)\n      : segment.angle || 0\n  }\n\n  return result\n} //applies a matrix transform to RawPath (or a segment in a RawPath) and returns whatever was passed in (it transforms the values in the array(s), not a copy).\n\nexport function transformRawPath(rawPath, a, b, c, d, tx, ty) {\n  var j = rawPath.length,\n    segment,\n    l,\n    i,\n    x,\n    y\n\n  while (--j > -1) {\n    segment = rawPath[j]\n    l = segment.length\n\n    for (i = 0; i < l; i += 2) {\n      x = segment[i]\n      y = segment[i + 1]\n      segment[i] = x * a + y * c + tx\n      segment[i + 1] = x * b + y * d + ty\n    }\n  }\n\n  rawPath._dirty = 1\n  return rawPath\n} // translates SVG arc data into a segment (cubic beziers). Angle is in degrees.\n\nfunction arcToSegment(\n  lastX,\n  lastY,\n  rx,\n  ry,\n  angle,\n  largeArcFlag,\n  sweepFlag,\n  x,\n  y\n) {\n  if (lastX === x && lastY === y) {\n    return\n  }\n\n  rx = _abs(rx)\n  ry = _abs(ry)\n\n  var angleRad = (angle % 360) * _DEG2RAD,\n    cosAngle = _cos(angleRad),\n    sinAngle = _sin(angleRad),\n    PI = Math.PI,\n    TWOPI = PI * 2,\n    dx2 = (lastX - x) / 2,\n    dy2 = (lastY - y) / 2,\n    x1 = cosAngle * dx2 + sinAngle * dy2,\n    y1 = -sinAngle * dx2 + cosAngle * dy2,\n    x1_sq = x1 * x1,\n    y1_sq = y1 * y1,\n    radiiCheck = x1_sq / (rx * rx) + y1_sq / (ry * ry)\n\n  if (radiiCheck > 1) {\n    rx = _sqrt(radiiCheck) * rx\n    ry = _sqrt(radiiCheck) * ry\n  }\n\n  var rx_sq = rx * rx,\n    ry_sq = ry * ry,\n    sq =\n      (rx_sq * ry_sq - rx_sq * y1_sq - ry_sq * x1_sq) /\n      (rx_sq * y1_sq + ry_sq * x1_sq)\n\n  if (sq < 0) {\n    sq = 0\n  }\n\n  var coef = (largeArcFlag === sweepFlag ? -1 : 1) * _sqrt(sq),\n    cx1 = coef * ((rx * y1) / ry),\n    cy1 = coef * -((ry * x1) / rx),\n    sx2 = (lastX + x) / 2,\n    sy2 = (lastY + y) / 2,\n    cx = sx2 + (cosAngle * cx1 - sinAngle * cy1),\n    cy = sy2 + (sinAngle * cx1 + cosAngle * cy1),\n    ux = (x1 - cx1) / rx,\n    uy = (y1 - cy1) / ry,\n    vx = (-x1 - cx1) / rx,\n    vy = (-y1 - cy1) / ry,\n    temp = ux * ux + uy * uy,\n    angleStart = (uy < 0 ? -1 : 1) * Math.acos(ux / _sqrt(temp)),\n    angleExtent =\n      (ux * vy - uy * vx < 0 ? -1 : 1) *\n      Math.acos((ux * vx + uy * vy) / _sqrt(temp * (vx * vx + vy * vy)))\n\n  if (isNaN(angleExtent)) {\n    //rare edge case. Math.cos(-1) is NaN.\n    angleExtent = PI\n  }\n\n  if (!sweepFlag && angleExtent > 0) {\n    angleExtent -= TWOPI\n  } else if (sweepFlag && angleExtent < 0) {\n    angleExtent += TWOPI\n  }\n\n  angleStart %= TWOPI\n  angleExtent %= TWOPI\n\n  var segments = Math.ceil(_abs(angleExtent) / (TWOPI / 4)),\n    rawPath = [],\n    angleIncrement = angleExtent / segments,\n    controlLength =\n      ((4 / 3) * _sin(angleIncrement / 2)) / (1 + _cos(angleIncrement / 2)),\n    ma = cosAngle * rx,\n    mb = sinAngle * rx,\n    mc = sinAngle * -ry,\n    md = cosAngle * ry,\n    i\n\n  for (i = 0; i < segments; i++) {\n    angle = angleStart + i * angleIncrement\n    x1 = _cos(angle)\n    y1 = _sin(angle)\n    ux = _cos((angle += angleIncrement))\n    uy = _sin(angle)\n    rawPath.push(\n      x1 - controlLength * y1,\n      y1 + controlLength * x1,\n      ux + controlLength * uy,\n      uy - controlLength * ux,\n      ux,\n      uy\n    )\n  } //now transform according to the actual size of the ellipse/arc (the beziers were noramlized, between 0 and 1 on a circle).\n\n  for (i = 0; i < rawPath.length; i += 2) {\n    x1 = rawPath[i]\n    y1 = rawPath[i + 1]\n    rawPath[i] = x1 * ma + y1 * mc + cx\n    rawPath[i + 1] = x1 * mb + y1 * md + cy\n  }\n\n  rawPath[i - 2] = x //always set the end to exactly where it's supposed to be\n\n  rawPath[i - 1] = y\n  return rawPath\n} //Spits back a RawPath with absolute coordinates. Each segment starts with a \"moveTo\" command (x coordinate, then y) and then 2 control points (x, y, x, y), then anchor. The goal is to minimize memory and maximize speed.\n\nexport function stringToRawPath(d) {\n  var a =\n      (d + '')\n        .replace(_scientific, function (m) {\n          var n = +m\n          return n < 0.0001 && n > -0.0001 ? 0 : n\n        })\n        .match(_svgPathExp) || [],\n    //some authoring programs spit out very small numbers in scientific notation like \"1e-5\", so make sure we round that down to 0 first.\n    path = [],\n    relativeX = 0,\n    relativeY = 0,\n    twoThirds = 2 / 3,\n    elements = a.length,\n    points = 0,\n    errorMessage = 'ERROR: malformed path: ' + d,\n    i,\n    j,\n    x,\n    y,\n    command,\n    isRelative,\n    segment,\n    startX,\n    startY,\n    difX,\n    difY,\n    beziers,\n    prevCommand,\n    flag1,\n    flag2,\n    line = function line(sx, sy, ex, ey) {\n      difX = (ex - sx) / 3\n      difY = (ey - sy) / 3\n      segment.push(sx + difX, sy + difY, ex - difX, ey - difY, ex, ey)\n    }\n\n  if (!d || !isNaN(a[0]) || isNaN(a[1])) {\n    console.log(errorMessage)\n    return path\n  }\n\n  for (i = 0; i < elements; i++) {\n    prevCommand = command\n\n    if (isNaN(a[i])) {\n      command = a[i].toUpperCase()\n      isRelative = command !== a[i] //lower case means relative\n    } else {\n      //commands like \"C\" can be strung together without any new command characters between.\n      i--\n    }\n\n    x = +a[i + 1]\n    y = +a[i + 2]\n\n    if (isRelative) {\n      x += relativeX\n      y += relativeY\n    }\n\n    if (!i) {\n      startX = x\n      startY = y\n    } // \"M\" (move)\n\n    if (command === 'M') {\n      if (segment) {\n        if (segment.length < 8) {\n          //if the path data was funky and just had a M with no actual drawing anywhere, skip it.\n          path.length -= 1\n        } else {\n          points += segment.length\n        }\n      }\n\n      relativeX = startX = x\n      relativeY = startY = y\n      segment = [x, y]\n      path.push(segment)\n      i += 2\n      command = 'L' //an \"M\" with more than 2 values gets interpreted as \"lineTo\" commands (\"L\").\n      // \"C\" (cubic bezier)\n    } else if (command === 'C') {\n      if (!segment) {\n        segment = [0, 0]\n      }\n\n      if (!isRelative) {\n        relativeX = relativeY = 0\n      } //note: \"*1\" is just a fast/short way to cast the value as a Number. WAAAY faster in Chrome, slightly slower in Firefox.\n\n      segment.push(\n        x,\n        y,\n        relativeX + a[i + 3] * 1,\n        relativeY + a[i + 4] * 1,\n        (relativeX += a[i + 5] * 1),\n        (relativeY += a[i + 6] * 1)\n      )\n      i += 6 // \"S\" (continuation of cubic bezier)\n    } else if (command === 'S') {\n      difX = relativeX\n      difY = relativeY\n\n      if (prevCommand === 'C' || prevCommand === 'S') {\n        difX += relativeX - segment[segment.length - 4]\n        difY += relativeY - segment[segment.length - 3]\n      }\n\n      if (!isRelative) {\n        relativeX = relativeY = 0\n      }\n\n      segment.push(\n        difX,\n        difY,\n        x,\n        y,\n        (relativeX += a[i + 3] * 1),\n        (relativeY += a[i + 4] * 1)\n      )\n      i += 4 // \"Q\" (quadratic bezier)\n    } else if (command === 'Q') {\n      difX = relativeX + (x - relativeX) * twoThirds\n      difY = relativeY + (y - relativeY) * twoThirds\n\n      if (!isRelative) {\n        relativeX = relativeY = 0\n      }\n\n      relativeX += a[i + 3] * 1\n      relativeY += a[i + 4] * 1\n      segment.push(\n        difX,\n        difY,\n        relativeX + (x - relativeX) * twoThirds,\n        relativeY + (y - relativeY) * twoThirds,\n        relativeX,\n        relativeY\n      )\n      i += 4 // \"T\" (continuation of quadratic bezier)\n    } else if (command === 'T') {\n      difX = relativeX - segment[segment.length - 4]\n      difY = relativeY - segment[segment.length - 3]\n      segment.push(\n        relativeX + difX,\n        relativeY + difY,\n        x + (relativeX + difX * 1.5 - x) * twoThirds,\n        y + (relativeY + difY * 1.5 - y) * twoThirds,\n        (relativeX = x),\n        (relativeY = y)\n      )\n      i += 2 // \"H\" (horizontal line)\n    } else if (command === 'H') {\n      line(relativeX, relativeY, (relativeX = x), relativeY)\n      i += 1 // \"V\" (vertical line)\n    } else if (command === 'V') {\n      //adjust values because the first (and only one) isn't x in this case, it's y.\n      line(\n        relativeX,\n        relativeY,\n        relativeX,\n        (relativeY = x + (isRelative ? relativeY - relativeX : 0))\n      )\n      i += 1 // \"L\" (line) or \"Z\" (close)\n    } else if (command === 'L' || command === 'Z') {\n      if (command === 'Z') {\n        x = startX\n        y = startY\n        segment.closed = true\n      }\n\n      if (\n        command === 'L' ||\n        _abs(relativeX - x) > 0.5 ||\n        _abs(relativeY - y) > 0.5\n      ) {\n        line(relativeX, relativeY, x, y)\n\n        if (command === 'L') {\n          i += 2\n        }\n      }\n\n      relativeX = x\n      relativeY = y // \"A\" (arc)\n    } else if (command === 'A') {\n      flag1 = a[i + 4]\n      flag2 = a[i + 5]\n      difX = a[i + 6]\n      difY = a[i + 7]\n      j = 7\n\n      if (flag1.length > 1) {\n        // for cases when the flags are merged, like \"a8 8 0 018 8\" (the 0 and 1 flags are WITH the x value of 8, but it could also be \"a8 8 0 01-8 8\" so it may include x or not)\n        if (flag1.length < 3) {\n          difY = difX\n          difX = flag2\n          j--\n        } else {\n          difY = flag2\n          difX = flag1.substr(2)\n          j -= 2\n        }\n\n        flag2 = flag1.charAt(1)\n        flag1 = flag1.charAt(0)\n      }\n\n      beziers = arcToSegment(\n        relativeX,\n        relativeY,\n        +a[i + 1],\n        +a[i + 2],\n        +a[i + 3],\n        +flag1,\n        +flag2,\n        (isRelative ? relativeX : 0) + difX * 1,\n        (isRelative ? relativeY : 0) + difY * 1\n      )\n      i += j\n\n      if (beziers) {\n        for (j = 0; j < beziers.length; j++) {\n          segment.push(beziers[j])\n        }\n      }\n\n      relativeX = segment[segment.length - 2]\n      relativeY = segment[segment.length - 1]\n    } else {\n      console.log(errorMessage)\n    }\n  }\n\n  i = segment.length\n\n  if (i < 6) {\n    //in case there's odd SVG like a M0,0 command at the very end.\n    path.pop()\n    i = 0\n  } else if (segment[0] === segment[i - 2] && segment[1] === segment[i - 1]) {\n    segment.closed = true\n  }\n\n  path.totalPoints = points + i\n  return path\n} //populates the points array in alternating x/y values (like [x, y, x, y...] instead of individual point objects [{x, y}, {x, y}...] to conserve memory and stay in line with how we're handling segment arrays\n\nexport function bezierToPoints(\n  x1,\n  y1,\n  x2,\n  y2,\n  x3,\n  y3,\n  x4,\n  y4,\n  threshold,\n  points,\n  index\n) {\n  var x12 = (x1 + x2) / 2,\n    y12 = (y1 + y2) / 2,\n    x23 = (x2 + x3) / 2,\n    y23 = (y2 + y3) / 2,\n    x34 = (x3 + x4) / 2,\n    y34 = (y3 + y4) / 2,\n    x123 = (x12 + x23) / 2,\n    y123 = (y12 + y23) / 2,\n    x234 = (x23 + x34) / 2,\n    y234 = (y23 + y34) / 2,\n    x1234 = (x123 + x234) / 2,\n    y1234 = (y123 + y234) / 2,\n    dx = x4 - x1,\n    dy = y4 - y1,\n    d2 = _abs((x2 - x4) * dy - (y2 - y4) * dx),\n    d3 = _abs((x3 - x4) * dy - (y3 - y4) * dx),\n    length\n\n  if (!points) {\n    points = [x1, y1, x4, y4]\n    index = 2\n  }\n\n  points.splice(index || points.length - 2, 0, x1234, y1234)\n\n  if ((d2 + d3) * (d2 + d3) > threshold * (dx * dx + dy * dy)) {\n    length = points.length\n    bezierToPoints(\n      x1,\n      y1,\n      x12,\n      y12,\n      x123,\n      y123,\n      x1234,\n      y1234,\n      threshold,\n      points,\n      index\n    )\n    bezierToPoints(\n      x1234,\n      y1234,\n      x234,\n      y234,\n      x34,\n      y34,\n      x4,\n      y4,\n      threshold,\n      points,\n      index + 2 + (points.length - length)\n    )\n  }\n\n  return points\n}\n/*\nfunction getAngleBetweenPoints(x0, y0, x1, y1, x2, y2) { //angle between 3 points in radians\n\tvar dx1 = x1 - x0,\n\t\tdy1 = y1 - y0,\n\t\tdx2 = x2 - x1,\n\t\tdy2 = y2 - y1,\n\t\tdx3 = x2 - x0,\n\t\tdy3 = y2 - y0,\n\t\ta = dx1 * dx1 + dy1 * dy1,\n\t\tb = dx2 * dx2 + dy2 * dy2,\n\t\tc = dx3 * dx3 + dy3 * dy3;\n\treturn Math.acos( (a + b - c) / _sqrt(4 * a * b) );\n},\n*/\n//pointsToSegment() doesn't handle flat coordinates (where y is always 0) the way we need (the resulting control points are always right on top of the anchors), so this function basically makes the control points go directly up and down, varying in length based on the curviness (more curvy, further control points)\n\nexport function flatPointsToSegment(points, curviness) {\n  if (curviness === void 0) {\n    curviness = 1\n  }\n\n  var x = points[0],\n    y = 0,\n    segment = [x, y],\n    i = 2\n\n  for (; i < points.length; i += 2) {\n    segment.push(\n      x,\n      y,\n      points[i],\n      (y = ((points[i] - x) * curviness) / 2),\n      (x = points[i]),\n      -y\n    )\n  }\n\n  return segment\n} //points is an array of x/y points, like [x, y, x, y, x, y]\n\nexport function pointsToSegment(points, curviness, cornerThreshold) {\n  //points = simplifyPoints(points, tolerance);\n  var l = points.length - 2,\n    x = +points[0],\n    y = +points[1],\n    nextX = +points[2],\n    nextY = +points[3],\n    segment = [x, y, x, y],\n    dx2 = nextX - x,\n    dy2 = nextY - y,\n    prevX,\n    prevY,\n    angle,\n    slope,\n    i,\n    dx1,\n    dx3,\n    dy1,\n    dy3,\n    d1,\n    d2,\n    a,\n    b,\n    c\n\n  if (isNaN(cornerThreshold)) {\n    cornerThreshold = Math.PI / 10\n  }\n\n  curviness = curviness || curviness === 0 ? +curviness : 1\n\n  for (i = 2; i < l; i += 2) {\n    prevX = x\n    prevY = y\n    x = nextX\n    y = nextY\n    nextX = +points[i + 2]\n    nextY = +points[i + 3]\n    dx1 = dx2\n    dy1 = dy2\n    dx2 = nextX - x\n    dy2 = nextY - y\n    dx3 = nextX - prevX\n    dy3 = nextY - prevY\n    a = dx1 * dx1 + dy1 * dy1\n    b = dx2 * dx2 + dy2 * dy2\n    c = dx3 * dx3 + dy3 * dy3\n    angle = Math.acos((a + b - c) / _sqrt(4 * a * b)) //angle between the 3 points\n\n    d2 = (angle / Math.PI) * curviness //temporary precalculation for speed (reusing d2 variable)\n\n    d1 = _sqrt(a) * d2 //the tighter the angle, the shorter we make the handles in proportion.\n\n    d2 *= _sqrt(b)\n\n    if (x !== prevX || y !== prevY) {\n      if (angle > cornerThreshold) {\n        slope = _atan2(dy3, dx3)\n        segment.push(\n          _round(x - _cos(slope) * d1), //first control point\n          _round(y - _sin(slope) * d1),\n          _round(x), //anchor\n          _round(y),\n          _round(x + _cos(slope) * d2), //second control point\n          _round(y + _sin(slope) * d2)\n        )\n      } else {\n        slope = _atan2(dy1, dx1)\n        segment.push(\n          _round(x - _cos(slope) * d1), //first control point\n          _round(y - _sin(slope) * d1)\n        )\n        slope = _atan2(dy2, dx2)\n        segment.push(\n          _round(x), //anchor\n          _round(y),\n          _round(x + _cos(slope) * d2), //second control point\n          _round(y + _sin(slope) * d2)\n        )\n      }\n    }\n  }\n\n  segment.push(_round(nextX), _round(nextY), _round(nextX), _round(nextY))\n  return segment\n} //returns the squared distance between an x/y coordinate and a segment between x1/y1 and x2/y2\n\nfunction pointToSegDist(x, y, x1, y1, x2, y2) {\n  var dx = x2 - x1,\n    dy = y2 - y1,\n    t\n\n  if (dx || dy) {\n    t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy)\n\n    if (t > 1) {\n      x1 = x2\n      y1 = y2\n    } else if (t > 0) {\n      x1 += dx * t\n      y1 += dy * t\n    }\n  }\n\n  return Math.pow(x - x1, 2) + Math.pow(y - y1, 2)\n}\n\nfunction simplifyStep(points, first, last, tolerance, simplified) {\n  var maxSqDist = tolerance,\n    firstX = points[first],\n    firstY = points[first + 1],\n    lastX = points[last],\n    lastY = points[last + 1],\n    index,\n    i,\n    d\n\n  for (i = first + 2; i < last; i += 2) {\n    d = pointToSegDist(points[i], points[i + 1], firstX, firstY, lastX, lastY)\n\n    if (d > maxSqDist) {\n      index = i\n      maxSqDist = d\n    }\n  }\n\n  if (maxSqDist > tolerance) {\n    if (index - first > 2) {\n      simplifyStep(points, first, index, tolerance, simplified)\n    }\n\n    simplified.push(points[index], points[index + 1])\n\n    if (last - index > 2) {\n      simplifyStep(points, index, last, tolerance, simplified)\n    }\n  }\n} //points is an array of x/y values like [x, y, x, y, x, y]\n\nexport function simplifyPoints(points, tolerance) {\n  var prevX = parseFloat(points[0]),\n    prevY = parseFloat(points[1]),\n    temp = [prevX, prevY],\n    l = points.length - 2,\n    i,\n    x,\n    y,\n    dx,\n    dy,\n    result,\n    last\n  tolerance = Math.pow(tolerance || 1, 2)\n\n  for (i = 2; i < l; i += 2) {\n    x = parseFloat(points[i])\n    y = parseFloat(points[i + 1])\n    dx = prevX - x\n    dy = prevY - y\n\n    if (dx * dx + dy * dy > tolerance) {\n      temp.push(x, y)\n      prevX = x\n      prevY = y\n    }\n  }\n\n  temp.push(parseFloat(points[l]), parseFloat(points[l + 1]))\n  last = temp.length - 2\n  result = [temp[0], temp[1]]\n  simplifyStep(temp, 0, last, tolerance, result)\n  result.push(temp[last], temp[last + 1])\n  return result\n}\n\nfunction getClosestProgressOnBezier(\n  iterations,\n  px,\n  py,\n  start,\n  end,\n  slices,\n  x0,\n  y0,\n  x1,\n  y1,\n  x2,\n  y2,\n  x3,\n  y3\n) {\n  var inc = (end - start) / slices,\n    best = 0,\n    t = start,\n    x,\n    y,\n    d,\n    dx,\n    dy,\n    inv\n  _bestDistance = _largeNum\n\n  while (t <= end) {\n    inv = 1 - t\n    x =\n      inv * inv * inv * x0 +\n      3 * inv * inv * t * x1 +\n      3 * inv * t * t * x2 +\n      t * t * t * x3\n    y =\n      inv * inv * inv * y0 +\n      3 * inv * inv * t * y1 +\n      3 * inv * t * t * y2 +\n      t * t * t * y3\n    dx = x - px\n    dy = y - py\n    d = dx * dx + dy * dy\n\n    if (d < _bestDistance) {\n      _bestDistance = d\n      best = t\n    }\n\n    t += inc\n  }\n\n  return iterations > 1\n    ? getClosestProgressOnBezier(\n        iterations - 1,\n        px,\n        py,\n        Math.max(best - inc, 0),\n        Math.min(best + inc, 1),\n        slices,\n        x0,\n        y0,\n        x1,\n        y1,\n        x2,\n        y2,\n        x3,\n        y3\n      )\n    : best\n}\n\nexport function getClosestData(rawPath, x, y, slices) {\n  //returns an object with the closest j, i, and t (j is the segment index, i is the index of the point in that segment, and t is the time/progress along that bezier)\n  var closest = {\n      j: 0,\n      i: 0,\n      t: 0\n    },\n    bestDistance = _largeNum,\n    i,\n    j,\n    t,\n    segment\n\n  for (j = 0; j < rawPath.length; j++) {\n    segment = rawPath[j]\n\n    for (i = 0; i < segment.length; i += 6) {\n      t = getClosestProgressOnBezier(\n        1,\n        x,\n        y,\n        0,\n        1,\n        slices || 20,\n        segment[i],\n        segment[i + 1],\n        segment[i + 2],\n        segment[i + 3],\n        segment[i + 4],\n        segment[i + 5],\n        segment[i + 6],\n        segment[i + 7]\n      )\n\n      if (bestDistance > _bestDistance) {\n        bestDistance = _bestDistance\n        closest.j = j\n        closest.i = i\n        closest.t = t\n      }\n    }\n  }\n\n  return closest\n} //subdivide a Segment closest to a specific x,y coordinate\n\nexport function subdivideSegmentNear(x, y, segment, slices, iterations) {\n  var l = segment.length,\n    bestDistance = _largeNum,\n    bestT = 0,\n    bestSegmentIndex = 0,\n    t,\n    i\n  slices = slices || 20\n  iterations = iterations || 3\n\n  for (i = 0; i < l; i += 6) {\n    t = getClosestProgressOnBezier(\n      1,\n      x,\n      y,\n      0,\n      1,\n      slices,\n      segment[i],\n      segment[i + 1],\n      segment[i + 2],\n      segment[i + 3],\n      segment[i + 4],\n      segment[i + 5],\n      segment[i + 6],\n      segment[i + 7]\n    )\n\n    if (bestDistance > _bestDistance) {\n      bestDistance = _bestDistance\n      bestT = t\n      bestSegmentIndex = i\n    }\n  }\n\n  t = getClosestProgressOnBezier(\n    iterations,\n    x,\n    y,\n    bestT - 0.05,\n    bestT + 0.05,\n    slices,\n    segment[bestSegmentIndex],\n    segment[bestSegmentIndex + 1],\n    segment[bestSegmentIndex + 2],\n    segment[bestSegmentIndex + 3],\n    segment[bestSegmentIndex + 4],\n    segment[bestSegmentIndex + 5],\n    segment[bestSegmentIndex + 6],\n    segment[bestSegmentIndex + 7]\n  )\n  subdivideSegment(segment, bestSegmentIndex, t)\n  return bestSegmentIndex + 6\n}\n/*\nTakes any of the following and converts it to an all Cubic Bezier SVG data string:\n- A <path> data string like \"M0,0 L2,4 v20,15 H100\"\n- A RawPath, like [[x, y, x, y, x, y, x, y][[x, y, x, y, x, y, x, y]]\n- A Segment, like [x, y, x, y, x, y, x, y]\n\nNote: all numbers are rounded down to the closest 0.001 to minimize memory, maximize speed, and avoid odd numbers like 1e-13\n*/\n\nexport function rawPathToString(rawPath) {\n  if (_isNumber(rawPath[0])) {\n    //in case a segment is passed in instead\n    rawPath = [rawPath]\n  }\n\n  var result = '',\n    l = rawPath.length,\n    sl,\n    s,\n    i,\n    segment\n\n  for (s = 0; s < l; s++) {\n    segment = rawPath[s]\n    result += 'M' + _round(segment[0]) + ',' + _round(segment[1]) + ' C'\n    sl = segment.length\n\n    for (i = 2; i < sl; i++) {\n      result +=\n        _round(segment[i++]) +\n        ',' +\n        _round(segment[i++]) +\n        ' ' +\n        _round(segment[i++]) +\n        ',' +\n        _round(segment[i++]) +\n        ' ' +\n        _round(segment[i++]) +\n        ',' +\n        _round(segment[i]) +\n        ' '\n    }\n\n    if (segment.closed) {\n      result += 'z'\n    }\n  }\n\n  return result\n}\n/*\n// takes a segment with coordinates [x, y, x, y, ...] and converts the control points into angles and lengths [x, y, angle, length, angle, length, x, y, angle, length, ...] so that it animates more cleanly and avoids odd breaks/kinks. For example, if you animate from 1 o'clock to 6 o'clock, it'd just go directly/linearly rather than around. So the length would be very short in the middle of the tween.\nexport function cpCoordsToAngles(segment, copy) {\n\tvar result = copy ? segment.slice(0) : segment,\n\t\tx, y, i;\n\tfor (i = 0; i < segment.length; i+=6) {\n\t\tx = segment[i+2] - segment[i];\n\t\ty = segment[i+3] - segment[i+1];\n\t\tresult[i+2] = Math.atan2(y, x);\n\t\tresult[i+3] = Math.sqrt(x * x + y * y);\n\t\tx = segment[i+6] - segment[i+4];\n\t\ty = segment[i+7] - segment[i+5];\n\t\tresult[i+4] = Math.atan2(y, x);\n\t\tresult[i+5] = Math.sqrt(x * x + y * y);\n\t}\n\treturn result;\n}\n\n// takes a segment that was converted with cpCoordsToAngles() to have angles and lengths instead of coordinates for the control points, and converts it BACK into coordinates.\nexport function cpAnglesToCoords(segment, copy) {\n\tvar result = copy ? segment.slice(0) : segment,\n\t\tlength = segment.length,\n\t\trnd = 1000,\n\t\tangle, l, i, j;\n\tfor (i = 0; i < length; i+=6) {\n\t\tangle = segment[i+2];\n\t\tl = segment[i+3]; //length\n\t\tresult[i+2] = (((segment[i] + Math.cos(angle) * l) * rnd) | 0) / rnd;\n\t\tresult[i+3] = (((segment[i+1] + Math.sin(angle) * l) * rnd) | 0) / rnd;\n\t\tangle = segment[i+4];\n\t\tl = segment[i+5]; //length\n\t\tresult[i+4] = (((segment[i+6] - Math.cos(angle) * l) * rnd) | 0) / rnd;\n\t\tresult[i+5] = (((segment[i+7] - Math.sin(angle) * l) * rnd) | 0) / rnd;\n\t}\n\treturn result;\n}\n\n//adds an \"isSmooth\" array to each segment and populates it with a boolean value indicating whether or not it's smooth (the control points have basically the same slope). For any smooth control points, it converts the coordinates into angle (x, in radians) and length (y) and puts them into the same index value in a smoothData array.\nexport function populateSmoothData(rawPath) {\n\tlet j = rawPath.length,\n\t\tsmooth, segment, x, y, x2, y2, i, l, a, a2, isSmooth, smoothData;\n\twhile (--j > -1) {\n\t\tsegment = rawPath[j];\n\t\tisSmooth = segment.isSmooth = segment.isSmooth || [0, 0, 0, 0];\n\t\tsmoothData = segment.smoothData = segment.smoothData || [0, 0, 0, 0];\n\t\tisSmooth.length = 4;\n\t\tl = segment.length - 2;\n\t\tfor (i = 6; i < l; i += 6) {\n\t\t\tx = segment[i] - segment[i - 2];\n\t\t\ty = segment[i + 1] - segment[i - 1];\n\t\t\tx2 = segment[i + 2] - segment[i];\n\t\t\ty2 = segment[i + 3] - segment[i + 1];\n\t\t\ta = _atan2(y, x);\n\t\t\ta2 = _atan2(y2, x2);\n\t\t\tsmooth = (Math.abs(a - a2) < 0.09);\n\t\t\tif (smooth) {\n\t\t\t\tsmoothData[i - 2] = a;\n\t\t\t\tsmoothData[i + 2] = a2;\n\t\t\t\tsmoothData[i - 1] = _sqrt(x * x + y * y);\n\t\t\t\tsmoothData[i + 3] = _sqrt(x2 * x2 + y2 * y2);\n\t\t\t}\n\t\t\tisSmooth.push(smooth, smooth, 0, 0, smooth, smooth);\n\t\t}\n\t\t//if the first and last points are identical, check to see if there's a smooth transition. We must handle this a bit differently due to their positions in the array.\n\t\tif (segment[l] === segment[0] && segment[l+1] === segment[1]) {\n\t\t\tx = segment[0] - segment[l-2];\n\t\t\ty = segment[1] - segment[l-1];\n\t\t\tx2 = segment[2] - segment[0];\n\t\t\ty2 = segment[3] - segment[1];\n\t\t\ta = _atan2(y, x);\n\t\t\ta2 = _atan2(y2, x2);\n\t\t\tif (Math.abs(a - a2) < 0.09) {\n\t\t\t\tsmoothData[l-2] = a;\n\t\t\t\tsmoothData[2] = a2;\n\t\t\t\tsmoothData[l-1] = _sqrt(x * x + y * y);\n\t\t\t\tsmoothData[3] = _sqrt(x2 * x2 + y2 * y2);\n\t\t\t\tisSmooth[l-2] = isSmooth[l-1] = true; //don't change indexes 2 and 3 because we'll trigger everything from the END, and this will optimize file size a bit.\n\t\t\t}\n\t\t}\n\t}\n\treturn rawPath;\n}\nexport function pointToScreen(svgElement, point) {\n\tif (arguments.length < 2) { //by default, take the first set of coordinates in the path as the point\n\t\tlet rawPath = getRawPath(svgElement);\n\t\tpoint = svgElement.ownerSVGElement.createSVGPoint();\n\t\tpoint.x = rawPath[0][0];\n\t\tpoint.y = rawPath[0][1];\n\t}\n\treturn point.matrixTransform(svgElement.getScreenCTM());\n}\n\n*/\n\n","/* eslint-disable */\n\n/*!\n * MorphSVGPlugin 3.0.5\n * https://greensock.com\n *\n * @license Copyright 2008-2020, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n */\n\n/* eslint-disable */\nimport {\n  getRawPath,\n  reverseSegment,\n  stringToRawPath,\n  rawPathToString,\n  convertToPath as _convertToPath\n} from './utils/paths.js'\n\nvar gsap,\n  _toArray,\n  _lastLinkedAnchor,\n  _doc,\n  _coreInitted,\n  PluginClass,\n  _getGSAP = function _getGSAP() {\n    return (\n      gsap ||\n      (typeof window !== 'undefined' &&\n        (gsap = window.gsap) &&\n        gsap.registerPlugin &&\n        gsap)\n    )\n  },\n  _atan2 = Math.atan2,\n  _cos = Math.cos,\n  _sin = Math.sin,\n  _sqrt = Math.sqrt,\n  _PI = Math.PI,\n  _2PI = _PI * 2,\n  _angleMin = _PI * 0.3,\n  _angleMax = _PI * 0.7,\n  _bigNum = 1e20,\n  _numExp = /[-+=\\.]*\\d+[\\.e\\-\\+]*\\d*[e\\-\\+]*\\d*/gi,\n  //finds any numbers, including ones that start with += or -=, negative numbers, and ones in scientific notation like 1e-8.\n  _selectorExp = /(^[#\\.][a-z]|[a-y][a-z])/gi,\n  _commands = /[achlmqstvz]/gi,\n  _log = function _log(message) {\n    return console && console.warn(message)\n  },\n  _bonusValidated = 1,\n  //<name>MorphSVGPlugin</name>\n  _getAverageXY = function _getAverageXY(segment) {\n    var l = segment.length,\n      x = 0,\n      y = 0,\n      i\n\n    for (i = 0; i < l; i++) {\n      x += segment[i++]\n      y += segment[i]\n    }\n\n    return [x / (l / 2), y / (l / 2)]\n  },\n  _getSize = function _getSize(segment) {\n    //rough estimate of the bounding box (based solely on the anchors) of a single segment. sets \"size\", \"centerX\", and \"centerY\" properties on the bezier array itself, and returns the size (width * height)\n    var l = segment.length,\n      xMax = segment[0],\n      xMin = xMax,\n      yMax = segment[1],\n      yMin = yMax,\n      x,\n      y,\n      i\n\n    for (i = 6; i < l; i += 6) {\n      x = segment[i]\n      y = segment[i + 1]\n\n      if (x > xMax) {\n        xMax = x\n      } else if (x < xMin) {\n        xMin = x\n      }\n\n      if (y > yMax) {\n        yMax = y\n      } else if (y < yMin) {\n        yMin = y\n      }\n    }\n\n    segment.centerX = (xMax + xMin) / 2\n    segment.centerY = (yMax + yMin) / 2\n    return (segment.size = (xMax - xMin) * (yMax - yMin))\n  },\n  _getTotalSize = function _getTotalSize(rawPath, samplesPerBezier) {\n    if (samplesPerBezier === void 0) {\n      samplesPerBezier = 3\n    }\n\n    //rough estimate of the bounding box of the entire list of Bezier segments (based solely on the anchors). sets \"size\", \"centerX\", and \"centerY\" properties on the bezier array itself, and returns the size (width * height)\n    var j = rawPath.length,\n      xMax = rawPath[0][0],\n      xMin = xMax,\n      yMax = rawPath[0][1],\n      yMin = yMax,\n      inc = 1 / samplesPerBezier,\n      l,\n      x,\n      y,\n      i,\n      segment,\n      k,\n      t,\n      inv,\n      x1,\n      y1,\n      x2,\n      x3,\n      x4,\n      y2,\n      y3,\n      y4\n\n    while (--j > -1) {\n      segment = rawPath[j]\n      l = segment.length\n\n      for (i = 6; i < l; i += 6) {\n        x1 = segment[i]\n        y1 = segment[i + 1]\n        x2 = segment[i + 2] - x1\n        y2 = segment[i + 3] - y1\n        x3 = segment[i + 4] - x1\n        y3 = segment[i + 5] - y1\n        x4 = segment[i + 6] - x1\n        y4 = segment[i + 7] - y1\n        k = samplesPerBezier\n\n        while (--k > -1) {\n          t = inc * k\n          inv = 1 - t\n          x = (t * t * x4 + 3 * inv * (t * x3 + inv * x2)) * t + x1\n          y = (t * t * y4 + 3 * inv * (t * y3 + inv * y2)) * t + y1\n\n          if (x > xMax) {\n            xMax = x\n          } else if (x < xMin) {\n            xMin = x\n          }\n\n          if (y > yMax) {\n            yMax = y\n          } else if (y < yMin) {\n            yMin = y\n          }\n        }\n      }\n    }\n\n    rawPath.centerX = (xMax + xMin) / 2\n    rawPath.centerY = (yMax + yMin) / 2\n    rawPath.left = xMin\n    rawPath.width = xMax - xMin\n    rawPath.top = yMin\n    rawPath.height = yMax - yMin\n    return (rawPath.size = (xMax - xMin) * (yMax - yMin))\n  },\n  _sortByComplexity = function _sortByComplexity(a, b) {\n    return b.length - a.length\n  },\n  _sortBySize = function _sortBySize(a, b) {\n    var sizeA = a.size || _getSize(a),\n      sizeB = b.size || _getSize(b)\n\n    return Math.abs(sizeB - sizeA) < (sizeA + sizeB) / 20\n      ? b.centerX - a.centerX || b.centerY - a.centerY\n      : sizeB - sizeA //if the size is within 10% of each other, prioritize position from left to right, then top to bottom.\n  },\n  _offsetSegment = function _offsetSegment(segment, shapeIndex) {\n    var a = segment.slice(0),\n      l = segment.length,\n      wrap = l - 2,\n      i,\n      index\n    shapeIndex = shapeIndex | 0\n\n    for (i = 0; i < l; i++) {\n      index = (i + shapeIndex) % wrap\n      segment[i++] = a[index]\n      segment[i] = a[index + 1]\n    }\n  },\n  _getTotalMovement = function _getTotalMovement(\n    sb,\n    eb,\n    shapeIndex,\n    offsetX,\n    offsetY\n  ) {\n    var l = sb.length,\n      d = 0,\n      wrap = l - 2,\n      index,\n      i,\n      x,\n      y\n    shapeIndex *= 6\n\n    for (i = 0; i < l; i += 6) {\n      index = (i + shapeIndex) % wrap\n      y = sb[index] - (eb[i] - offsetX)\n      x = sb[index + 1] - (eb[i + 1] - offsetY)\n      d += _sqrt(x * x + y * y)\n    }\n\n    return d\n  },\n  _getClosestShapeIndex = function _getClosestShapeIndex(sb, eb, checkReverse) {\n    //finds the index in a closed cubic bezier array that's closest to the angle provided (angle measured from the center or average x/y).\n    var l = sb.length,\n      sCenter = _getAverageXY(sb),\n      //when comparing distances, adjust the coordinates as if the shapes are centered with each other.\n      eCenter = _getAverageXY(eb),\n      offsetX = eCenter[0] - sCenter[0],\n      offsetY = eCenter[1] - sCenter[1],\n      min = _getTotalMovement(sb, eb, 0, offsetX, offsetY),\n      minIndex = 0,\n      copy,\n      d,\n      i\n\n    for (i = 6; i < l; i += 6) {\n      d = _getTotalMovement(sb, eb, i / 6, offsetX, offsetY)\n\n      if (d < min) {\n        min = d\n        minIndex = i\n      }\n    }\n\n    if (checkReverse) {\n      copy = sb.slice(0)\n      reverseSegment(copy)\n\n      for (i = 6; i < l; i += 6) {\n        d = _getTotalMovement(copy, eb, i / 6, offsetX, offsetY)\n\n        if (d < min) {\n          min = d\n          minIndex = -i\n        }\n      }\n    }\n\n    return minIndex / 6\n  },\n  _getClosestAnchor = function _getClosestAnchor(rawPath, x, y) {\n    //finds the x/y of the anchor that's closest to the provided x/y coordinate (returns an array, like [x, y]). The bezier should be the top-level type that contains an array for each segment.\n    var j = rawPath.length,\n      closestDistance = _bigNum,\n      closestX = 0,\n      closestY = 0,\n      segment,\n      dx,\n      dy,\n      d,\n      i,\n      l\n\n    while (--j > -1) {\n      segment = rawPath[j]\n      l = segment.length\n\n      for (i = 0; i < l; i += 6) {\n        dx = segment[i] - x\n        dy = segment[i + 1] - y\n        d = _sqrt(dx * dx + dy * dy)\n\n        if (d < closestDistance) {\n          closestDistance = d\n          closestX = segment[i]\n          closestY = segment[i + 1]\n        }\n      }\n    }\n\n    return [closestX, closestY]\n  },\n  _getClosestSegment = function _getClosestSegment(\n    bezier,\n    pool,\n    startIndex,\n    sortRatio,\n    offsetX,\n    offsetY\n  ) {\n    //matches the bezier to the closest one in a pool (array) of beziers, assuming they are in order of size and we shouldn't drop more than 20% of the size, otherwise prioritizing location (total distance to the center). Extracts the segment out of the pool array and returns it.\n    var l = pool.length,\n      index = 0,\n      minSize =\n        Math.min(\n          bezier.size || _getSize(bezier),\n          pool[startIndex].size || _getSize(pool[startIndex])\n        ) * sortRatio,\n      //limit things based on a percentage of the size of either the bezier or the next element in the array, whichever is smaller.\n      min = _bigNum,\n      cx = bezier.centerX + offsetX,\n      cy = bezier.centerY + offsetY,\n      size,\n      i,\n      dx,\n      dy,\n      d\n\n    for (i = startIndex; i < l; i++) {\n      size = pool[i].size || _getSize(pool[i])\n\n      if (size < minSize) {\n        break\n      }\n\n      dx = pool[i].centerX - cx\n      dy = pool[i].centerY - cy\n      d = _sqrt(dx * dx + dy * dy)\n\n      if (d < min) {\n        index = i\n        min = d\n      }\n    }\n\n    d = pool[index]\n    pool.splice(index, 1)\n    return d\n  },\n  _subdivideSegmentQty = function _subdivideSegmentQty(segment, quantity) {\n    var tally = 0,\n      max = 0.999999,\n      l = segment.length,\n      newPointsPerSegment = quantity / ((l - 2) / 6),\n      ax,\n      ay,\n      cp1x,\n      cp1y,\n      cp2x,\n      cp2y,\n      bx,\n      by,\n      x1,\n      y1,\n      x2,\n      y2,\n      i,\n      t\n\n    for (i = 2; i < l; i += 6) {\n      tally += newPointsPerSegment\n\n      while (tally > max) {\n        //compare with 0.99999 instead of 1 in order to prevent rounding errors\n        ax = segment[i - 2]\n        ay = segment[i - 1]\n        cp1x = segment[i]\n        cp1y = segment[i + 1]\n        cp2x = segment[i + 2]\n        cp2y = segment[i + 3]\n        bx = segment[i + 4]\n        by = segment[i + 5]\n        t = 1 / ((Math.floor(tally) || 1) + 1) //progress along the bezier (value between 0 and 1)\n\n        x1 = ax + (cp1x - ax) * t\n        x2 = cp1x + (cp2x - cp1x) * t\n        x1 += (x2 - x1) * t\n        x2 += (cp2x + (bx - cp2x) * t - x2) * t\n        y1 = ay + (cp1y - ay) * t\n        y2 = cp1y + (cp2y - cp1y) * t\n        y1 += (y2 - y1) * t\n        y2 += (cp2y + (by - cp2y) * t - y2) * t\n        segment.splice(\n          i,\n          4,\n          ax + (cp1x - ax) * t, //first control point\n          ay + (cp1y - ay) * t,\n          x1, //second control point\n          y1,\n          x1 + (x2 - x1) * t, //new fabricated anchor on line\n          y1 + (y2 - y1) * t,\n          x2, //third control point\n          y2,\n          cp2x + (bx - cp2x) * t, //fourth control point\n          cp2y + (by - cp2y) * t\n        )\n        i += 6\n        l += 6\n        tally--\n      }\n    }\n\n    return segment\n  },\n  _equalizeSegmentQuantity = function _equalizeSegmentQuantity(\n    start,\n    end,\n    shapeIndex,\n    map,\n    fillSafe\n  ) {\n    //returns an array of shape indexes, 1 for each segment.\n    var dif = end.length - start.length,\n      longer = dif > 0 ? end : start,\n      shorter = dif > 0 ? start : end,\n      added = 0,\n      sortMethod = map === 'complexity' ? _sortByComplexity : _sortBySize,\n      sortRatio = map === 'position' ? 0 : typeof map === 'number' ? map : 0.8,\n      i = shorter.length,\n      shapeIndices =\n        typeof shapeIndex === 'object' && shapeIndex.push\n          ? shapeIndex.slice(0)\n          : [shapeIndex],\n      reverse = shapeIndices[0] === 'reverse' || shapeIndices[0] < 0,\n      log = shapeIndex === 'log',\n      eb,\n      sb,\n      b,\n      x,\n      y,\n      offsetX,\n      offsetY\n\n    if (!shorter[0]) {\n      return\n    }\n\n    if (longer.length > 1) {\n      start.sort(sortMethod)\n      end.sort(sortMethod)\n      offsetX = longer.size || _getTotalSize(longer) //ensures centerX and centerY are defined (used below).\n\n      offsetX = shorter.size || _getTotalSize(shorter)\n      offsetX = longer.centerX - shorter.centerX\n      offsetY = longer.centerY - shorter.centerY\n\n      if (sortMethod === _sortBySize) {\n        for (i = 0; i < shorter.length; i++) {\n          longer.splice(\n            i,\n            0,\n            _getClosestSegment(\n              shorter[i],\n              longer,\n              i,\n              sortRatio,\n              offsetX,\n              offsetY\n            )\n          )\n        }\n      }\n    }\n\n    if (dif) {\n      if (dif < 0) {\n        dif = -dif\n      }\n\n      if (longer[0].length > shorter[0].length) {\n        //since we use shorter[0] as the one to map the origination point of any brand new fabricated segments, do any subdividing first so that there are more points to choose from (if necessary)\n        _subdivideSegmentQty(\n          shorter[0],\n          ((longer[0].length - shorter[0].length) / 6) | 0\n        )\n      }\n\n      i = shorter.length\n\n      while (added < dif) {\n        x = longer[i].size || _getSize(longer[i]) //just to ensure centerX and centerY are calculated which we use on the next line.\n\n        b = _getClosestAnchor(shorter, longer[i].centerX, longer[i].centerY)\n        x = b[0]\n        y = b[1]\n        shorter[i++] = [x, y, x, y, x, y, x, y]\n        shorter.totalPoints += 8\n        added++\n      }\n    }\n\n    for (i = 0; i < start.length; i++) {\n      eb = end[i]\n      sb = start[i]\n      dif = eb.length - sb.length\n\n      if (dif < 0) {\n        _subdivideSegmentQty(eb, (-dif / 6) | 0)\n      } else if (dif > 0) {\n        _subdivideSegmentQty(sb, (dif / 6) | 0)\n      }\n\n      if (reverse && fillSafe !== false && !sb.reversed) {\n        reverseSegment(sb)\n      }\n\n      shapeIndex =\n        shapeIndices[i] || shapeIndices[i] === 0 ? shapeIndices[i] : 'auto'\n\n      if (shapeIndex) {\n        //if start shape is closed, find the closest point to the start/end, and re-organize the bezier points accordingly so that the shape morphs in a more intuitive way.\n        if (\n          sb.closed ||\n          (Math.abs(sb[0] - sb[sb.length - 2]) < 0.5 &&\n            Math.abs(sb[1] - sb[sb.length - 1]) < 0.5)\n        ) {\n          if (shapeIndex === 'auto' || shapeIndex === 'log') {\n            shapeIndices[i] = shapeIndex = _getClosestShapeIndex(\n              sb,\n              eb,\n              !i || fillSafe === false\n            )\n\n            if (shapeIndex < 0) {\n              reverse = true\n              reverseSegment(sb)\n              shapeIndex = -shapeIndex\n            }\n\n            _offsetSegment(sb, shapeIndex * 6)\n          } else if (shapeIndex !== 'reverse') {\n            if (i && shapeIndex < 0) {\n              //only happens if an array is passed as shapeIndex and a negative value is defined for an index beyond 0. Very rare, but helpful sometimes.\n              reverseSegment(sb)\n            }\n\n            _offsetSegment(sb, (shapeIndex < 0 ? -shapeIndex : shapeIndex) * 6)\n          } //otherwise, if it's not a closed shape, consider reversing it if that would make the overall travel less\n        } else if (\n          !reverse &&\n          ((shapeIndex === 'auto' &&\n            Math.abs(eb[0] - sb[0]) +\n              Math.abs(eb[1] - sb[1]) +\n              Math.abs(eb[eb.length - 2] - sb[sb.length - 2]) +\n              Math.abs(eb[eb.length - 1] - sb[sb.length - 1]) >\n              Math.abs(eb[0] - sb[sb.length - 2]) +\n                Math.abs(eb[1] - sb[sb.length - 1]) +\n                Math.abs(eb[eb.length - 2] - sb[0]) +\n                Math.abs(eb[eb.length - 1] - sb[1])) ||\n            shapeIndex % 2)\n        ) {\n          reverseSegment(sb)\n          shapeIndices[i] = -1\n          reverse = true\n        } else if (shapeIndex === 'auto') {\n          shapeIndices[i] = 0\n        } else if (shapeIndex === 'reverse') {\n          shapeIndices[i] = -1\n        }\n\n        if (sb.closed !== eb.closed) {\n          //if one is closed and one isn't, don't close either one otherwise the tweening will look weird (but remember, the beginning and final states will honor the actual values, so this only affects the inbetween state)\n          sb.closed = eb.closed = false\n        }\n      }\n    }\n\n    if (log) {\n      _log('shapeIndex:[' + shapeIndices.join(',') + ']')\n    }\n\n    start.shapeIndex = shapeIndices\n    return shapeIndices\n  },\n  _pathFilter = function _pathFilter(a, shapeIndex, map, precompile, fillSafe) {\n    var start = stringToRawPath(a[0]),\n      end = stringToRawPath(a[1])\n\n    if (\n      !_equalizeSegmentQuantity(\n        start,\n        end,\n        shapeIndex || shapeIndex === 0 ? shapeIndex : 'auto',\n        map,\n        fillSafe\n      )\n    ) {\n      return //malformed path data or null target\n    }\n\n    a[0] = rawPathToString(start)\n    a[1] = rawPathToString(end)\n\n    if (precompile === 'log' || precompile === true) {\n      _log('precompile:[\"' + a[0] + '\",\"' + a[1] + '\"]')\n    }\n  },\n  _offsetPoints = function _offsetPoints(text, offset) {\n    if (!offset) {\n      return text\n    }\n\n    var a = text.match(_numExp) || [],\n      l = a.length,\n      s = '',\n      inc,\n      i,\n      j\n\n    if (offset === 'reverse') {\n      i = l - 1\n      inc = -2\n    } else {\n      i = ((parseInt(offset, 10) || 0) * 2 + 1 + l * 100) % l\n      inc = 2\n    }\n\n    for (j = 0; j < l; j += 2) {\n      s += a[i - 1] + ',' + a[i] + ' '\n      i = (i + inc) % l\n    }\n\n    return s\n  },\n  //adds a certain number of points while maintaining the polygon/polyline shape (so that the start/end values can have a matching quantity of points to animate). Returns the revised string.\n  _equalizePointQuantity = function _equalizePointQuantity(a, quantity) {\n    var tally = 0,\n      x = parseFloat(a[0]),\n      y = parseFloat(a[1]),\n      s = x + ',' + y + ' ',\n      max = 0.999999,\n      newPointsPerSegment,\n      i,\n      l,\n      j,\n      factor,\n      nextX,\n      nextY\n    l = a.length\n    newPointsPerSegment = (quantity * 0.5) / (l * 0.5 - 1)\n\n    for (i = 0; i < l - 2; i += 2) {\n      tally += newPointsPerSegment\n      nextX = parseFloat(a[i + 2])\n      nextY = parseFloat(a[i + 3])\n\n      if (tally > max) {\n        //compare with 0.99999 instead of 1 in order to prevent rounding errors\n        factor = 1 / (Math.floor(tally) + 1)\n        j = 1\n\n        while (tally > max) {\n          s +=\n            (x + (nextX - x) * factor * j).toFixed(2) +\n            ',' +\n            (y + (nextY - y) * factor * j).toFixed(2) +\n            ' '\n          tally--\n          j++\n        }\n      }\n\n      s += nextX + ',' + nextY + ' '\n      x = nextX\n      y = nextY\n    }\n\n    return s\n  },\n  _pointsFilter = function _pointsFilter(a) {\n    var startNums = a[0].match(_numExp) || [],\n      endNums = a[1].match(_numExp) || [],\n      dif = endNums.length - startNums.length\n\n    if (dif > 0) {\n      a[0] = _equalizePointQuantity(startNums, dif)\n    } else {\n      a[1] = _equalizePointQuantity(endNums, -dif)\n    }\n  },\n  _buildPointsFilter = function _buildPointsFilter(shapeIndex) {\n    return !isNaN(shapeIndex)\n      ? function (a) {\n          _pointsFilter(a)\n\n          a[1] = _offsetPoints(a[1], parseInt(shapeIndex, 10))\n        }\n      : _pointsFilter\n  },\n  _parseShape = function _parseShape(shape, forcePath, target) {\n    var isString = typeof shape === 'string',\n      e,\n      type\n\n    if (\n      !isString ||\n      _selectorExp.test(shape) ||\n      (shape.match(_numExp) || []).length < 3\n    ) {\n      e = _toArray(shape)[0]\n\n      if (e) {\n        type = (e.nodeName + '').toUpperCase()\n\n        if (forcePath && type !== 'PATH') {\n          //if we were passed an element (or selector text for an element) that isn't a path, convert it.\n          e = _convertToPath(e, false)\n          type = 'PATH'\n        }\n\n        shape = e.getAttribute(type === 'PATH' ? 'd' : 'points') || ''\n\n        if (e === target) {\n          //if the shape matches the target element, the user wants to revert to the original which should have been stored in the data-original attribute\n          shape = e.getAttributeNS(null, 'data-original') || shape\n        }\n      } else {\n        _log('WARNING: invalid morph to: ' + shape)\n\n        shape = false\n      }\n    }\n\n    return shape\n  },\n  //adds an \"isSmooth\" array to each segment and populates it with a boolean value indicating whether or not it's smooth (the control points have basically the same slope). For any smooth control points, it converts the coordinates into angle (x, in radians) and length (y) and puts them into the same index value in a smoothData array.\n  _populateSmoothData = function _populateSmoothData(rawPath, tolerance) {\n    var j = rawPath.length,\n      limit = 0.2 * (tolerance || 1),\n      smooth,\n      segment,\n      x,\n      y,\n      x2,\n      y2,\n      i,\n      l,\n      a,\n      a2,\n      isSmooth,\n      smoothData\n\n    while (--j > -1) {\n      segment = rawPath[j]\n      isSmooth = segment.isSmooth = segment.isSmooth || [0, 0, 0, 0]\n      smoothData = segment.smoothData = segment.smoothData || [0, 0, 0, 0]\n      isSmooth.length = 4\n      l = segment.length - 2\n\n      for (i = 6; i < l; i += 6) {\n        x = segment[i] - segment[i - 2]\n        y = segment[i + 1] - segment[i - 1]\n        x2 = segment[i + 2] - segment[i]\n        y2 = segment[i + 3] - segment[i + 1]\n        a = _atan2(y, x)\n        a2 = _atan2(y2, x2)\n        smooth = Math.abs(a - a2) < limit\n\n        if (smooth) {\n          smoothData[i - 2] = a\n          smoothData[i + 2] = a2\n          smoothData[i - 1] = _sqrt(x * x + y * y)\n          smoothData[i + 3] = _sqrt(x2 * x2 + y2 * y2)\n        }\n\n        isSmooth.push(smooth, smooth, 0, 0, smooth, smooth)\n      } //if the first and last points are identical, check to see if there's a smooth transition. We must handle this a bit differently due to their positions in the array.\n\n      if (segment[l] === segment[0] && segment[l + 1] === segment[1]) {\n        x = segment[0] - segment[l - 2]\n        y = segment[1] - segment[l - 1]\n        x2 = segment[2] - segment[0]\n        y2 = segment[3] - segment[1]\n        a = _atan2(y, x)\n        a2 = _atan2(y2, x2)\n\n        if (Math.abs(a - a2) < limit) {\n          smoothData[l - 2] = a\n          smoothData[2] = a2\n          smoothData[l - 1] = _sqrt(x * x + y * y)\n          smoothData[3] = _sqrt(x2 * x2 + y2 * y2)\n          isSmooth[l - 2] = isSmooth[l - 1] = true //don't change indexes 2 and 3 because we'll trigger everything from the END, and this will optimize file size a bit.\n        }\n      }\n    }\n\n    return rawPath\n  },\n  _parseOriginFactors = function _parseOriginFactors(v) {\n    var a = v.trim().split(' '),\n      x = ~v.indexOf('left')\n        ? 0\n        : ~v.indexOf('right')\n        ? 100\n        : isNaN(parseFloat(a[0]))\n        ? 50\n        : parseFloat(a[0]),\n      y = ~v.indexOf('top')\n        ? 0\n        : ~v.indexOf('bottom')\n        ? 100\n        : isNaN(parseFloat(a[1]))\n        ? 50\n        : parseFloat(a[1])\n    return {\n      x: x / 100,\n      y: y / 100\n    }\n  },\n  _shortAngle = function _shortAngle(dif) {\n    return dif !== dif % _PI ? dif + (dif < 0 ? _2PI : -_2PI) : dif\n  },\n  _morphMessage =\n    'Use MorphSVGPlugin.convertToPath() to convert to a path before morphing.',\n  _tweenRotation = function _tweenRotation(start, end, i, linkedPT) {\n    var so = this._origin,\n      //starting origin\n      eo = this._eOrigin,\n      //ending origin\n      dx = start[i] - so.x,\n      dy = start[i + 1] - so.y,\n      d = _sqrt(dx * dx + dy * dy),\n      //length from starting origin to starting point\n      sa = _atan2(dy, dx),\n      angleDif,\n      _short\n\n    dx = end[i] - eo.x\n    dy = end[i + 1] - eo.y\n    angleDif = _atan2(dy, dx) - sa\n    _short = _shortAngle(angleDif) //in the case of control points, we ALWAYS link them to their anchor so that they don't get torn apart and rotate the opposite direction. If it's not a control point, we look at the most recently linked point as long as they're within a certain rotational range of each other.\n\n    if (\n      !linkedPT &&\n      _lastLinkedAnchor &&\n      Math.abs(_short + _lastLinkedAnchor.ca) < _angleMin\n    ) {\n      linkedPT = _lastLinkedAnchor\n    }\n\n    return (this._anchorPT = _lastLinkedAnchor = {\n      _next: this._anchorPT,\n      t: start,\n      sa: sa,\n      //starting angle\n      ca:\n        linkedPT && _short * linkedPT.ca < 0 && Math.abs(_short) > _angleMax\n          ? angleDif\n          : _short,\n      //change in angle\n      sl: d,\n      //starting length\n      cl: _sqrt(dx * dx + dy * dy) - d,\n      //change in length\n      i: i\n    })\n  },\n  _initCore = function _initCore(required) {\n    gsap = _getGSAP()\n    PluginClass = PluginClass || (gsap && gsap.plugins.morphSVG)\n\n    if (gsap && PluginClass) {\n      _toArray = gsap.utils.toArray\n      _doc = document\n      PluginClass.prototype._tweenRotation = _tweenRotation\n      _coreInitted = 1\n    } else if (required) {\n      _log('Please gsap.registerPlugin(MorphSVGPlugin)')\n    }\n  }\n\nexport var MorphSVGPlugin = {\n  version: '3.0.5',\n  name: 'morphSVG',\n  register: function register(core, Plugin) {\n    gsap = core\n    PluginClass = Plugin\n\n    _initCore()\n  },\n  init: function init(target, value, tween, index, targets) {\n    var cs = target.nodeType ? window.getComputedStyle(target) : {},\n      fill = cs.fill + '',\n      fillSafe = !(\n        fill === 'none' ||\n        (fill.match(_numExp) || [])[3] === '0' ||\n        cs.fillRule === 'evenodd'\n      ),\n      origins = (value.origin || '50 50').split(','),\n      type,\n      p,\n      pt,\n      shape,\n      isPoly,\n      shapeIndex,\n      map,\n      startSmooth,\n      endSmooth,\n      start,\n      end,\n      i,\n      j,\n      l,\n      startSeg,\n      endSeg,\n      precompiled,\n      sData,\n      eData,\n      originFactors,\n      useRotation,\n      offset\n\n    if (!_coreInitted) {\n      _initCore(1)\n    }\n\n    type = (target.nodeName + '').toUpperCase()\n    isPoly = type === 'POLYLINE' || type === 'POLYGON'\n\n    if (type !== 'PATH' && !isPoly && !value.prop) {\n      _log('Cannot morph a <' + type + '> element. ' + _morphMessage)\n\n      return false\n    }\n\n    p = type === 'PATH' ? 'd' : 'points'\n\n    if (typeof value === 'string' || value.getBBox || value[0]) {\n      value = {\n        shape: value\n      }\n    }\n\n    if (!value.prop && typeof target.setAttribute !== 'function') {\n      return false\n    }\n\n    shape = _parseShape(\n      value.shape || value.d || value.points || '',\n      p === 'd',\n      target\n    )\n\n    if (isPoly && _commands.test(shape)) {\n      _log('A <' + type + '> cannot accept path data. ' + _morphMessage)\n\n      return false\n    }\n\n    shapeIndex =\n      value.shapeIndex || value.shapeIndex === 0 ? value.shapeIndex : 'auto'\n    map = value.map || MorphSVGPlugin.defaultMap\n    this._prop = value.prop\n    this._render = value.render || MorphSVGPlugin.defaultRender\n    this._apply =\n      'updateTarget' in value\n        ? value.updateTarget\n        : MorphSVGPlugin.defaultUpdateTarget\n    this._rnd = Math.pow(10, isNaN(value.precision) ? 2 : +value.precision)\n    this._tween = tween\n\n    if (shape) {\n      this._target = target\n      precompiled = typeof value.precompile === 'object'\n      start = this._prop ? target[this._prop] : target.getAttribute(p)\n\n      if (!this._prop && !target.getAttributeNS(null, 'data-original')) {\n        target.setAttributeNS(null, 'data-original', start) //record the original state in a data-original attribute so that we can revert to it later.\n      }\n\n      if (p === 'd' || this._prop) {\n        start = stringToRawPath(precompiled ? value.precompile[0] : start)\n        end = stringToRawPath(precompiled ? value.precompile[1] : shape)\n\n        if (\n          !precompiled &&\n          !_equalizeSegmentQuantity(start, end, shapeIndex, map, fillSafe)\n        ) {\n          return false //malformed path data or null target\n        }\n\n        if (value.precompile === 'log' || value.precompile === true) {\n          _log(\n            'precompile:[\"' +\n              rawPathToString(start) +\n              '\",\"' +\n              rawPathToString(end) +\n              '\"]'\n          )\n        }\n\n        useRotation = (value.type || MorphSVGPlugin.defaultType) !== 'linear'\n\n        if (useRotation) {\n          start = _populateSmoothData(start, value.smoothTolerance)\n          end = _populateSmoothData(end, value.smoothTolerance)\n\n          if (!start.size) {\n            _getTotalSize(start) //adds top/left/width/height values\n          }\n\n          if (!end.size) {\n            _getTotalSize(end)\n          }\n\n          originFactors = _parseOriginFactors(origins[0])\n          this._origin = start.origin = {\n            x: start.left + originFactors.x * start.width,\n            y: start.top + originFactors.y * start.height\n          }\n\n          if (origins[1]) {\n            originFactors = _parseOriginFactors(origins[1])\n          }\n\n          this._eOrigin = {\n            x: end.left + originFactors.x * end.width,\n            y: end.top + originFactors.y * end.height\n          }\n        }\n\n        this._rawPath = target._gsRawPath = start\n        j = start.length\n\n        while (--j > -1) {\n          startSeg = start[j]\n          endSeg = end[j]\n          startSmooth = startSeg.isSmooth || []\n          endSmooth = endSeg.isSmooth || []\n          l = startSeg.length\n          _lastLinkedAnchor = 0 //reset; we use _lastLinkedAnchor in the _tweenRotation() method to help make sure that close points don't get ripped apart and rotate opposite directions. Typically we want to go the shortest direction, but if the previous anchor is going a different direction, we override this logic (within certain thresholds)\n\n          for (i = 0; i < l; i += 2) {\n            if (\n              endSeg[i] !== startSeg[i] ||\n              endSeg[i + 1] !== startSeg[i + 1]\n            ) {\n              if (useRotation) {\n                if (startSmooth[i] && endSmooth[i]) {\n                  //if BOTH starting and ending values are smooth (meaning control points have basically the same slope), interpolate the rotation and length instead of the coordinates (this is what makes things smooth).\n                  sData = startSeg.smoothData\n                  eData = endSeg.smoothData\n                  offset = i + (i === l - 4 ? 7 - l : 5) //helps us accommodate wrapping (like if the end and start anchors are identical and the control points are smooth).\n\n                  this._controlPT = {\n                    _next: this._controlPT,\n                    i: i,\n                    j: j,\n                    l1s: sData[i + 1],\n                    l1c: eData[i + 1] - sData[i + 1],\n                    l2s: sData[offset],\n                    l2c: eData[offset] - sData[offset]\n                  }\n                  pt = this._tweenRotation(startSeg, endSeg, i + 2)\n\n                  this._tweenRotation(startSeg, endSeg, i, pt)\n\n                  this._tweenRotation(startSeg, endSeg, offset - 1, pt)\n\n                  i += 4\n                } else {\n                  this._tweenRotation(startSeg, endSeg, i)\n                }\n              } else {\n                pt = this.add(startSeg, i, startSeg[i], endSeg[i])\n                pt =\n                  this.add(startSeg, i + 1, startSeg[i + 1], endSeg[i + 1]) ||\n                  pt\n              }\n            }\n          }\n        }\n      } else {\n        pt = this.add(\n          target,\n          'setAttribute',\n          target.getAttribute(p) + '',\n          shape + '',\n          index,\n          targets,\n          0,\n          _buildPointsFilter(shapeIndex),\n          p\n        )\n      }\n\n      if (useRotation) {\n        this.add(this._origin, 'x', this._origin.x, this._eOrigin.x)\n        pt = this.add(this._origin, 'y', this._origin.y, this._eOrigin.y)\n      }\n\n      if (pt) {\n        this._props.push('morphSVG')\n\n        pt.end = shape\n        pt.endProp = p\n      }\n    }\n\n    return _bonusValidated\n  },\n  render: function render(ratio, data) {\n    var rawPath = data._rawPath,\n      controlPT = data._controlPT,\n      anchorPT = data._anchorPT,\n      rnd = data._rnd,\n      target = data._target,\n      pt = data._pt,\n      s,\n      space,\n      easeInOut,\n      segment,\n      l,\n      angle,\n      i,\n      j,\n      x,\n      y,\n      sin,\n      cos,\n      offset\n\n    while (pt) {\n      pt.r(ratio, pt.d)\n      pt = pt._next\n    }\n\n    if (ratio === 1 && data._apply) {\n      pt = data._pt\n\n      while (pt) {\n        if (pt.end) {\n          if (data._prop) {\n            target[data._prop] = pt.end\n          } else {\n            target.setAttribute(pt.endProp, pt.end) //make sure the end value is exactly as specified (in case we had to add fabricated points during the tween)\n          }\n        }\n\n        pt = pt._next\n      }\n    } else if (rawPath) {\n      //rotationally position the anchors\n      while (anchorPT) {\n        angle = anchorPT.sa + ratio * anchorPT.ca\n        l = anchorPT.sl + ratio * anchorPT.cl //length\n\n        anchorPT.t[anchorPT.i] = data._origin.x + _cos(angle) * l\n        anchorPT.t[anchorPT.i + 1] = data._origin.y + _sin(angle) * l\n        anchorPT = anchorPT._next\n      } //smooth out the control points\n\n      easeInOut = ratio < 0.5 ? 2 * ratio * ratio : (4 - 2 * ratio) * ratio - 1\n\n      while (controlPT) {\n        i = controlPT.i\n        segment = rawPath[controlPT.j]\n        offset = i + (i === segment.length - 4 ? 7 - segment.length : 5) //accommodates wrapping around of smooth points, like if the start and end anchors are on top of each other and their handles are smooth.\n\n        angle = _atan2(\n          segment[offset] - segment[i + 1],\n          segment[offset - 1] - segment[i]\n        ) //average the angles\n\n        sin = _sin(angle)\n        cos = _cos(angle)\n        x = segment[i + 2]\n        y = segment[i + 3]\n        l = controlPT.l1s + easeInOut * controlPT.l1c //length\n\n        segment[i] = x - cos * l\n        segment[i + 1] = y - sin * l\n        l = controlPT.l2s + easeInOut * controlPT.l2c\n        segment[offset - 1] = x + cos * l\n        segment[offset] = y + sin * l\n        controlPT = controlPT._next\n      }\n\n      target._gsRawPath = rawPath\n\n      if (data._apply) {\n        s = ''\n        space = ' '\n\n        for (j = 0; j < rawPath.length; j++) {\n          segment = rawPath[j]\n          l = segment.length\n          s +=\n            'M' +\n            ((segment[0] * rnd) | 0) / rnd +\n            space +\n            ((segment[1] * rnd) | 0) / rnd +\n            ' C'\n\n          for (i = 2; i < l; i++) {\n            //this is actually faster than just doing a join() on the array, possibly because the numbers have so many decimal places\n            s += ((segment[i] * rnd) | 0) / rnd + space\n          }\n        }\n\n        if (data._prop) {\n          target[data._prop] = s\n        } else {\n          target.setAttribute('d', s)\n        }\n      }\n    }\n\n    if (data._render && rawPath) {\n      data._render.call(data._tween, rawPath, target)\n    }\n  },\n  kill: function kill(property) {\n    this._pt = this._rawPath = 0\n  },\n  getRawPath: getRawPath,\n  stringToRawPath: stringToRawPath,\n  rawPathToString: rawPathToString,\n  pathFilter: _pathFilter,\n  pointsFilter: _pointsFilter,\n  getTotalSize: _getTotalSize,\n  equalizeSegmentQuantity: _equalizeSegmentQuantity,\n  convertToPath: function convertToPath(targets, swap) {\n    return _toArray(targets).map(function (target) {\n      return _convertToPath(target, swap !== false)\n    })\n  },\n  defaultType: 'linear',\n  defaultUpdateTarget: true,\n  defaultMap: 'size'\n}\n_getGSAP() && gsap.registerPlugin(MorphSVGPlugin)\nexport { MorphSVGPlugin as default }\n\n","/* eslint-disable */\n\n/*!\n * DrawSVGPlugin 3.0.5\n * https://greensock.com\n *\n * @license Copyright 2008-2020, GreenSock. All rights reserved.\n * Subject to the terms at https://greensock.com/standard-license or for\n * Club GreenSock members, the agreement issued with that membership.\n * @author: Jack Doyle, jack@greensock.com\n */\n\n/* eslint-disable */\nvar gsap,\n  _toArray,\n  _doc,\n  _win,\n  _isEdge,\n  _coreInitted,\n  _windowExists = function _windowExists() {\n    return typeof window !== 'undefined'\n  },\n  _getGSAP = function _getGSAP() {\n    return (\n      gsap ||\n      (_windowExists() && (gsap = window.gsap) && gsap.registerPlugin && gsap)\n    )\n  },\n  _numExp = /[-+=\\.]*\\d+[\\.e\\-\\+]*\\d*[e\\-\\+]*\\d*/gi,\n  //finds any numbers, including ones that start with += or -=, negative numbers, and ones in scientific notation like 1e-8.\n  _types = {\n    rect: ['width', 'height'],\n    circle: ['r', 'r'],\n    ellipse: ['rx', 'ry'],\n    line: ['x2', 'y2']\n  },\n  _round = function _round(value) {\n    return Math.round(value * 10000) / 10000\n  },\n  _parseNum = function _parseNum(value) {\n    return parseFloat(value || 0)\n  },\n  _getAttributeAsNumber = function _getAttributeAsNumber(target, attr) {\n    return _parseNum(target.getAttribute(attr))\n  },\n  _sqrt = Math.sqrt,\n  _getDistance = function _getDistance(x1, y1, x2, y2, scaleX, scaleY) {\n    return _sqrt(\n      Math.pow((_parseNum(x2) - _parseNum(x1)) * scaleX, 2) +\n        Math.pow((_parseNum(y2) - _parseNum(y1)) * scaleY, 2)\n    )\n  },\n  _warn = function _warn(message) {\n    return console.warn(message)\n  },\n  _hasNonScalingStroke = function _hasNonScalingStroke(target) {\n    return target.getAttribute('vector-effect') === 'non-scaling-stroke'\n  },\n  _bonusValidated = 1,\n  //<name>DrawSVGPlugin</name>\n  //accepts values like \"100%\" or \"20% 80%\" or \"20 50\" and parses it into an absolute start and end position on the line/stroke based on its length. Returns an an array with the start and end values, like [0, 243]\n  _parse = function _parse(value, length, defaultStart) {\n    var i = value.indexOf(' '),\n      s,\n      e\n\n    if (i < 0) {\n      s = defaultStart !== undefined ? defaultStart + '' : value\n      e = value\n    } else {\n      s = value.substr(0, i)\n      e = value.substr(i + 1)\n    }\n\n    s = ~s.indexOf('%') ? (_parseNum(s) / 100) * length : _parseNum(s)\n    e = ~e.indexOf('%') ? (_parseNum(e) / 100) * length : _parseNum(e)\n    return s > e ? [e, s] : [s, e]\n  },\n  _getLength = function _getLength(target) {\n    target = _toArray(target)[0]\n\n    if (!target) {\n      return 0\n    }\n\n    var type = target.tagName.toLowerCase(),\n      style = target.style,\n      scaleX = 1,\n      scaleY = 1,\n      length,\n      bbox,\n      points,\n      prevPoint,\n      i,\n      rx,\n      ry\n\n    if (_hasNonScalingStroke(target)) {\n      //non-scaling-stroke basically scales the shape and then strokes it at the screen-level (after transforms), thus we need to adjust the length accordingly.\n      scaleY = target.getScreenCTM()\n      scaleX = _sqrt(scaleY.a * scaleY.a + scaleY.b * scaleY.b)\n      scaleY = _sqrt(scaleY.d * scaleY.d + scaleY.c * scaleY.c)\n    }\n\n    try {\n      //IE bug: calling <path>.getTotalLength() locks the repaint area of the stroke to whatever its current dimensions are on that frame/tick. To work around that, we must call getBBox() to force IE to recalculate things.\n      bbox = target.getBBox() //solely for fixing bug in IE - we don't actually use the bbox.\n    } catch (e) {\n      //firefox has a bug that throws an error if the element isn't visible.\n      _warn(\n        \"Some browsers won't measure invisible elements (like display:none or masks inside defs).\"\n      )\n    }\n\n    var _ref = bbox || {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n      },\n      x = _ref.x,\n      y = _ref.y,\n      width = _ref.width,\n      height = _ref.height\n\n    if ((!bbox || (!width && !height)) && _types[type]) {\n      //if the element isn't visible, try to discern width/height using its attributes.\n      width = _getAttributeAsNumber(target, _types[type][0])\n      height = _getAttributeAsNumber(target, _types[type][1])\n\n      if (type !== 'rect' && type !== 'line') {\n        //double the radius for circles and ellipses\n        width *= 2\n        height *= 2\n      }\n\n      if (type === 'line') {\n        x = _getAttributeAsNumber(target, 'x1')\n        y = _getAttributeAsNumber(target, 'y1')\n        width = Math.abs(width - x)\n        height = Math.abs(height - y)\n      }\n    }\n\n    if (type === 'path') {\n      prevPoint = style.strokeDasharray\n      style.strokeDasharray = 'none'\n      length = target.getTotalLength() || 0\n\n      if (scaleX !== scaleY) {\n        _warn(\n          \"Warning: <path> length cannot be measured when vector-effect is non-scaling-stroke and the element isn't proportionally scaled.\"\n        )\n      }\n\n      length *= (scaleX + scaleY) / 2\n      style.strokeDasharray = prevPoint\n    } else if (type === 'rect') {\n      length = width * 2 * scaleX + height * 2 * scaleY\n    } else if (type === 'line') {\n      length = _getDistance(x, y, x + width, y + height, scaleX, scaleY)\n    } else if (type === 'polyline' || type === 'polygon') {\n      points = target.getAttribute('points').match(_numExp) || []\n\n      if (type === 'polygon') {\n        points.push(points[0], points[1])\n      }\n\n      length = 0\n\n      for (i = 2; i < points.length; i += 2) {\n        length +=\n          _getDistance(\n            points[i - 2],\n            points[i - 1],\n            points[i],\n            points[i + 1],\n            scaleX,\n            scaleY\n          ) || 0\n      }\n    } else if (type === 'circle' || type === 'ellipse') {\n      rx = (width / 2) * scaleX\n      ry = (height / 2) * scaleY\n      length = Math.PI * (3 * (rx + ry) - _sqrt((3 * rx + ry) * (rx + 3 * ry)))\n    }\n\n    return length || 0\n  },\n  _getPosition = function _getPosition(target, length) {\n    target = _toArray(target)[0]\n\n    if (!target) {\n      return [0, 0]\n    }\n\n    if (!length) {\n      length = _getLength(target) + 1\n    }\n\n    var cs = _win.getComputedStyle(target),\n      dash = cs.strokeDasharray || '',\n      offset = _parseNum(cs.strokeDashoffset),\n      i = dash.indexOf(',')\n\n    if (i < 0) {\n      i = dash.indexOf(' ')\n    }\n\n    dash = i < 0 ? length : _parseNum(dash.substr(0, i)) || 1e-5\n\n    if (dash > length) {\n      dash = length\n    }\n\n    return [Math.max(0, -offset), Math.max(0, dash - offset)]\n  },\n  _initCore = function _initCore() {\n    if (_windowExists()) {\n      _doc = document\n      _win = window\n      _coreInitted = gsap = _getGSAP()\n      _toArray = gsap.utils.toArray\n      _isEdge = ((_win.navigator || {}).userAgent || '').indexOf('Edge') !== -1 //Microsoft Edge has a bug that causes it not to redraw the path correctly if the stroke-linecap is anything other than \"butt\" (like \"round\") and it doesn't match the stroke-linejoin. A way to trigger it is to change the stroke-miterlimit, so we'll only do that if/when we have to (to maximize performance)\n    }\n  }\n\nexport var DrawSVGPlugin = {\n  version: '3.0.5',\n  name: 'drawSVG',\n  register: function register(core) {\n    gsap = core\n\n    _initCore()\n  },\n  init: function init(target, value, tween, index, targets) {\n    if (!target.getBBox) {\n      return false\n    }\n\n    if (!_coreInitted) {\n      _initCore()\n    }\n\n    var length = _getLength(target) + 1,\n      start,\n      end,\n      overage,\n      cs\n    this._style = target.style\n    this._target = target\n\n    if (value + '' === 'true') {\n      value = '0 100%'\n    } else if (!value) {\n      value = '0 0'\n    } else if ((value + '').indexOf(' ') === -1) {\n      value = '0 ' + value\n    }\n\n    start = _getPosition(target, length)\n    end = _parse(value, length, start[0])\n    this._length = _round(length + 10)\n\n    if (start[0] === 0 && end[0] === 0) {\n      overage = Math.max(0.00001, end[1] - length) //allow people to go past the end, like values of 105% because for some paths, Firefox doesn't return an accurate getTotalLength(), so it could end up coming up short.\n\n      this._dash = _round(length + overage)\n      this._offset = _round(length - start[1] + overage)\n      this._offsetPT = this.add(\n        this,\n        '_offset',\n        this._offset,\n        _round(length - end[1] + overage)\n      )\n    } else {\n      this._dash = _round(start[1] - start[0]) || 0.000001 //some browsers render artifacts if dash is 0, so we use a very small number in that case.\n\n      this._offset = _round(-start[0])\n      this._dashPT = this.add(\n        this,\n        '_dash',\n        this._dash,\n        _round(end[1] - end[0]) || 0.00001\n      )\n      this._offsetPT = this.add(this, '_offset', this._offset, _round(-end[0]))\n    }\n\n    if (_isEdge) {\n      //to work around a bug in Microsoft Edge, animate the stroke-miterlimit by 0.0001 just to trigger the repaint (unnecessary if it's \"round\" and stroke-linejoin is also \"round\"). Imperceptible, relatively high-performance, and effective. Another option was to set the \"d\" <path> attribute to its current value on every tick, but that seems like it'd be much less performant.\n      cs = _win.getComputedStyle(target)\n\n      if (cs.strokeLinecap !== cs.strokeLinejoin) {\n        end = _parseNum(cs.strokeMiterlimit)\n        this.add(target.style, 'strokeMiterlimit', end, end + 0.01)\n      }\n    }\n\n    this._live = _hasNonScalingStroke(target) || ~(value + '').indexOf('live')\n\n    this._props.push('drawSVG')\n\n    return _bonusValidated\n  },\n  render: function render(ratio, data) {\n    var pt = data._pt,\n      style = data._style,\n      length,\n      lengthRatio,\n      dash,\n      offset\n\n    if (pt) {\n      //when the element has vector-effect=\"non-scaling-stroke\" and the SVG is resized (like on a window resize), it actually changes the length of the stroke! So we must sense that and make the proper adjustments.\n      if (data._live) {\n        length = _getLength(data._target) + 11\n\n        if (length !== data._length) {\n          lengthRatio = length / data._length\n          data._length = length\n          data._offsetPT.s *= lengthRatio\n          data._offsetPT.c *= lengthRatio\n\n          if (data._dashPT) {\n            data._dashPT.s *= lengthRatio\n            data._dashPT.c *= lengthRatio\n          } else {\n            data._dash *= lengthRatio\n          }\n        }\n      }\n\n      while (pt) {\n        pt.r(ratio, pt.d)\n        pt = pt._next\n      }\n\n      dash = data._dash\n      offset = data._offset\n      length = data._length\n      style.strokeDashoffset = data._offset\n\n      if (ratio === 1 || !ratio) {\n        if (dash - offset < 0.001 && length - dash <= 10) {\n          //works around a bug in Safari that caused strokes with rounded ends to still show initially when they shouldn't.\n          style.strokeDashoffset = offset + 1\n        }\n\n        style.strokeDasharray =\n          offset < 0.001 && length - dash <= 10\n            ? 'none'\n            : offset === dash\n            ? '0px, 999999px'\n            : dash + 'px,' + length + 'px'\n      } else {\n        style.strokeDasharray = dash + 'px,' + length + 'px'\n      }\n    }\n  },\n  getLength: _getLength,\n  getPosition: _getPosition\n}\n_getGSAP() && gsap.registerPlugin(DrawSVGPlugin)\nexport { DrawSVGPlugin as default }\n\n","import { fetchLaTeXSvg } from '../utils'\n\nimport gsap from 'gsap'\nimport MorphSVGPlugin from '../gsap/MorphSVGPlugin'\nimport DrawSVGPlugin from '../gsap/DrawSVGPlugin'\n\nimport { LaTeXSVGData } from '../types'\n\ngsap.registerPlugin(MorphSVGPlugin, DrawSVGPlugin)\n\n// FIXME temp 'hack', should add colors={[...]} to <Morph>?\n\nfunction colorFromGroupId(id: string): string {\n  if (id === 'g0') return 'black'\n  return '#' + id.slice(1)\n}\n\nconst whiteListedColors = ['#00d56f']\n\nconst DEFAULT_TIMING = 0.4\n\nexport type SVGData = {\n  width: number\n  height: number\n  viewBox: number[]\n}\nexport async function animate(\n  svgEl: SVGSVGElement,\n  text: string,\n  replaceImediately = false,\n  TIMING: number = DEFAULT_TIMING,\n  setSvgData: (data: SVGData) => void = () => undefined\n): Promise<any[]> {\n  let data: LaTeXSVGData\n  if (text === '') {\n    data = {\n      groups: {},\n      width: 0,\n      height: 0,\n      viewBox: [0, 0, 0, 0]\n    }\n  } else {\n    data = await fetchLaTeXSvg(text)\n  }\n\n  if (!data) {\n    return []\n  }\n\n  const { groups: newPaths, width, height, viewBox } = data\n\n  // This should check if is unmounted\n  setSvgData({ width, height, viewBox })\n\n  const afterIds = Object.keys(newPaths)\n  const beforeIds = Array.from(svgEl.querySelectorAll('[id]')).map((e) => e.id)\n  const allIds = Array.from(new Set([...afterIds, ...beforeIds]))\n\n  return Promise.all(\n    allIds.map(async (id) => {\n      const shouldRemove = beforeIds.includes(id) && !afterIds.includes(id)\n      const isNew = afterIds.includes(id) && !beforeIds.includes(id)\n\n      if (shouldRemove) {\n        const element = svgEl.getElementById(id)\n        if (replaceImediately) {\n          element.remove()\n          return true\n        } else {\n          await gsap.to(element, {\n            duration: TIMING,\n            opacity: 0\n          })\n          element.remove()\n          return true\n        }\n      }\n\n      if (isNew) {\n        const path = document.createElementNS(\n          'http://www.w3.org/2000/svg',\n          'path'\n        )\n        path.id = id\n        path.setAttribute('d', newPaths[id])\n\n        const color = colorFromGroupId(id)\n        if (whiteListedColors.includes(color)) {\n          path.setAttribute('fill', color)\n        }\n\n        path.style.opacity = '0'\n        svgEl.appendChild(path)\n\n        if (replaceImediately) {\n          path.style.opacity = '1'\n          return true\n        } else {\n          await gsap.to(path, {\n            duration: TIMING,\n            opacity: 1\n          })\n          return true\n        }\n      }\n\n      // morphing\n      const element = svgEl.getElementById(id) as SVGElement\n\n      if (replaceImediately) {\n        element.setAttribute('d', newPaths[id])\n        element.style.opacity = '1'\n        return true\n      } else {\n        await gsap.to(element, {\n          duration: TIMING,\n          morphSVG: newPaths[id],\n          // TODO test if makes difference!\n          // type:\"rotational\",\n          opacity: 1\n        })\n        return true\n      }\n    })\n  )\n}\n","import React, { useEffect, useState, useMemo, useCallback } from 'react'\n\nimport { useLocalStorage } from './utils'\nimport Morph from './Morph'\n\nimport './AnimationEditor.css'\n// import localStorageData from './localStorage.json'\n\ntype Selection = [number, number, number]\n\ntype AnimationEditorProps = {\n  animations: { start: string; end: string }[]\n}\n\ntype Animation = {\n  startGroups: Selection[]\n  endGroups: Selection[]\n  start: string\n  end: string\n  index?: number\n}\n\ntype AnimationProps = {\n  colorIndex: number\n  setColorIndex: (arg: number) => void\n  animation: Animation\n  setAnimation: (arg: Animation) => void\n}\n\n/* global localStorage */\nconst allColors = [\n  '#ff8a80',\n  '#ea80fc',\n  '#b388ff',\n  '#8c9eff',\n  '#82b1ff',\n  '#80d8ff',\n  '#84ffff',\n  '#a7ffeb',\n  '#b9f6ca',\n  '#ccff90',\n  '#f4ff81',\n  '#ffff8d',\n  '#ffe57f',\n  '#ffd180',\n  '#ff9e80'\n]\n\nfunction convertToTeX(tex: string, selections: Selection[]) {\n  return (\n    tex\n      .split('')\n      .map((c, i) => {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const ending = selections.filter(([c, s, e]) => e === i)\n        const starting = selections\n          .filter(([_c, s, _e]) => s === i)\n          .sort((a, b) => b[2] - a[2]) // descending on `end`\n          .map(([c, s, e]) => c)\n\n        return (\n          ending.map(() => '}').join('') +\n          starting.map((col) => `\\\\g{${col + 1}}{`).join('') +\n          c\n        )\n      })\n      .join('') +\n    selections\n      .filter(([c, s, e]) => e === tex.length)\n      .map(() => '}')\n      .join('')\n  )\n}\n\nexport const lookupAnimationGroups = (() => {\n  // TODO: use hashmap?\n  return (start: string, end: string) => {\n    const data = JSON.parse(localStorage.animationGroups || '[]') as Animation[]\n    const result = data.find(({ start: s, end: e }) => {\n      return (start === s && end === e) || (start === e && end === s)\n    })\n\n    // no result found\n    if (!result) {\n      return [start, end]\n    }\n\n    if (result.start === start) {\n      // not reversed\n      return [\n        convertToTeX(result.start, result.startGroups),\n        convertToTeX(result.end, result.endGroups)\n      ]\n    } else {\n      // reversed\n      return [\n        convertToTeX(result.end, result.endGroups),\n        convertToTeX(result.start, result.startGroups)\n      ]\n    }\n  }\n})()\n\nexport default function AnimationEditor({\n  animations: playedAnimations\n}: AnimationEditorProps): React.ReactElement {\n  const [animations, setAnimations] = useLocalStorage<Animation[]>(\n    'animationGroups',\n    []\n  )\n  const [colorIndex, setColorIndex] = useState<number>(0)\n\n  const onKeyPress = (e: KeyboardEvent): void => {\n    try {\n      const i = parseInt(e.key, 10)\n      setColorIndex((i + 9) % 10)\n    } catch (e) {}\n  }\n\n  useEffect(() => {\n    window.addEventListener('keypress', onKeyPress)\n    return () => window.removeEventListener('keypress', onKeyPress)\n  }, [])\n\n  useEffect(() => {\n    const newOnes = playedAnimations\n      .filter((animation) => {\n        const animated = animations.find(\n          (a) =>\n            (animation.start === a.start && animation.end === a.end) ||\n            (animation.start === a.end && animation.end === a.start)\n        )\n        const inDataBase = !animated\n        return inDataBase\n      })\n      .map((anim) => ({\n        ...anim,\n        startGroups: [],\n        endGroups: []\n      }))\n\n    if (newOnes.length >= 1) {\n      setAnimations((animations) => [...animations, ...newOnes])\n    }\n  }, [animations, playedAnimations])\n\n  const animationsIShouldShow = useMemo(\n    () =>\n      (playedAnimations\n        .map((animation) => {\n          const index = animations.findIndex(\n            (a) =>\n              (animation.start === a.start && animation.end === a.end) ||\n              (animation.start === a.end && animation.end === a.start)\n          )\n\n          const a = animations[index]\n\n          if (!a) return null\n\n          return {\n            ...a,\n            start: '' + a.start,\n            end: '' + a.end,\n            index\n          } as Animation\n        })\n        .filter((a) => a !== null) as (Animation & { index: number })[]).filter(\n        (value, index, array) => {\n          return (\n            array.findIndex(\n              ({ start, end }) => value.start === start && value.end === end\n            ) === index\n          )\n        }\n      ),\n    [animations, playedAnimations]\n  )\n\n  return (\n    <div className='animation-editor'>\n      <div className='colors'>\n        {allColors.map((c, i) => (\n          <span\n            key={i}\n            className='color'\n            style={{\n              backgroundColor: c,\n              transform: colorIndex === i ? 'scale(1.4)' : 'scale(1)'\n            }}\n            onClick={() => setColorIndex(i)}\n          />\n        ))}\n      </div>\n      <style>{` .formula *::selection { background: ${allColors[colorIndex]} } `}</style>\n\n      <div className='animations'>\n        {animationsIShouldShow.map((animation) => {\n          const i = animation.index\n          return (\n            <Animation\n              key={animation.start + animation.end}\n              animation={animation}\n              setAnimation={(f: Animation) =>\n                setAnimations([\n                  ...animations.slice(0, i),\n                  f,\n                  ...animations.slice(i + 1)\n                ])\n              }\n              colorIndex={colorIndex}\n              setColorIndex={setColorIndex}\n            />\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n\ntype Part = 'start' | 'end'\n\nfunction Animation({\n  colorIndex,\n  setColorIndex,\n  animation,\n  setAnimation\n}: AnimationProps) {\n  const handleSelection = useCallback(() => {\n    const sel = window.getSelection()\n\n    if (!sel) return\n\n    if (!sel.anchorNode || !sel.focusNode) return\n    try {\n      const sString = (sel.anchorNode?.parentNode as HTMLElement)?.dataset.index\n      const eString = (sel.focusNode?.parentNode as HTMLElement)?.dataset.index\n      if (sString === undefined || eString === undefined) return\n\n      const s = parseInt(sString, 10) + sel.anchorOffset\n      const e = parseInt(eString, 10) + sel.focusOffset\n\n      // check if selection does not cross two formulas (before / after)\n      const part1 = (sel.focusNode.parentNode as HTMLElement).dataset.part\n      const part2 = (sel.focusNode.parentNode as HTMLElement).dataset.part\n\n      if (!part1 || !part2) return\n      if (part1 !== part2) return\n\n      const part = part1\n      if (part !== 'start' && part !== 'end') {\n        return\n      }\n\n      const start = Math.min(s, e)\n      const end = Math.max(s, e)\n      if (start === end) {\n        return\n      }\n      const newAnimation = {\n        ...animation,\n        [part + 'Groups']: mergeSelections([\n          ...animation[(part + 'Groups') as 'endGroups' | 'startGroups'],\n          [colorIndex, start, end]\n        ])\n      }\n\n      setAnimation(newAnimation)\n    } catch (e) {\n      // Happend when you select non-formula stuff\n      // do nothing\n    } finally {\n      sel?.removeAllRanges()\n    }\n  }, [animation, colorIndex])\n\n  const handleClick = useCallback(\n    (ev, part: Part) => {\n      // remove\n      if (ev.button === 2) {\n        const index = ev.target.dataset.index\n        const groups = (part + 'Groups') as 'endGroups' | 'startGroups'\n        const selections = determineSelections(\n          animation[part],\n          animation[groups]\n        )\n        const activeSelection = selections[index]\n\n        if (!activeSelection) {\n          return\n        }\n\n        setAnimation({\n          ...animation,\n          [groups]: animation[groups].filter(\n            (s: Selection) => s !== activeSelection\n          )\n        })\n\n        return\n      }\n\n      // pick color\n      if (ev.button === 1) {\n        ev.preventDefault()\n        const group = ev.target.dataset.group\n        setColorIndex(+group)\n        return\n      }\n    },\n    [setAnimation, animation, setColorIndex, colorIndex]\n  )\n\n  // return <pre>{JSON.stringify(animation)}</pre>;\n\n  const splitChars = (part: Part) => {\n    const groups = (part + 'Groups') as 'endGroups' | 'startGroups'\n    const selections = determineSelections(animation[part], animation[groups])\n    return (\n      <div key={part}>\n        <span\n          className='formula'\n          style={{ fontFamily: 'Iosevka Term, monospace' }}\n          onMouseUp={(e) => handleClick(e, part)}\n          onContextMenu={(e) => e.preventDefault()}\n        >\n          {animation[part].split('').map((c: string, j: number) => {\n            const sel = selections[j]\n            const color = sel === null ? '' : allColors[sel[0]]\n            const group = sel === null ? -1 : sel[0]\n            return (\n              <span\n                key={j}\n                data-part={part}\n                data-index={j}\n                data-group={group}\n                style={{ background: color }}\n              >\n                {c}\n              </span>\n            )\n          })}\n        </span>\n      </div>\n    )\n  }\n\n  return (\n    <div className='animation' onMouseUp={() => handleSelection()}>\n      {(['start', 'end'] as Part[]).map(splitChars)}\n      <div className='preview'>\n        <AutoMorph\n          steps={[\n            convertToTeX(animation.start, animation.startGroups),\n            convertToTeX(animation.end, animation.endGroups)\n          ]}\n        />\n      </div>\n      {/* }<button className='remove' onClick={removeAnimation}></button> */}\n    </div>\n  )\n}\n\nfunction AutoMorph({ steps }: { steps: [string, string] }) {\n  const [step, setStep] = useState<0 | 1>(0)\n  const onClick = () => setStep((step) => ((step + 1) % 2) as 0 | 1)\n\n  return (\n    <div className='automorph' onClick={onClick}>\n      <Morph TIMING={1.0} display useAnimationDatabase={false}>\n        {steps[step]}\n      </Morph>\n    </div>\n  )\n}\n\nfunction determineSelections(\n  tex: string,\n  selections: Selection[]\n): (Selection | null)[] {\n  const colors: (Selection | null)[] = []\n  let levels: Selection[] = []\n  tex.split('').forEach((_c, i) => {\n    const ending = selections.filter(([_c, _s, e]) => e === i)\n\n    const starting = selections\n      .filter(([_c, s, _e]) => s === i)\n      .sort((a, b) => b[2] - a[2]) // descending on `end`\n\n    levels = levels.slice(0, levels.length - ending.length)\n    levels = [...levels, ...starting]\n\n    const currentActive = levels[levels.length - 1]\n    if (!currentActive) {\n      colors.push(null)\n    } else {\n      colors.push(currentActive)\n    }\n  })\n\n  return colors\n}\n\n// TODO: unit test this\nfunction mergeSelections(selections: Selection[]): Selection[] {\n  const result: Selection[] = []\n  selections.forEach(([color, start, end]) => {\n    const prev = result.find(([c, _s, e]) => e === start && c === color)\n    if (prev) {\n      prev[2] = end\n      return\n    }\n    const surrounding = result.find(\n      ([c, s, e]) => c === color && s <= start && e >= end\n    )\n\n    if (surrounding) {\n      // Don't include this selection, it is surrounded by a bigger selection of the same color\n      return\n    }\n\n    result.push([color, start, end])\n  })\n  return result\n}\n","import React, {\n  Fragment,\n  useEffect,\n  useState,\n  useRef,\n  useCallback\n} from 'react'\n\nimport { animate, SVGData } from './lib/morph.js'\nimport { lookupAnimationGroups } from './AnimationEditor'\n\nimport { usePrevious, useIsomorphicLayoutEffect } from './utils.js'\n\nexport const wrapMathBasedOnProps = (\n  props: { display?: boolean; inline?: boolean },\n  s: string\n): string => {\n  if (props.display) {\n    return '$\\\\displaystyle ' + s + '$'\n  } else if (props.inline) {\n    return '$' + s + '$'\n  }\n  return s\n}\n\ntype MorphProps = {\n  children: string\n  display?: boolean\n  inline?: boolean\n  debug?: boolean\n  useAnimationDatabase?: boolean\n  replace?: boolean\n  TIMING?: number\n  style?: React.CSSProperties\n  className?: string\n}\n\n// TODO: maybe use useLayout effect for some things?\nfunction Morph({\n  children,\n  display,\n  inline,\n  debug,\n  useAnimationDatabase = true,\n  replace,\n  TIMING = 0.6,\n  style = {},\n  className = ''\n}: MorphProps): React.ReactElement {\n  const svgEl = useRef<SVGSVGElement | null>(null)\n  const [\n    {\n      viewBox: [vx, vy, vw, vh],\n      width,\n      height\n    },\n    setSvgData\n  ] = useState<SVGData>({\n    viewBox: [0, 0, 0, 0],\n    width: 0,\n    height: 0\n  })\n\n  const [transition, setTransition] = useState(false)\n\n  const FONT_SCALING_FACTOR = 2\n\n  const updateSvgData = ({ viewBox, width, height }: SVGData) => {\n    setSvgData({\n      viewBox,\n      width: FONT_SCALING_FACTOR * width,\n      height: FONT_SCALING_FACTOR * height\n    })\n  }\n\n  const wrapMath = useCallback(\n    (tex) => wrapMathBasedOnProps({ display, inline }, tex),\n    [display, inline]\n  )\n\n  const previousChildren = usePrevious(children)\n\n  // This eliminates \"fly in\" effect.\n  useIsomorphicLayoutEffect(() => {\n    if (!previousChildren) {\n      setTransition(false)\n    } else {\n      setTransition(true)\n    }\n  }, [children])\n\n  const promise = useRef(Promise.resolve())\n  const update = async (children: string) => {\n    const svg = svgEl.current\n    const anim = (text: string, replaceImediately: boolean) => {\n      if (!svg) return\n      return animate(svg, text, replaceImediately, TIMING, updateSvgData)\n    }\n\n    if (!children) {\n      await anim('', false)\n      return\n    }\n\n    if (typeof children !== 'string') {\n      console.error(\"Trying to compile something that is'nt text:\", children)\n      return\n    }\n\n    if (!previousChildren) {\n      await anim(wrapMath(children), false)\n      return\n    }\n\n    if (replace) {\n      await anim(wrapMath(children), true)\n      return\n    }\n\n    if (useAnimationDatabase) {\n      const [before, after] = lookupAnimationGroups(\n        previousChildren || '',\n        children\n      )\n\n      await anim(wrapMath(before), true)\n      await anim(wrapMath(after), false)\n    } else {\n      await anim(wrapMath(children), false)\n    }\n  }\n\n  useEffect(() => {\n    // This plays the animation after all the others have played.\n    // Makes sure two animations aren't playing at the same time\n\n    promise.current = promise.current\n      .then(() => update(children))\n      .catch(() => {\n        console.log('Failed to update Morph children')\n      })\n  }, [children])\n\n  const inner = (\n    <div\n      style={{\n        ...(display\n          ? {\n              left: '50%',\n              transform: `translate(${-width / 2}pt, 0)`\n            }\n          : {}),\n        width: 0,\n        height: 0,\n        marginTop: `${-vy * FONT_SCALING_FACTOR}pt`,\n        marginRight: `${width}pt`,\n        verticalAlign: 'baseline',\n        position: 'relative',\n        display: 'inline-block',\n        ...(transition\n          ? {\n              transition: `${TIMING}s margin-right, ${TIMING}s margin-top, ${TIMING}s transform`\n            }\n          : {\n              transition: ` ${TIMING}s margin-top`\n            }),\n        ...(debug ? { outline: '1px solid lightblue' } : {})\n      }}\n      className={className}\n    >\n      <svg\n        width={width + 'pt'}\n        height={height + 'pt'}\n        viewBox={[vx, vy, vw, vh].join(' ')}\n        style={{\n          display: 'inline-block',\n          position: 'absolute',\n          top: `${FONT_SCALING_FACTOR * vy}pt`,\n          verticalAlign: 'baseline',\n          ...(debug ? { outline: '1px solid yellow' } : {}),\n          ...style\n        }}\n        ref={svgEl}\n      />\n    </div>\n  )\n\n  if (display) {\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexGrow: 1,\n          height: height + 'pt',\n          margin: '0.5em 0',\n          transition: `${TIMING}s height`,\n          ...(debug ? { outline: '1px solid red' } : {})\n        }}\n      >\n        {inner}\n      </div>\n    )\n  } else {\n    return (\n      <Fragment>\n        {/* strut */}\n        <div\n          style={{\n            display: 'inline-block',\n            width: 0,\n            verticalAlign: 'text-top',\n            marginTop: '0.9em',\n            height: height + vy + 'pt',\n            ...(transition\n              ? { transition: `${TIMING}s height, ${TIMING}s margin-bottom` }\n              : {}),\n            ...(debug ? { width: '2px', background: 'limegreen' } : {})\n          }}\n        />\n        {inner}\n      </Fragment>\n    )\n  }\n}\n\nexport default Morph\n","import React from 'react'\nimport { PresentationContext, RenderSlide } from './Presentation'\nimport { CitationContext, RenderCite, CitationMap } from './Citations'\nimport Notes from './PresenterNotes'\n\nimport flattenDeep from 'lodash/flattenDeep'\nimport Morph, { wrapMathBasedOnProps } from './Morph'\nimport { lookupAnimationGroups } from './AnimationEditor'\n\n// TODO: does this also work for figures?\n\ntype FakeContextes = [React.Context<any>, any][]\nconst withFakeDispatcher = <T>(ctx: FakeContextes, cb: () => T): T => {\n  // I'll guess I'll be fired then ;)\n  const {\n    ReactCurrentDispatcher\n  } = (React as any).__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED\n  const original = ReactCurrentDispatcher.current\n\n  ReactCurrentDispatcher.current = {\n    useContext: (context: React.Context<any>): any => {\n      const result = ctx.find(([c, _]) => c === context)\n      if (result) {\n        return result[1]\n      }\n      return {}\n    },\n    readContext: () => null,\n    useCallback: (x: any) => x,\n    useEffect: () => null,\n    useImperativeHandle: () => null,\n    useLayoutEffect: () => null,\n    useMemo: (x: any) => x,\n    useReducer: (_: any, initialState: any) => initialState,\n    useRef: (initial: any) => {\n      const ref = { current: initial }\n      return ref\n    },\n    useState: (initial: any) => [initial, (x: any): any => x],\n    useDebugValue: () => null,\n    useResponder: () => null,\n    useDeferredValue: () => null,\n    useTransition: () => null\n  }\n\n  let result: T\n  try {\n    result = cb()\n  } finally {\n    ReactCurrentDispatcher.current = original\n  }\n  return result\n}\n\nconst isComponent = (\n  node: any\n): node is { type: (arg: any) => React.ReactElement } =>\n  node.type && typeof node.type === 'function'\n\nconst ignore: React.JSXElementConstructor<any>[] = [Morph, RenderCite]\nconst findElementsInTree = (\n  node: React.ReactElement,\n  predicate: (arg: any) => boolean\n): React.ReactElement[] => {\n  const found: React.ReactElement[] = []\n\n  const handleTree = (node: React.ReactElement): void => {\n    if (predicate(node)) {\n      found.push(node)\n      return\n    }\n\n    if (isComponent(node)) {\n      // Do not go deeper into Morphs, ...\n      if (ignore.includes(node.type)) {\n        return\n      }\n\n      const resolved = node.type(node.props)\n      // TODO: Maybe we should check if resolved is a ReactElement? Could maybe be string / ...?\n      return handleTree(resolved as React.ReactElement)\n    }\n\n    if (node.props && node.props.children) {\n      const childs = flattenDeep(\n        Array.isArray(node.props.children)\n          ? node.props.children\n          : [node.props.children]\n      )\n      childs.forEach((child) => {\n        if (child) {\n          handleTree(child as React.ReactElement)\n        }\n      })\n    }\n  }\n\n  handleTree(node)\n  return found\n}\n\ntype SlideAndProps = {\n  slide: React.ReactElement\n  props: { [key: string]: any }\n}\n\n// Does as it says. e.g.\n// <ProofSlide color='false'>\n//   resolves to -> <Slide header='test' />\n//\n//   the resulting props are {color: false, header: test, slide: the <Slide> component}\nconst getPropsRecursiveUntilSlideComponentIsEncountered = (\n  node: React.ReactElement\n): SlideAndProps => {\n  const props = node.props\n  const type = node.type as any\n\n  if (type === RenderSlide) {\n    return { ...props, slide: node }\n  }\n\n  let resolved\n  if (typeof type === 'function') {\n    resolved = (type as (arg: any) => React.ReactElement)({ ...props })\n  } else if (\n    // forward ref\n    typeof type === 'object' &&\n    type.$$typeof === Symbol.for('react.forward_ref') &&\n    typeof type?.render === 'function'\n  ) {\n    resolved = type.render(props, (node as any)?.ref)\n  } else {\n    console.log('static analysis: type was not function ...', node, type)\n  }\n\n  const rest = getPropsRecursiveUntilSlideComponentIsEncountered(resolved)\n  return {\n    ...props,\n    ...rest\n  }\n}\n\nexport type SlideInfo = {\n  slide: React.ReactChild\n  info: { [key: string]: any }\n  steps: any[]\n  animations: { start: string; end: string }[]\n  allLaTeX: string[]\n  presenterNotes: React.ReactNode\n}\nexport type SlidesInfo = SlideInfo[]\nexport type SlidesInfoAndCitationMap = {\n  slidesInfo: SlidesInfo\n  citationMap: CitationMap\n}\n\nexport function getSlidesInfo(\n  slides: React.ReactElement[]\n): SlidesInfoAndCitationMap {\n  // TODO should probably make this a ES6 Map\n  const mockContextes: [any, any][] = [\n    [\n      PresentationContext,\n      {\n        i: 0,\n        slideIndex: 0,\n        slidesInfo: slides.map(() => ({ info: {} }))\n      }\n    ],\n    [\n      CitationContext,\n      {\n        bibliography: [],\n        citationMap: {}\n      }\n    ]\n  ]\n\n  // note that the steps prop is not yet okay: because the table of contents doesn't know yet how many sections there are, it cannot determine the number of steps ...\n  let slideWithProps: SlideAndProps[] = withFakeDispatcher(\n    mockContextes,\n    () => {\n      return slides.map(getPropsRecursiveUntilSlideComponentIsEncountered)\n    }\n  )\n\n  // this adds the current section to each of the slides\n  //\n  // slide:   1234567\n  // section: A   B\n  //\n  // gets transformed to\n  //\n  // slide:        1234567\n  // section:      AAAABBB\n  // sectionSlide: tffftff\n\n  type Info = {\n    section: string\n    hideNavigation: boolean\n    sectionSlide: boolean\n    header: string | null\n    [key: string]: any\n  }\n\n  const infos: Info[] = []\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  for (const { slide, steps, ...props } of slideWithProps as {\n    slide: React.ReactElement\n    section?: string\n    hideNavigation?: boolean\n    header?: string\n    [key: string]: any\n  }[]) {\n    const accumulatedInfo = infos[infos.length - 1]\n    const newInfo = {\n      ...accumulatedInfo\n    }\n\n    for (const key in props) {\n      newInfo[key] = props[key]\n    }\n\n    newInfo.sectionSlide = !!props.section\n    newInfo.hideNavigation = !!props.hideNavigation\n\n    if (props.section) {\n      newInfo.section = props.section\n    }\n\n    if (props.header) {\n      newInfo.header = props.header\n    } else {\n      newInfo.header = null\n    }\n\n    infos.push(newInfo)\n  }\n\n  // Now we add this info to the presentation context\n  // Now the <TableOfContentsSlide /> knows how many sections there are, so it can calculate how many steps the slide is based on this.\n\n  const citationMap = withFakeDispatcher(mockContextes, () => {\n    return getCitations(slideWithProps.map((x) => x.slide))\n  })\n\n  mockContextes.find(\n    (x) => x[0] === PresentationContext\n  )![1].slidesInfo = infos.map((info) => ({ info }))\n\n  mockContextes.find(\n    (x) => x[0] === CitationContext\n  )![1].citationMap = citationMap\n\n  return withFakeDispatcher(mockContextes, () => {\n    slideWithProps = slides.map(\n      getPropsRecursiveUntilSlideComponentIsEncountered\n    )\n    const slidesInfo: SlideInfo[] = slideWithProps.map(\n      ({ slide, ...props }: SlideAndProps, index: number): SlideInfo => ({\n        slide,\n        info: infos[index],\n        steps: (props as { steps?: any[] }).steps || [null],\n        ...animations(slide),\n        presenterNotes: presenterNotes(slide)\n      })\n    )\n\n    console.log(slidesInfo, citationMap)\n    // GOAL: (be able to) pre fetch all the latex of all slides.\n    // Problem: animate from lib/morph does some replaces on these strings that we should do as well before trying to compile this.\n    // OR: move these replacements elsewhere\n    return { slidesInfo, citationMap }\n  })\n}\n\nconst presenterNotes = (slide: React.ReactElement): React.ReactNode => {\n  let tree: React.ReactElement\n  if (!slide.props.steps || typeof slide.props.children !== 'function') {\n    tree = slide\n  } else {\n    tree = slide.props.children(slide.props.steps[0])\n  }\n\n  const notes = findElementsInTree(\n    tree,\n    (node) => typeof node.type === 'function' && node.type === Notes\n  )\n  if (notes.length > 1) {\n    console.error('On slide ', slide, 'you have more than one <Notes>!')\n  }\n  const note = notes[0]\n  if (!note) return null\n  return note.props.children\n}\n\nconst animations = (slide: React.ReactElement) => {\n  class MorphArray extends Array<string> {\n    props?: { [key: string]: any }\n  }\n\n  const allLaTeX: string[] = []\n  const morphs: { [key: string]: MorphArray } = {}\n\n  const defaultResult = {\n    animations: [],\n    allLaTeX: []\n  }\n\n  if (typeof slide.props.children !== 'function') {\n    // If type is not a function, we have no animations.\n    // But we still can have static LaTeX!\n\n    // This is copied from below. Maybe extract this ...\n    findElementsInTree(\n      slide,\n      (node) => typeof node.type === 'function' && node.type === Morph\n    ).forEach((node) => {\n      // should also apply groups ...\n\n      if (node.props.replace) {\n        // No animations to consider, is replaced immediately\n        // Is used for plain LaTeX (<Morph replace />)\n\n        if (node.props.children) {\n          allLaTeX.push(wrapMathBasedOnProps(node.props, node.props.children))\n        }\n      }\n    })\n    return {\n      animations: [],\n      allLaTeX\n    }\n  }\n\n  if (!slide.props.steps) return defaultResult\n\n  slide.props.steps.forEach((step: any) => {\n    const tree = slide.props.children(step)\n\n    findElementsInTree(\n      tree,\n      (node) => typeof node.type === 'function' && node.type === Morph\n    ).forEach((node) => {\n      // should also apply groups ...\n\n      if (node.props.replace) {\n        // No animations to consider, is replaced immediately\n        // Is used for plain LaTeX (<Morph replace />)\n\n        if (node.props.children) {\n          allLaTeX.push(wrapMathBasedOnProps(node.props, node.props.children))\n        }\n        return\n      }\n      const id = JSON.stringify(((node as any) as { _source: any })._source)\n      const contents = node.props.children\n      morphs[id] = morphs[id] ? [...morphs[id], contents] : [contents]\n      morphs[id].props = node.props\n\n      // this is a bit fishy, setting a property of an array. Need it later to wrap the math correctly.\n    })\n  })\n\n  const anim: { start: string; end: string }[] = []\n  for (const key in morphs) {\n    const formulas = morphs[key]\n    formulas.forEach((formula: string, i: number) => {\n      const start = formula\n      const end = formulas[i + 1]\n      if (i < formulas.length - 1 && start !== end) {\n        anim.push({ start, end })\n\n        if (start && end) {\n          if (!formulas.props) {\n            // This shouldn't happen\n            return\n          }\n          // start and end not undefined\n          const [startGrouped, endGrouped] = lookupAnimationGroups(start, end)\n          allLaTeX.push(wrapMathBasedOnProps(formulas.props, startGrouped))\n          allLaTeX.push(wrapMathBasedOnProps(formulas.props, endGrouped))\n        }\n      }\n    })\n  }\n\n  return {\n    animations: anim,\n    allLaTeX: allLaTeX\n  }\n}\n\nfunction getCitations(slides: React.ReactElement[]): CitationMap {\n  const citationMap: CitationMap = {}\n\n  slides.forEach((slide) => {\n    let trees = [slide]\n    if (typeof slide.props.children === 'function' && !!slide.props.steps) {\n      trees = slide.props.steps.map((step: any) => slide.props.children(step))\n    }\n\n    trees.forEach((tree) => {\n      findElementsInTree(\n        tree,\n        (node) => typeof node.type === 'function' && node.type === RenderCite\n      ).forEach((cite) => {\n        const id = cite.props.id\n        if (!citationMap[id]) {\n          const number = Math.max(0, ...Object.values(citationMap)) + 1\n          citationMap[id] = number\n        }\n      })\n    })\n  })\n  return citationMap\n}\n","import React, {\n  useEffect,\n  useState,\n  useContext,\n  useCallback,\n  useMemo\n} from 'react'\n\nimport { getSlidesInfo, SlidesInfo } from './staticAnalysis'\n\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n  useParams,\n  generatePath,\n  useRouteMatch,\n  useHistory\n} from 'react-router-dom'\n\nimport { CitationProvider } from './Citations'\nimport AnimationEditor from './AnimationEditor'\nimport { LaTeX, fetchLaTeXSvg, useIsomorphicLayoutEffect } from './utils'\n\ntype PresentationRenderFunction = (arg: {\n  slideIndex: number\n  stepIndex: number\n  slidesInfo: SlidesInfo\n  slides: React.ReactChild[]\n}) => React.ReactNode\n\nexport type StepAndSlide = {\n  slideIndex: number\n  stepIndex: number\n  setSlideAndStep?: (slideIndex: number, stepIndex: number) => void\n}\n\ntype EmbedRenderFunc = (arg: {\n  slideIndex: number\n  stepIndex: number\n  slidesInfo: SlidesInfo\n  presentation: React.ReactElement\n  next: (skip: boolean) => void\n  prev: (skip: boolean) => void\n}) => React.ReactElement\n\nexport type PresentationProps = {\n  children: React.ReactNode\n  bibUrl?: string\n  compileHost?: string\n  preamble?: string\n  embed?: boolean\n  embedOptions?: {\n    stepIndex: number\n    slideIndex: number\n    render: EmbedRenderFunc\n  }\n}\n\nexport type RenderFunc = {\n  render: PresentationRenderFunction\n}\n\nexport type Mode = {\n  mode: 'embed' | 'edit' | 'presenter' | 'fullscreen'\n}\n\n/* global localStorage */\nexport function RenderPresentation({\n  ...props\n}: PresentationProps & RenderFunc): React.ReactElement {\n  if (props.embed) {\n    return <PresentationEmbedWrapper {...props} />\n  }\n\n  return (\n    <Router>\n      <Switch>\n        <Route exact path='/storage'>\n          <Storage />\n        </Route>\n\n        <Route path='/presenter/:slideIndex?/:stepIndex?'>\n          <PresentationRouteWrapper {...props} mode='presenter' />\n        </Route>\n        <Route path='/fullscreen/:slideIndex?/:stepIndex?'>\n          <PresentationRouteWrapper {...props} mode='fullscreen' />\n        </Route>\n        <Route path='/overview'>\n          <PresentationOverview {...props} />\n        </Route>\n        <Route path='/:slideIndex?/:stepIndex?' exact={false}>\n          <PresentationRouteWrapper {...props} mode='edit' />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nfunction PresentationEmbedWrapper({\n  ...props\n}: PresentationProps & RenderFunc) {\n  const [slideIndex, setSlideIndex] = useState(props?.embedOptions?.slideIndex)\n  const [stepIndex, setStepIndex] = useState(props?.embedOptions?.slideIndex)\n\n  return (\n    <PresentationUI\n      {...props}\n      mode='embed'\n      stepIndex={stepIndex || 0}\n      slideIndex={slideIndex || 0}\n      setSlideAndStep={(slide, step) => {\n        setSlideIndex(slide)\n        setStepIndex(step)\n      }}\n    />\n  )\n}\n\nfunction PresentationRouteWrapper({\n  ...props\n}: PresentationProps & RenderFunc & Mode): React.ReactElement {\n  const match = useRouteMatch()\n  const history = useHistory()\n\n  const setSlideAndStep = (\n    slideIndex: number,\n    stepIndex: number,\n    notify = true\n  ) => {\n    history.push(generatePath(match.path, { slideIndex, stepIndex }))\n    if (notify) {\n      /* bc.postMessage({ slideIndex, stepIndex }) */\n      try {\n        ws.send(JSON.stringify({ slideIndex, stepIndex }))\n      } catch (e) {\n        console.log('Could not send message to ', ws)\n      }\n    }\n  }\n\n  const ws = useMemo(\n    () => new WebSocket(`ws://${window.location.hostname}:3003`),\n    []\n  )\n  /* const bc = useMemo(() => new BroadcastChannel('presentation'), []) */\n\n  /* bc.onmessage = useCallback((event) => { */\n  /*   setSlideAndStep(event.data.slideIndex, event.data.stepIndex, false) */\n  /* }, []) */\n\n  ws.onmessage = (message) => {\n    try {\n      const { slideIndex, stepIndex } = JSON.parse(message.data)\n      setSlideAndStep(slideIndex, stepIndex, false)\n    } catch (e) {\n      console.log('Could not parse', message.data, e)\n    }\n  }\n\n  const {\n    slideIndex: slideIndexString = '0',\n    stepIndex: stepIndexString = '0'\n  } = useParams<RouteParams>()\n  const slideIndex = parseInt(slideIndexString)\n  const stepIndex = parseInt(stepIndexString)\n\n  return (\n    <PresentationUI\n      {...props}\n      stepIndex={stepIndex}\n      slideIndex={slideIndex}\n      setSlideAndStep={setSlideAndStep}\n    />\n  )\n}\n\nexport const PresentationContext = React.createContext<PresentationContextInterface | null>(\n  null\n)\n\nexport interface PresentationContextInterface {\n  slideIndex: number\n  stepIndex: number\n  i: number\n  slidesInfo: SlidesInfo\n  setTransitions: (arg: any) => void\n  transition: Transition\n}\n\ntype RouteParams = { slideIndex: string; stepIndex: string }\n\ntype Transition = {\n  before?: React.CSSProperties\n  after?: React.CSSProperties\n}\n\nexport type Transitions = {\n  [key: number]: Transition\n}\n\nfunction PresentationUI({\n  children,\n  render,\n  bibUrl,\n  preamble = '',\n  compileHost = '',\n  mode,\n  embedOptions,\n  setSlideAndStep = () => {},\n  slideIndex,\n  stepIndex\n}: PresentationProps & RenderFunc & StepAndSlide & Mode) {\n  const reactSlides = React.Children.toArray(children) as React.ReactElement[]\n  const { slidesInfo, citationMap } = useMemo(\n    () => getSlidesInfo(reactSlides),\n    [children]\n  )\n\n  // TODO: this is used multiple times.\n  // Extract this.\n  useIsomorphicLayoutEffect(() => {\n    LaTeX.setPreamble(preamble)\n    if (compileHost) {\n      console.log('setting host to', compileHost)\n      LaTeX.setHost(compileHost)\n    }\n  }, [])\n\n  const [transitions, setTransitions] = useState<Transitions>({})\n\n  const getNext = (slideIndex: number, stepIndex: number): [number, number] => {\n    if (stepIndex < slidesInfo[slideIndex].steps.length - 1) {\n      return [slideIndex, stepIndex + 1]\n    }\n    if (slideIndex < slidesInfo.length - 1) {\n      return [slideIndex + 1, 0]\n    }\n    return [slideIndex, stepIndex]\n  }\n\n  const getPrev = (slideIndex: number, stepIndex: number): [number, number] => {\n    if (stepIndex > 0) {\n      return [slideIndex, stepIndex - 1]\n    }\n    if (slideIndex > 0) {\n      return [slideIndex - 1, slidesInfo[slideIndex - 1].steps.length - 1]\n    }\n    return [slideIndex, stepIndex]\n  }\n\n  const prev = useCallback(\n    (dontStepButGoToPrevSlide) => {\n      if (dontStepButGoToPrevSlide) {\n        if (slideIndex > 0) {\n          setSlideAndStep(slideIndex - 1, 0)\n        }\n        return\n      }\n      setSlideAndStep(...getPrev(slideIndex, stepIndex))\n    },\n    [slideIndex, stepIndex, setSlideAndStep]\n  )\n\n  const next = useCallback(\n    (dontStepButGoToNextSlide) => {\n      if (dontStepButGoToNextSlide) {\n        if (slideIndex < slidesInfo.length - 1) {\n          setSlideAndStep(slideIndex + 1, 0)\n        }\n      } else {\n        setSlideAndStep(...getNext(slideIndex, stepIndex))\n      }\n    },\n    [slideIndex, stepIndex, setSlideAndStep]\n  )\n\n  const handleKey = useCallback(\n    (e) => {\n      if (e.key === 'ArrowDown') {\n        next(true)\n      }\n      if (e.key === 'ArrowUp') {\n        prev(true)\n      }\n\n      if (e.key === 'PageDown' || e.key === 'ArrowRight') {\n        e.preventDefault()\n        next(false)\n      } else if (e.key === 'PageUp' || e.key === 'ArrowLeft') {\n        e.preventDefault()\n        prev(false)\n      }\n    },\n    [next, prev, stepIndex, slideIndex]\n  )\n\n  useEffect(() => {\n    window.addEventListener('keydown', handleKey)\n    return () => {\n      window.removeEventListener('keydown', handleKey)\n    }\n  }, [handleKey])\n\n  // User supplied slideIndex that is too big, go to last slide/step\n  if (slideIndex >= slidesInfo.length) {\n    setSlideAndStep(\n      slidesInfo.length-1,\n      slidesInfo[slidesInfo.length-1].steps.length-1\n    )\n    return null\n  }\n\n  // User supplied stepIndex that is to big, go to last step.\n  if (stepIndex >= slidesInfo[slideIndex].steps.length){\n    setSlideAndStep(slideIndex, slidesInfo[slideIndex].steps.length-1)\n    return null\n  }\n\n  if (mode === 'presenter') {\n    const slides = [\n      [slideIndex, stepIndex],\n      getNext(slideIndex, stepIndex)\n    ].map(([slideIndex, stepIndex], index) =>\n      render({\n        slideIndex,\n        stepIndex,\n        slidesInfo,\n        slides: [\n          <PresentationContext.Provider\n            key={index}\n            value={{\n              i: slideIndex,\n              slideIndex,\n              slidesInfo,\n              stepIndex,\n              setTransitions: () => undefined,\n              transition: {\n                after: { transform: '' },\n                before: { transform: '' }\n              }\n            }}\n          >\n            {reactSlides[slideIndex]}\n          </PresentationContext.Provider>\n        ]\n      })\n    )\n\n    return (\n      <div className='flex'>\n        <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n          <div className='flex justify-around'>\n            <div className='flex flex-col'>\n              <div>{slides[0]}</div>\n              <div className='text-lg'>\n                <Clock />\n              </div>\n            </div>\n            <div className='flex flex-col'>\n              <div\n                style={{\n                  transform: 'scale(0.5)',\n                  transformOrigin: 'top left',\n                  marginBottom: -450\n                }}\n              >\n                {slides[1]}\n              </div>\n              <div>{slidesInfo[slideIndex].presenterNotes}</div>\n            </div>\n          </div>\n        </CitationProvider>\n      </div>\n    )\n  }\n\n  const wrappedSlides = reactSlides.map((slide, i) => {\n    return (\n      <PresentationContext.Provider\n        key={i}\n        value={{\n          i,\n          slideIndex,\n          slidesInfo: slidesInfo,\n          stepIndex:\n            i === slideIndex\n              ? stepIndex\n              : i < slideIndex && slidesInfo[i].steps.length\n              ? slidesInfo[i].steps.length - 1\n              : 0,\n          setTransitions,\n          transition: transitions[i]\n        }}\n      >\n        {slide}\n      </PresentationContext.Provider>\n    )\n  })\n\n  const threeSlides = wrappedSlides.slice(\n    Math.max(0, slideIndex - 1),\n    Math.min(wrappedSlides.length, slideIndex + 2)\n  )\n\n  if (mode === 'fullscreen') {\n    return (\n      <div className='flex justify-center items-center bg-white h-screen'>\n        <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n          {render({\n            slideIndex,\n            stepIndex,\n            slidesInfo,\n            slides: threeSlides\n          })}\n        </CitationProvider>\n      </div>\n    )\n  }\n\n  if (mode === 'embed') {\n    if (!embedOptions?.render) {\n      return <div>Specify embed render function</div>\n    }\n    return embedOptions.render({\n      next,\n      prev,\n      slideIndex,\n      slidesInfo,\n      stepIndex,\n      presentation: (\n        <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n          {render({\n            slideIndex,\n            stepIndex,\n            slidesInfo,\n            slides: threeSlides\n          })}\n        </CitationProvider>\n      )\n    })\n  }\n\n  return (\n    <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n      <div className='flex h-screen bg-gray-100 items-center pl-2'>\n        {render({\n          slideIndex,\n          stepIndex,\n          slidesInfo,\n          slides: threeSlides\n        })}\n        <Tabs>\n          <Tab label='Presenter notes'>\n            {slidesInfo[slideIndex].presenterNotes ? (\n              <div className='text-sm p-2'>\n                {slidesInfo[slideIndex].presenterNotes}\n              </div>\n            ) : (\n              <div className='text-gray-500 text-sm m-2 text-center'>\n                no presenter notes\n              </div>\n            )}\n          </Tab>\n          <Tab label='Animation editor'>\n            {slidesInfo[slideIndex].animations.length ? (\n              <AnimationEditor animations={slidesInfo[slideIndex].animations} />\n            ) : (\n              <div className='text-gray-500 text-sm m-2 text-center'>\n                no animations\n              </div>\n            )}\n          </Tab>\n        </Tabs>\n      </div>\n    </CitationProvider>\n  )\n}\n\nfunction Tabs({ children }: { children: React.ReactNode }) {\n  return (\n    <div className='text-gray-800 w-full h-screen overflow-y-scroll ml-2'>\n      {children}\n    </div>\n  )\n}\n\nfunction Tab({\n  label,\n  children\n}: {\n  label: string\n  children: React.ReactNode\n}) {\n  const [show, setShow] = useState(true)\n  if (!children) return null\n  return (\n    <div className='w-full'>\n      <div\n        className='p-1 px-2 font-bold cursor-pointer sticky top-0 z-50'\n        onClick={() => setShow((s) => !s)}\n      >\n        {label}\n      </div>\n      {show && <div>{children}</div>}\n    </div>\n  )\n}\n\nfunction Clock(): React.ReactElement {\n  return <div className='flex justify-center items-center'>20:00</div>\n}\n\nfunction PresentationOverview({\n  children,\n  render,\n  bibUrl,\n  preamble = '',\n  compileHost\n}: PresentationProps & RenderFunc): React.ReactElement {\n  useIsomorphicLayoutEffect(() => {\n    LaTeX.setPreamble(preamble)\n    if (compileHost) {\n      LaTeX.setHost(compileHost)\n    }\n  }, [preamble])\n\n  const reactSlides = React.Children.toArray(children) as React.ReactElement[]\n\n  const { slidesInfo, citationMap } = useMemo(\n    () => getSlidesInfo(reactSlides),\n    [children]\n  )\n\n  return (\n    <div>\n      <CitationProvider citationMap={citationMap} bibUrl={bibUrl}>\n        {slidesInfo.flatMap((info, slideIndex) => {\n          return info.steps.map((_step: any, stepIndex) => {\n            return (\n              <div key={`${slideIndex}-${stepIndex}`}>\n                {render({\n                  slidesInfo,\n                  slideIndex,\n                  stepIndex,\n                  slides: [\n                    <PresentationContext.Provider\n                      key={slideIndex}\n                      value={{\n                        slidesInfo,\n                        stepIndex,\n                        slideIndex,\n                        i: slideIndex,\n                        setTransitions: () => null,\n                        transition: {\n                          before: {},\n                          after: {}\n                        }\n                      }}\n                    >\n                      {reactSlides[slideIndex]}\n                    </PresentationContext.Provider>\n                  ]\n                })}\n              </div>\n            )\n          })\n        })}\n      </CitationProvider>\n    </div>\n  )\n}\n\ntype SlideProps = {\n  render: SlideRenderFunction\n  steps?: any[]\n  children: React.ReactNode\n}\n\ntype SlideRenderFunction = (arg: {\n  slidesInfo: SlidesInfo\n  children: React.ReactNode | ((step: any) => React.ReactNode)\n  slideIndex: number\n  i: number\n  style: React.CSSProperties\n}) => React.ReactElement\n\nconst hasSteps = (node: any): node is (step: any) => React.ReactNode =>\n  node.call\n\n// Add timeline ={{ ... }} shorthand\nexport function RenderSlide({\n  children,\n  steps = [],\n  render\n}: SlideProps): React.ReactElement {\n  const TIMING = 0.5\n  const { stepIndex = 0, i = 0, slideIndex = 0, transition, slidesInfo = [] } =\n    useContext(PresentationContext) || {}\n\n  const [style, setStyle] = useState<React.CSSProperties>({\n    transition: `${TIMING}s transform, ${TIMING}s opacity`,\n    transform: 'scale(1) translate3d(0px, 0px, 0px)',\n    opacity: 0\n  })\n\n  const updateStyle = (style: React.CSSProperties) =>\n    setStyle((s) => ({ ...s, ...style }))\n\n  // delay rendering\n  // const [shouldRender, setRender] = useState(false)\n  // useEffect(() => {\n  //   setTimeout(() => setRender(true), 500)\n  // }, [])\n\n  useEffect(() => {\n    const {\n      after = {\n        transform: `translate3d(-100%, 0px, 0px)`,\n        opacity: 0,\n        zIndex: 0\n      },\n      before = {\n        transform: `translate3d(100%, 0px, 0px)`,\n        opacity: 0,\n        zIndex: 0\n      }\n    } = transition || {}\n\n    if (i > slideIndex) {\n      updateStyle({ ...before })\n    }\n    if (i < slideIndex) {\n      updateStyle({ ...after })\n    }\n    if (i === slideIndex) {\n      updateStyle({\n        zIndex: 10,\n        opacity: 1,\n        transform: `scale(1) translate3d(0px,0px,0px)`\n      })\n    }\n  }, [slideIndex, i, transition])\n\n  // if (shouldRender) {\n  const content =\n    children && (hasSteps(children) ? children(steps[stepIndex]) : children)\n  return render({ slidesInfo, children: content, i, slideIndex, style })\n  // }\n  // return render({info, content: <div />, i, slideIndex, style});\n}\n\nfunction Storage(): React.ReactElement {\n  return (\n    <pre\n      style={{\n        whiteSpace: 'break-spaces'\n      }}\n    >\n      {localStorage.animationGroups}\n    </pre>\n  )\n}\n","import React from 'react'\n\ntype ShowProps = {\n  when: boolean\n  children: React.ReactNode\n  opacity?: number\n}\nexport default function Show({\n  when,\n  children,\n  opacity\n}: ShowProps): React.ReactElement {\n  const realStyle: React.CSSProperties = {\n    opacity: opacity !== undefined ? opacity : when ? 1 : 0,\n    transition: '0.5s opacity ease-in-out'\n  }\n\n  return (\n    // TODO: props don't get correctly cloned?\n    <React.Fragment>\n      {React.Children.map(children, (c: React.ReactNode) => {\n        if (React.isValidElement(c)) {\n          return React.cloneElement(c, {\n            ...(c.props || {}),\n            style: {\n              ...(c?.props?.style || {}),\n              ...realStyle\n            }\n          })\n        } else {\n          return <span style={realStyle}>{c}</span>\n        }\n      })}\n    </React.Fragment>\n  )\n}\n\n// TODO: Animate height of an element\n// export function Grow({when, children, opacity}) {\n","import React, { Fragment, useState, useEffect, useRef, useContext } from 'react'\n\nimport {\n  RenderSlide,\n  RenderPresentation,\n  PresentationContext,\n  PresentationProps\n} from '../../Presentation'\nimport { RenderCite, RenderBibliography } from '../../Citations'\n\nimport Show from '../../Show'\n\nimport { SlideInfo } from '../../staticAnalysis'\n\n// import sedes from './kuleuvensedes.svg'\n/* import pointer from './pointer.png' */\n//\nimport './styles.css'\n\nimport step from '../../step.macro.js'\nimport { range } from '../../utils.js'\n\nexport function Presentation(props: PresentationProps): React.ReactElement {\n  const h = 900\n  const w = 1200\n  return (\n    <RenderPresentation\n      {...props}\n      render={({ slides, slideIndex, slidesInfo }) => {\n        const info = slidesInfo[slideIndex].info\n        return (\n          <div\n            className='presentation inline-block relative flex-shrink-0 flex flex-col text-white bg-blue'\n            style={{\n              overflow: 'hidden',\n              fontFamily: 'Computer Modern Sans',\n              width: w,\n              height: h\n              // border: '1px solid white'\n            }}\n          >\n            <div className='flex-grow relative'>{slides}</div>\n            <div\n              className='flex flex-col'\n              style={{\n                transition: '0.5s transform',\n                transform: `translate(0px, ${info.hideNavigation ? 100 : 0}%)`\n              }}\n            >\n              <div className='flex justify-between text-xs theme-font-open'>\n                <div className='px-2 py-1'>\n                  {info.sectionSlide ? '\\xa0' : info.section}\n                </div>\n                <div className='px-2 py-1'>{slideIndex + 1}</div>\n              </div>\n              <div className='w-full inline-block' style={{ height: 2 }}>\n                <div\n                  className='h-full bg-green'\n                  style={{\n                    width: `${(slideIndex / (slidesInfo.length - 1)) * 100}%`,\n                    transition: 'width 0.5s'\n                  }}\n                />\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\n/* export function MousePointer(): React.ReactElement { */\n/*   const [position, setPosition] = useState({ x: 0, y: 0 }) */\n/*   const [hidden, setHidden] = useState(true) */\n/*   const currentTimer = useRef(null) */\n/*   useEffect(() => { */\n/*     const setFromEvent = (e: MouseEvent) => { */\n/*       setHidden(false) */\n/*       clearTimeout(currentTimer.current) */\n/*       currentTimer.current = setTimeout(() => setHidden(true), 1000) */\n/*       setPosition({ x: e.clientX, y: e.clientY }) */\n/*     } */\n/*     window.addEventListener('mousemove', setFromEvent) */\n/*     return () => { */\n/*       window.removeEventListener('mousemove', setFromEvent) */\n/*     } */\n/*   }, []) */\n/*   const { x, y } = position */\n/*   const width = 8 */\n/*   const height = 8 */\n/*   return ( */\n/*     <img */\n/*       alt='' */\n/*       width={width} */\n/*       height={height} */\n/*       src={pointer} */\n/*       style={{ */\n/*         display: hidden ? 'none' : 'inline', */\n/*         position: 'fixed', */\n/*         left: 0, */\n/*         top: 0, */\n/*         zIndex: 10, */\n/*         pointerEvents: 'none', */\n/*         transform: `translate(${x - width / 2}px, ${y - height / 2}px)` */\n/*       }} */\n/*     /> */\n/*   ) */\n/* } */\n\nexport function Slide({\n  className,\n  children,\n  style: slideStyle,\n  ...props\n}: {\n  className?: string\n  children: React.ReactNode\n  style?: React.CSSProperties\n  [key: string]: any\n}): React.ReactElement {\n  return (\n    <RenderSlide\n      children={children}\n      {...props}\n      render={({ slidesInfo, children, i, style }) => {\n        const info = slidesInfo[i].info\n        return (\n          <div\n            className='slide'\n            style={{\n              position: 'absolute',\n              left: 0,\n              top: 0,\n              bottom: 0,\n              right: 0,\n              ...style\n            }}\n          >\n            <div className='absolute inset-0 flex flex-col'>\n              {info.header && (\n                <div className='ml-6 mt-6 text-white font-semibold text-2xl flex items-center theme-font-open'>\n                  <span\n                    style={{\n                      height: '2em',\n                      width: '4px',\n                      marginRight: '1em',\n                      background: '#00D56F',\n                      borderRadius: '2px'\n                    }}\n                  />\n                  {info.header}\n                </div>\n              )}\n              <div className={`flex-grow p-6 ${className}`} style={slideStyle}>\n                {children}\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\nexport function SectionSlide({\n  section,\n  children\n}: {\n  section: string\n  children: React.ReactNode\n}): React.ReactElement {\n  const { i = 0, slidesInfo = [] } = useContext(PresentationContext) || {}\n  const numSlides = slidesInfo.length\n  return (\n    <Slide\n      className='flex justify-center items-center text-3xl theme-font-open'\n      hideNavigation\n    >\n      <div>\n        <div>{section}</div>\n        <div\n          className='mt-3'\n          style={{\n            background: 'rgba(255, 255, 255, 0.2)',\n            width: '16em',\n            height: '4px',\n            borderRadius: '2px'\n          }}\n        >\n          <div\n            className='h-full bg-green'\n            style={{\n              width: `${(i / (numSlides - 1)) * 100}%`,\n              borderRadius: '2px'\n            }}\n          />\n        </div>\n      </div>\n      {children}\n    </Slide>\n  )\n}\n\n// TOCO conclusion slide should clear section ...\nexport function ConclusionSlide({\n  section,\n  children\n}: {\n  section: string\n  children: React.ReactNode\n}): React.ReactElement {\n  return (\n    <Slide\n      hideNavigation\n      className='flex justify-center items-center text-3xl theme-font-open'\n    >\n      <div>\n        <div>{section}</div>\n        <div\n          className='bg-gray-300 mt-3'\n          style={{\n            width: '16em',\n            height: '4px'\n          }}\n        >\n          <div\n            className='h-full bg-green'\n            style={{\n              width: `100%`\n            }}\n          />\n        </div>\n      </div>\n      {children}\n    </Slide>\n  )\n}\n\nexport function TitleSlide({\n  title,\n  names,\n  names2,\n  date,\n  children\n}: {\n  title: React.ReactNode\n  subtitle: React.ReactNode\n  names: React.ReactNode\n  names2: React.ReactNode\n  date: React.ReactNode\n  children: React.ReactNode\n}): React.ReactElement {\n  return (\n    <Slide\n      className='flex flex-col items-stretch justify-between theme-font-open'\n      steps={[0, 1, 2]}\n      hideNavigation\n    >\n      {(step: number) => (\n        <Fragment>\n          <div className='flex-grow flex flex-col justify-center'>\n            <Show when={step > 0}>\n              <h1 className='text-4xl font-semibold text-green'>{title}</h1>\n            </Show>\n          </div>\n          <Show when={step > 1}>\n            <div className='text-sm flex items-end justify-between'>\n              <div>\n                <div>{names}</div>\n                <div>{names2}</div>\n              </div>\n              <div>{date}</div>\n            </div>\n          </Show>\n          {children}\n        </Fragment>\n      )}\n    </Slide>\n  )\n}\n\nexport function TableOfContentsSlide({\n  header,\n  children\n}: {\n  header: React.ReactNode\n  children: React.ReactNode\n}): React.ReactElement {\n  const { slidesInfo = [] } = useContext(PresentationContext) || {}\n\n  const sections: string[] = slidesInfo\n    .map((i) => i.info.section)\n    .filter(Boolean)\n    .filter((v, i, a) => a.indexOf(v) === i)\n\n  return (\n    <Slide\n      hideNavigation\n      header={header}\n      steps={sections.map((_, i) => i)}\n      className='flex items-start'\n    >\n      {(step: number) => (\n        <React.Fragment>\n          <ol>\n            {sections.map((section: string, i: number) => (\n              <Show key={section} when={step >= i}>\n                <li className='my-5'>{section}</li>\n              </Show>\n            ))}\n          </ol>\n          {children}\n        </React.Fragment>\n      )}\n    </Slide>\n  )\n}\n\nexport function QuestionSlide({\n  title = 'Questions?',\n  children\n}: {\n  title: React.ReactNode\n  children: React.ReactNode\n}): React.ReactElement {\n  return (\n    <Slide\n      className='bg-blue text-gray-100 text-3xl flex items-center justify-center p-0'\n      hideNavigation\n    >\n      {title}\n      {children}\n    </Slide>\n  )\n}\n\n// TODO: svg object fit?\nexport function Figure({\n  children,\n  caption\n}: {\n  children: React.ReactNode\n  caption: React.ReactNode\n}): React.ReactElement {\n  return (\n    <div className='flex flex-col'>\n      <div className='flex-grow'>{children}</div>\n      {caption && (\n        <div className='p-1'>\n          <b>Figure:</b> {caption}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport function List({\n  children,\n  step,\n  ...props\n}: {\n  children: React.ReactNode\n  step: number\n  [key: string]: any\n}): React.ReactElement {\n  const childArray = React.Children.toArray(children)\n  return (\n    <ul {...props}>\n      {childArray.map((child, i) => (\n        <Show key={i} when={i < step || step === undefined}>\n          {child}\n        </Show>\n      ))}\n    </ul>\n  )\n}\n\nexport function Item({\n  children,\n  name,\n  ...props\n}: {\n  children: React.ReactNode\n  name?: React.ReactNode\n  style?: React.CSSProperties\n  [key: string]: any\n}): React.ReactElement {\n  if (name) {\n    return (\n      <li\n        {...props}\n        style={{\n          ...(props.style || {}),\n          listStyle: 'none'\n        }}\n      >\n        <b>{name + ' '}</b>\n        {children}\n      </li>\n    )\n  } else {\n    return <li {...props}>{children}</li>\n  }\n}\n\nexport function Cite({\n  id,\n  hidden\n}: {\n  id: string\n  hidden?: boolean\n}): React.ReactElement {\n  return (\n    <RenderCite\n      id={id}\n      render={({ text, number }) => {\n        if (hidden) return <span />\n        return <span title={text || 'Loading ...'}>[{number || '??'}]</span>\n      }}\n    />\n  )\n}\n\nexport function BibliographySlide(): React.ReactElement {\n  const stride = 4\n  return (\n    <RenderBibliography\n      render={(items) => {\n        return (\n          <Slide steps={range(Math.ceil(items.length / stride))}>\n            {(step: number) => {\n              if (!items) return <div>Loading</div>\n\n              const start = stride * step\n              const end = start + stride\n              return (\n                <ul className='list-none text-sm'>\n                  {items.slice(start, end).map(({ id, n, html }) => {\n                    return (\n                      <li className='flex my-2' key={id}>\n                        <span className='mr-2'>[{n}]</span>\n                        <div className='inline-block'>\n                          <span dangerouslySetInnerHTML={{ __html: html }} />\n                        </div>\n                      </li>\n                    )\n                  })}\n                </ul>\n              )\n            }}\n          </Slide>\n        )\n      }}\n    />\n  )\n}\n\ntype BoxProps = {\n  title?: string\n  children: React.ReactNode\n  className?: string\n  smallTitle?: boolean\n  style?: React.CSSProperties\n}\nexport function Box({\n  title,\n  children,\n  className,\n  smallTitle,\n  style\n}: BoxProps): React.ReactElement {\n  return (\n    <div\n      className={`theme-border theme-shadow ${className || ''}`}\n      style={style}\n    >\n      <div className='p-2'>\n        {title && (\n          <span\n            className={`pr-2 text-green font-semibold ${\n              smallTitle ? 'text-xs block' : ''\n            }`}\n          >\n            {title}.\n          </span>\n        )}\n        {children}\n      </div>\n    </div>\n  )\n}\n\nexport function Qed(\n  props: React.HTMLProps<HTMLDivElement>\n): React.ReactElement {\n  return (\n    <div className='flex justify-end' {...props}>\n      <div className='inline-block w-2 h-2 bg-white m-1' />\n    </div>\n  )\n}\n","import React, { Fragment, useState, useEffect, useRef, useContext } from 'react'\n\nimport {\n  RenderSlide,\n  RenderPresentation,\n  PresentationContext,\n  PresentationProps\n} from '../../Presentation'\nimport { RenderCite, RenderBibliography } from '../../Citations'\n\nimport Show from '../../Show'\n\nimport { SlideInfo } from '../../staticAnalysis'\n\nimport './styles.css'\n\nimport step from '../../step.macro.js'\nimport { range } from '../../utils.js'\n\nexport function Presentation(props: PresentationProps): React.ReactElement {\n  const h = 900\n  const w = 1200\n  return (\n    <RenderPresentation\n      {...props}\n      render={({ slides, slideIndex, slidesInfo }) => {\n        const info = slidesInfo[slideIndex].info\n        return (\n          <div\n            className='presentation inline-block relative flex-shrink-0 flex flex-col text-black'\n            style={{\n              overflow: 'hidden',\n              fontFamily: 'Computer Modern Sans',\n              width: w,\n              height: h\n              // border: '1px solid white'\n            }}\n          >\n            <div className='flex-grow relative'>{slides}</div>\n            <div\n              className='flex flex-col'\n              style={{\n                transition: '0.5s transform',\n                transform: `translate(0px, ${info.hideNavigation ? 100 : 0}%)`\n              }}\n            >\n              <div className='flex justify-end text-xs theme-gray'>\n                <div className='px-2 py-1'>{slideIndex + 1}</div>\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\n/* export function MousePointer(): React.ReactElement { */\n\nexport function Slide({\n  className,\n  children,\n  style: slideStyle,\n  ...props\n}: {\n  className?: string\n  children: React.ReactNode\n  style?: React.CSSProperties\n  [key: string]: any\n}): React.ReactElement {\n  return (\n    <RenderSlide\n      children={children}\n      {...props}\n      render={({ slidesInfo, children, i, style }) => {\n        const info = slidesInfo[i].info\n        return (\n          <div\n            className='slide'\n            style={{\n              position: 'absolute',\n              left: 0,\n              top: 0,\n              bottom: 0,\n              right: 0,\n              ...style\n            }}\n          >\n            <div className='absolute inset-0 flex flex-col'>\n              {info.header && (\n                <div className='ml-6 mt-6 theme-dark-gray font text-2xl flex lucida'>\n                  {typeof info.header == 'string'\n                    ? info.header\n                        .split(/(\\|\\|)/g)\n                        .map((e: string) => (e === '||' ? <br /> : e))\n                    : info.header}\n                </div>\n              )}\n              <div className={`flex-grow p-6 ${className}`} style={slideStyle}>\n                {children}\n              </div>\n            </div>\n          </div>\n        )\n      }}\n    />\n  )\n}\n\nexport function OverviewSlide({\n  image,\n  title,\n  section,\n  children,\n  styles = {\n    title: { color: '#918F90' },\n    section: { color: '#767374' },\n    activeSection: { color: '#E39000' }\n  }\n}: {\n  title?: React.ReactNode\n  image?: React.ReactNode\n  section?: string\n  children?: React.ReactNode\n  styles?: {\n    title?: React.CSSProperties\n    activeSection?: React.CSSProperties\n    section?: React.CSSProperties\n  }\n}): React.ReactElement {\n  const { slidesInfo = [] } = useContext(PresentationContext) || {}\n\n  const sections = slidesInfo\n    .map((i) => [i.info.section, i.info])\n    .filter((v) => !!v[0])\n    .filter((v, i, a) => a.map((w) => w[0]).indexOf(v[0]) === i)\n    .map((v) => v[1])\n\n  title = title || slidesInfo[0].info.title\n  image = image || slidesInfo[0].info.image\n  styles = slidesInfo[0].info.styles || styles\n\n  return (\n    <Slide\n      hideNavigation\n      className='flex flex-col items-stretch lucida'\n      style={{\n        padding: '120px'\n      }}\n    >\n      <div className='flex-grow'>\n        <div style={{ fontSize: '2.5rem', ...styles.title }}>{title}</div>\n      </div>\n      <div className='flex items-stretch'>\n        {image}\n        <div\n          className='ml-10 flex flex-col justify-between'\n          style={{ fontSize: '90%' }}\n        >\n          {sections.map((s) => (\n            <div\n              key={s.section}\n              className='my-2'\n              style={{\n                ...(section && s.section == section\n                  ? styles.activeSection\n                  : styles.section)\n              }}\n            >\n              <span className='inline-block mb-2'>{s.section}</span>\n              <br />\n              <span className='opacity-75'>{s.sectionsubtitle || ''}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n      {children}\n    </Slide>\n  )\n}\n\nexport function QuestionSlide({\n  title = 'Questions?',\n  children\n}: {\n  title: React.ReactNode\n  children: React.ReactNode\n}): React.ReactElement {\n  return (\n    <Slide\n      className='bg-blue text-gray-100 text-3xl flex items-center justify-center p-0'\n      hideNavigation\n    >\n      {title}\n      {children}\n    </Slide>\n  )\n}\n\nexport function List({\n  children,\n  step,\n  ...props\n}: {\n  children: React.ReactNode\n  step: number\n  [key: string]: any\n}): React.ReactElement {\n  const childArray = React.Children.toArray(children)\n  return (\n    <ul {...props}>\n      {childArray.map((child, i) => (\n        <Show key={i} when={i < step || step === undefined}>\n          {child}\n        </Show>\n      ))}\n    </ul>\n  )\n}\n\nexport function Item({\n  children,\n  name,\n  ...props\n}: {\n  children: React.ReactNode\n  name?: React.ReactNode\n  style?: React.CSSProperties\n  [key: string]: any\n}): React.ReactElement {\n  if (name) {\n    return (\n      <li\n        {...props}\n        style={{\n          ...(props.style || {}),\n          listStyle: 'none'\n        }}\n      >\n        <b>{name + ' '}</b>\n        {children}\n      </li>\n    )\n  } else {\n    return <li {...props}>{children}</li>\n  }\n}\n\nexport function Cite({\n  id,\n  hidden\n}: {\n  id: string\n  hidden?: boolean\n}): React.ReactElement {\n  return (\n    <RenderCite\n      id={id}\n      render={({ text, number }) => {\n        if (hidden) return <span />\n        return <span title={text || 'Loading ...'}>[{number || '??'}]</span>\n      }}\n    />\n  )\n}\n\nexport function BibliographySlide(): React.ReactElement {\n  const stride = 4\n  return (\n    <RenderBibliography\n      render={(items) => {\n        return (\n          <Slide steps={range(Math.ceil(items.length / stride))}>\n            {(step: number) => {\n              if (!items) return <div>Loading</div>\n\n              const start = stride * step\n              const end = start + stride\n              return (\n                <ul className='list-none text-sm'>\n                  {items.slice(start, end).map(({ id, n, html }) => {\n                    return (\n                      <li className='flex my-2' key={id}>\n                        <span className='mr-2'>[{n}]</span>\n                        <div className='inline-block'>\n                          <span dangerouslySetInnerHTML={{ __html: html }} />\n                        </div>\n                      </li>\n                    )\n                  })}\n                </ul>\n              )\n            }}\n          </Slide>\n        )\n      }}\n    />\n  )\n}\n\ntype BoxProps = {\n  title?: string\n  children: React.ReactNode\n  className?: string\n  smallTitle?: boolean\n  style?: React.CSSProperties\n}\nexport function Box({\n  title,\n  children,\n  className,\n  smallTitle,\n  style\n}: BoxProps): React.ReactElement {\n  return (\n    <div\n      className={`theme-border theme-shadow ${className || ''}`}\n      style={style}\n    >\n      <div className='p-2'>\n        {title && (\n          <span\n            className={`pr-2 text-green font-semibold ${\n              smallTitle ? 'text-xs block' : ''\n            }`}\n          >\n            {title}.\n          </span>\n        )}\n        {children}\n      </div>\n    </div>\n  )\n}\n\nexport function Qed(\n  props: React.HTMLProps<HTMLDivElement>\n): React.ReactElement {\n  return (\n    <div className='flex justify-end' {...props}>\n      <div className='inline-block w-3 h-3 m-1 border-2 border-black' />\n    </div>\n  )\n}\n","import React, { useEffect, useRef } from 'react'\n\nimport memoize from 'memoizee'\n\nimport { animate } from './lib/morph'\n\nimport gsap from 'gsap'\nimport MorphSVGPlugin from './gsap/MorphSVGPlugin'\nimport DrawSVGPlugin from './gsap/DrawSVGPlugin'\n\ngsap.registerPlugin(MorphSVGPlugin, DrawSVGPlugin)\n\n/* global fetch */\n\nconst positionSvg = (textSvg: SVGElement): void => {\n  // This function posititions the generated svg of some LaTeX code correctly in the parent svg.\n\n  const [, vy, ,] = textSvg\n    .getAttribute('viewBox')!\n    .split(' ')\n    .map((s) => parseFloat(s))\n  const width = parseFloat(textSvg.getAttribute('width')!.replace('pt', ''))\n  const height = parseFloat(textSvg.getAttribute('height')!.replace('pt', ''))\n\n  const {\n    scale: scaleString,\n    textX: textXString,\n    textY: textYString\n  }: {\n    scale?: string\n    textX?: string\n    textY?: string\n  } = textSvg.dataset\n\n  const FONT_SCALING_FACTOR = 2\n  const scale = parseFloat(scaleString || '0')\n  const textX = parseFloat(textXString || '0')\n  const textY = parseFloat(textYString || '0')\n\n  // The (x, y) of the text refers to the text anchor.\n  // The (x, y) of the svg refers to the top left corner\n  // Therefore, as the base line of the svg generated by latex is (0, 0),\n  // we translate the svg by vy, keeping in mind the SCALE and the conversion between px and pt (*1.3)\n\n  textSvg.dataset.scale = String(scale)\n\n  textSvg.setAttribute('x', textX + 'px')\n  textSvg.setAttribute(\n    'y',\n    textY + FONT_SCALING_FACTOR * scale * vy * 1.3 + 'px'\n  )\n  textSvg.setAttribute('width', FONT_SCALING_FACTOR * scale * width + 'pt')\n  textSvg.setAttribute('height', FONT_SCALING_FACTOR * scale * height + 'pt')\n}\n\nconst replaceText = async (textEle: SVGGraphicsElement) => {\n  const text = textEle.textContent\n  if (!text) return\n\n  const textSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n\n  // To make all text properly sized, we calculate the transformation matrix of the element.\n  // It is very important that the element is in the DOM (see (1))\n  // Otherwise, getScreenCTM returns null\n  const matrix = textEle.getScreenCTM()\n\n  if (!matrix) return\n\n  // Then we undo the scaling We're only using `a`, so we're assuming that the element is not skewed and scale uniformly ...\n  // FIXME later?\n  // a c e\n  // b d f\n  // 0 0 1\n\n  const scale = 1 / matrix.a\n\n  textSvg.dataset.textX = textEle.getAttribute('x') || undefined\n  textSvg.dataset.textY = textEle.getAttribute('y') || undefined\n  textSvg.dataset.scale = String(scale)\n  textSvg.id = textEle.id\n\n  // Finally, we replace the text node with the svg.\n  textEle.parentNode!.replaceChild(textSvg, textEle)\n\n  await animate(textSvg, text, true, 0, ({ width, height, viewBox }) => {\n    textSvg.setAttribute('width', width + 'pt')\n    textSvg.setAttribute('height', height + 'pt')\n    textSvg.setAttribute('viewBox', viewBox.join(' '))\n    positionSvg(textSvg)\n  })\n}\n\nconst TIMING = 0.4\n\n// make awaitable?\nfunction update(\n  wrapper: HTMLDivElement,\n  step: any,\n  replaceImediately: boolean\n) {\n  for (const key in step) {\n    if (step[key] === null || step[key] === undefined) {\n      continue\n    }\n    if (key.startsWith('text:')) {\n      const id = key.replace(/^text:/, '')\n      const textSvg = wrapper.querySelector(`svg#${id}`) as SVGSVGElement\n      if (textSvg) {\n        if (replaceImediately) {\n          // remove the placeholder of the text\n          textSvg.innerHTML = ''\n        }\n        // TODO: use that animation groups database!\n        animate(\n          textSvg,\n          step[key] || '',\n          replaceImediately,\n          0.3,\n          ({ width, height, viewBox }) => {\n            textSvg.setAttribute('width', width + 'pt')\n            textSvg.setAttribute('height', height + 'pt')\n            textSvg.setAttribute('viewBox', viewBox.join(' '))\n            positionSvg(textSvg)\n          }\n        )\n      }\n    } else {\n      const ele = wrapper.querySelector(`#${key}`) as SVGElement\n      const { css = {}, ...rest } = step[key]\n      if (ele) {\n        for (const key in css) {\n          ele.style[key as any] = (css as { [index: string]: any })[key]\n        }\n\n        if (replaceImediately) {\n          gsap.set(ele, { ...rest })\n        } else {\n          console.log('timing is ', rest.seconds, TIMING)\n          gsap.to(ele, {\n            duration: rest.seconds || TIMING,\n            ...rest\n          })\n        }\n      }\n    }\n  }\n}\n\n// Cache the images\nconst memoizedFetch = memoize(\n  (src: string): Promise<string> => fetch(src).then((r) => r.text())\n)\n\nexport type AnimateSVGStep = {\n  css?: React.CSSProperties\n  [key: string]: any\n}\n\ntype AnimateSVGProps = {\n  src: string\n  step: AnimateSVGStep\n  width: string | number\n  height: string | number\n  style: React.CSSProperties\n  className: string\n}\n\nfunction AnimateSVG({\n  src,\n  step = {},\n  width = '100%',\n  height = 'auto',\n  style = {},\n  className = ''\n}: AnimateSVGProps): React.ReactElement {\n  const element = useRef<HTMLDivElement | null>(null)\n  useEffect(() => {\n    ;(async () => {\n      // Load the svg\n      const text = await memoizedFetch(src.startsWith('/') ? src : '/' + src)\n      const div = element.current\n      if (!div) return\n\n      // (1)\n      div.innerHTML = text\n      div.querySelector('svg')!.style.opacity = '0'\n      div.querySelector('svg')!.style.width = width as string\n      div.querySelector('svg')!.style.height = height as string\n\n      // Replace text\n      await Promise.all(\n        Array.from(div.querySelectorAll('text')).map(async (textEle) => {\n          if (\n            textEle.matches('.dont-replace *') ||\n            textEle.matches('.ignore-latex *')\n          ) {\n            return\n          }\n\n          // Simply <text></text>\n          if (textEle.children.length === 0) {\n            await replaceText(textEle)\n          } else {\n            // Text of the form <text><tspan></tspan> ... <tspan></tspan></text>\n            const g = document.createElementNS(\n              'http://www.w3.org/2000/svg',\n              'g'\n            )\n\n            // replace text\n            await Promise.all(\n              Array.from(textEle.children).map((el) =>\n                replaceText(el as SVGGraphicsElement)\n              )\n            )\n            // Put the svgs from the replaced text in a group\n            Array.from(textEle.children).forEach((e) => g.appendChild(e))\n\n            // Replace <text><tspan/><tspan/>...</text> element with <g><svg/><svg/>...</g>\n            textEle.parentNode!.replaceChild(g, textEle)\n          }\n        })\n      )\n\n      // Set the correct opacity, ... of the elements\n      if (element.current) {\n        update(element.current, step, true)\n      }\n\n      // Fade in the picture\n      div.querySelector('svg')!.style.transition = '0.3s opacity'\n      div.querySelector('svg')!.style.opacity = '1'\n    })()\n  }, [element.current])\n\n  // When the step changes, animate the new opacities\n  useEffect(() => {\n    if (!element.current) return\n\n    update(element.current, step, false)\n  }, [step, element])\n\n  return <div style={style} className={className} ref={element} />\n}\n\nexport default AnimateSVG\n","import React from 'react'\n\nimport Morph from './Morph'\n\nexport function InlineMath({\n  children,\n  ...props\n}: {\n  children: string\n  [key: string]: any\n}): React.ReactElement {\n  return (\n    <Morph inline replace {...props}>\n      {children}\n    </Morph>\n  )\n}\n\nexport function DisplayMath({\n  children,\n  ...props\n}: {\n  children: string\n  [key: string]: any\n}): React.ReactElement {\n  return (\n    <Morph display replace {...props}>\n      {children}\n    </Morph>\n  )\n}\n\nexport const m = (\n  template: TemplateStringsArray,\n  ...subtitutions: any[]\n): React.ReactElement => (\n  <InlineMath>{String.raw(template, ...subtitutions)}</InlineMath>\n)\nexport const M = (\n  template: TemplateStringsArray,\n  ...subtitutions: any[]\n): React.ReactElement => (\n  <DisplayMath>{String.raw(template, ...subtitutions)}</DisplayMath>\n)\n","import React, { useEffect, useState } from 'react'\n\ntype Size = {\n  width: number\n  height: number\n}\n// TODO: rename this\nfunction measureText(text: string, style: React.CSSProperties = {}): Size {\n  const div = document.createElement('div')\n\n  document.body.appendChild(div)\n  div.style.position = 'absolute'\n  div.style.left = '-1000'\n  div.style.top = '-1000'\n  for (const key in style) {\n    div.style[key as any] = (style as { [index: string]: any })[key]\n  }\n\n  // TODO: this assumes text!\n  div.innerHTML = text\n\n  const result = {\n    width: div.clientWidth,\n    height: div.clientHeight\n  }\n\n  document.body.removeChild(div)\n\n  return result\n}\n\nfunction MObject({ children }: { children: string }): React.ReactElement {\n  const [child, setChild] = useState<string | null>(null)\n  const [opacity, setOpacity] = useState<number>(1)\n  const [width, setWidth] = useState<number>(0)\n\n  useEffect(() => {\n    setOpacity(0)\n    setWidth(measureText(children).width)\n    setTimeout(() => setChild(children), 500)\n    setTimeout(() => setOpacity(1), 500)\n  }, [children])\n\n  return (\n    <div\n      style={{\n        opacity,\n        display: 'inline-block',\n        transition: '0.5s opacity, 0.7s width',\n        width: width,\n        overflow: 'hidden',\n        verticalAlign: 'top'\n      }}\n    >\n      {child}\n    </div>\n  )\n}\n\nexport default MObject\n","// MAYBE try to apply this to make it more smooth?\n// https://aerotwist.com/blog/flip-your-animations/\n// Also: web animation api might be useful?\n\nimport React, { useRef, useEffect, useContext } from 'react'\n\nimport useResizeObserver from 'use-resize-observer'\n\nimport {\n  PresentationContext,\n  PresentationContextInterface,\n  Transitions\n} from './Presentation'\n\ntype Rect = {\n  left: number\n  top: number\n  width: number\n  height: number\n  parentWidth: number\n  parentHeight: number\n}\n\ntype Portal = {\n  zoom: 'in' | 'out' | null\n  rect: Rect\n}\n\nfunction getRect(element: HTMLElement): Rect {\n  let el = element\n  let offsetLeft = 0\n  let offsetTop = 0\n\n  do {\n    offsetLeft += el.offsetLeft // + el.clientLeft;\n    offsetTop += el.offsetTop // + el.clientTop;\n\n    el = el.offsetParent as HTMLElement\n  } while (!el.classList.contains('slide'))\n  return {\n    left: offsetLeft,\n    top: offsetTop,\n    width: element.offsetWidth,\n    height: element.offsetHeight,\n    parentWidth: el.offsetWidth,\n    parentHeight: el.offsetHeight\n  }\n}\n\nconst addPortal = (\n  { i, setTransitions }: PresentationContextInterface,\n  portal: Portal\n): void => {\n  const {\n    rect: { width, height, left, top, parentWidth, parentHeight }\n  } = portal\n  const sx = parentWidth / width\n  const sy = parentHeight / height\n\n  const s = Math.max(sx, sy)\n\n  const x = left\n  const y = top\n\n  const enlarge: React.CSSProperties = {\n    transformOrigin: `${x + width / 2}px ${y + height / 2}px`,\n    transform: `translate3d(${-(x + width / 2) + parentWidth / 2}px, ${\n      -(y + height / 2) + parentHeight / 2\n    }px, 0px) scaleX(${s}) scaleY(${s})`,\n    opacity: 0\n  }\n\n  const shrink: React.CSSProperties = {\n    transformOrigin: `${parentWidth / 2}px ${parentHeight / 2}px`,\n    transform: `translate3d(${-parentWidth / 2 + x + width / 2}px, ${\n      -parentHeight / 2 + y + height / 2\n    }px, 0px) scaleX(${1 / s}) scaleY(${1 / s})`,\n    opacity: 0\n  }\n\n  setTransitions(\n    (transitions: Transitions): Transitions => {\n      const newTransitions = { ...transitions }\n      if (portal.zoom === 'in') {\n        newTransitions[i] = {\n          ...(newTransitions[i] || {}),\n          after: enlarge\n        }\n        newTransitions[i + 1] = {\n          ...(newTransitions[i + 1] || {}),\n          before: shrink\n        }\n      }\n\n      // Problem: if out and in: current transformOrigin gets set twice!\n      // FIXME\n      if (portal.zoom === 'out') {\n        newTransitions[i - 1] = {\n          ...(newTransitions[i - 1] || {}),\n          after: shrink\n        }\n        newTransitions[i] = {\n          ...(newTransitions[i] || {}),\n          before: enlarge\n        }\n      }\n      return newTransitions\n    }\n  )\n}\n\ntype PortalProps = {\n  children: React.ReactNode\n  zoomin?: boolean\n  zoomout?: boolean\n  [key: string]: any\n}\n\nexport default function Portal({\n  children,\n  zoomin,\n  zoomout,\n  className = '',\n  ...props\n}: PortalProps): React.ReactNode {\n  const context = useContext(PresentationContext)\n  const zoom = zoomin ? 'in' : zoomout ? 'out' : null\n\n  const ref = useRef<HTMLDivElement | null>(null)\n  useResizeObserver({\n    ref,\n    onResize: () => {\n      if (!zoom) return\n      if (!ref.current) return\n      if (!context) return\n      const rect = getRect(ref.current)\n      addPortal(context, { zoom, rect })\n    }\n  })\n\n  return (\n    <div className={`inline-block ${className}`} ref={ref} {...props}>\n      {children}\n    </div>\n  )\n}\n","import { range } from './utils'\n\ninterface Timeline {\n  (strings: TemplateStringsArray, ...subs: any[]): { [key: string]: any }[]\n  abbreviations: { [key: string]: any }\n}\n\n// https://stackoverflow.com/questions/12766528/build-a-function-object-with-properties-in-typescript#41853194\n\n// interna\nexport const _internalTimeline = (\n  strings: TemplateStringsArray,\n  ...subs: any[]\n): {\n  output: { [key: string]: any }[]\n  [key: string]: any\n} => {\n  const defaultAbbreviations = timeline.abbreviations\n\n  const translate = (sub: any) => (s: string | number): any =>\n    Object.prototype.hasOwnProperty.call(sub, s)\n      ? sub[s]\n      : Object.prototype.hasOwnProperty.call(defaultAbbreviations, s)\n      ? defaultAbbreviations[s]\n      : s\n\n  const fillWithLastUntilHasLength = (array: any[], length: number) => {\n    const last = array[array.length - 1]\n    return [\n      ...array,\n      ...Array.from({ length: length - array.length }).map(() => last)\n    ]\n  }\n\n  const lines = strings.flatMap((part, i) => {\n    const lines = part.split('\\n').filter((line) => line.trim() !== '')\n    if (lines.length === 0) return []\n    const firsts = lines.slice(0, lines.length - 1)\n    const last = lines[lines.length - 1]\n\n    return [\n      ...firsts.map((l) => ({ text: l, sub: {} })),\n      { text: last, sub: subs[i] }\n    ]\n  })\n\n  const charactersInterpreted = lines\n    .map(({ text, sub }) => {\n      const trimmed = text.trim()\n      const splitted = trimmed.split(/\\s+(.+)/)\n\n      return {\n        label: splitted[0],\n        text: splitted[1],\n        sub: sub\n      }\n    })\n    .map(({ label, sub, text }) => {\n      const numbers: (string | number | number[])[] = []\n      let number = 0\n\n      text.split('').forEach((step, i) => {\n        const prev = numbers[numbers.length - 1]\n        const nextChar = text[i + 1]\n\n        if (step === ' ') {\n          numbers.push(prev)\n          return\n        }\n        if (step === '+' || step === '-') {\n          if (step === '+') {\n            number += 1\n          } else {\n            number -= 1\n          }\n          numbers.push(number)\n          return\n        }\n\n        if (step === '.') {\n          if (Array.isArray(prev)) {\n            throw new Error(\n              'Cannot use a dot . in a timeline specification immediately following another dot'\n            )\n          }\n          if (typeof prev === 'string') {\n            throw new Error(\n              'Cannot use a dot . if it is surrounded by non-numbers'\n            )\n          }\n          if (isNaN(prev)) return\n\n          let to\n          if (nextChar && !isNaN(parseInt(nextChar))) {\n            to = parseInt(nextChar)\n          } else {\n            to = sub.length\n          }\n\n          const rangeInBetween = range(to - prev - 1).map((n) => n + prev + 1)\n\n          if (rangeInBetween.length === 0) {\n            numbers.push(prev)\n            return\n          }\n\n          numbers.push(rangeInBetween)\n          return\n        }\n\n        const n = parseInt(step)\n        if (!isNaN(n)) {\n          number = n\n          numbers.push(number)\n          return\n        }\n        numbers.push(step)\n      })\n      return { label, numbers, sub, text }\n    })\n\n  const numberOfUnexpandedSteps = Math.max(\n    ...charactersInterpreted.map((obj) => obj.numbers.length)\n  )\n\n  const getLength = (index: number) =>\n    Math.max(\n      ...charactersInterpreted.map(({ numbers }) => {\n        const element = numbers[index]\n        if (Array.isArray(element)) {\n          return element.length\n        } else {\n          return 1\n        }\n      })\n    )\n\n  const expanded = charactersInterpreted.map(({ label, numbers, sub }) => {\n    const expandedSteps = range(numberOfUnexpandedSteps).flatMap((index) => {\n      const length = getLength(index)\n\n      let numberOrNumbers\n\n      if (numbers[index] !== undefined) {\n        numberOrNumbers = numbers[index]\n      } else {\n        const last = numbers[numbers.length - 1]\n        if (Array.isArray(last)) {\n          numberOrNumbers = last[last.length - 1]\n        } else {\n          numberOrNumbers = last\n        }\n      }\n\n      if (Array.isArray(numberOrNumbers)) {\n        return fillWithLastUntilHasLength(numberOrNumbers, length)\n      } else {\n        return fillWithLastUntilHasLength([numberOrNumbers], length)\n      }\n    })\n\n    return {\n      label,\n      expandedSteps,\n      translated: expandedSteps.map(translate(sub || {}))\n    }\n  })\n\n  const output = range(expanded[0].translated.length).map((stepIndex) => {\n    return Object.fromEntries(\n      expanded.map(({ label, translated }) => [label, translated[stepIndex]])\n    )\n  })\n\n  return {\n    charactersInterpreted,\n    expanded,\n    output,\n    numberOfUnexpandedSteps,\n    lengths: range(numberOfUnexpandedSteps).map((_, i) => getLength(i))\n  }\n}\n\nexport const timeline: Timeline = Object.assign(\n  (strings: TemplateStringsArray, ...subs: any[]): { [key: string]: any }[] => {\n    return _internalTimeline(strings, ...subs).output\n  },\n  {\n    abbreviations: {\n      h: { opacity: 0 },\n      v: { opacity: 1 },\n      p: { opacity: 0.3 },\n      d: { drawSVG: 0 },\n      D: { drawSVG: '0 100%' }\n    }\n  }\n)\n","export default function formulas(\n  strings: TemplateStringsArray,\n  ...rest: any[]\n): string[] {\n  return String.raw(strings, ...rest)\n    .split('\\n')\n    .map((l) => l.trim())\n    .filter((l) => l !== '')\n}\n","import './tailwind.min.css'\nimport './index.css'\nimport * as modern from './themes/modern'\nimport * as principiae from './themes/principiae'\n\nconst themes = {\n  modern,\n  principiae\n}\n\nexport {RenderPresentation, PresentationContext} from './Presentation'\nexport {CitationContext} from './Citations'\nexport {default as AnimateSVG} from './AnimateSVG'\n// export {default as Image} from './Image'\nexport {default as Show} from './Show'\nexport {InlineMath, DisplayMath, m, M} from './LaTeX'\nexport {default as MObject} from './MObject'\nexport {default as Portal} from './Portal'\n// Presentation.js\nexport {default as Notes} from './PresenterNotes'\nexport {range} from './utils'\nexport {timeline, _internalTimeline} from './timeline'\nexport {default as formulas} from './formulas'\nexport {default as Morph} from './Morph'\nexport {getSlidesInfo} from './staticAnalysis'\nexport {themes}\n"],"names":["CitationContext","React","createContext","CitationProvider","bibUrl","citationMap","children","useState","bibliography","setBibliography","useEffect","fetch","then","res","text","result","Citation","parse","bibtex","Provider","value","RenderCite","id","render","useContext","find","e","label","format","template","lang","number","RenderBibliography","sortedEntries","Object","entries","sort","a","b","map","n","entry","html","Notes","global","freeGlobal","Symbol","root","objectProto","nativeObjectToString","symToStringTag","getRawTag","objectToString","isObjectLike","baseGetTag","hasOwnProperty","baseIsArguments","isArray","isArguments","isFlattenable","arrayPush","baseFlatten","range","Array","from","keys","queryParameters","obj","key","encodeURIComponent","join","cacheBust","LaTeX","_preamble","_host","window","location","hostname","getHost","setHost","h","getPreamble","setPreamble","p","normalizeLaTeXPreamble","fetchSVG","tex","cachebust","preamble","ok","json","error","name","Error","latexErrors","message","split","line","trim","filter","elementToPath","child","transform","ownerSVGElement","svg","tagName","offsetX","parseFloat","getAttribute","offsetY","element","querySelector","console","path","pathParse","relNormalize","err","segments","type","newPath","serializePath","tr","x","y","width","height","pathData","groupIdFromElement","fill","slice","svgToGroupedPaths","byGroupId","getElementById","subchild","Boolean","colorHash","str","String","hash","i","length","charCodeAt","colour","toString","substr","toUpperCase","fetchLaTeXSvg","memoize","ele","document","createElement","innerHTML","groups","viewBox","replace","s","_","p1","usePrevious","ref","useRef","current","useLocalStorage","initialValue","item","localStorage","getItem","JSON","log","storedValue","setStoredValue","setValue","valueToStore","Function","setItem","stringify","isBrowser","useIsomorphicLayoutEffect","useLayoutEffect","_svgPathExp","_numbersExp","_scientific","_selectorExp","_DEG2RAD","Math","PI","_RAD2DEG","_sin","sin","_cos","cos","_abs","abs","_sqrt","sqrt","_atan2","_isString","_isNumber","_isUndefined","_roundingNum","_wrapProgress","_round","getRawPath","test","rawPath","_gsPath","_dirty","stringToRawPath","warn","reverseSegment","segment","reverse","reversed","_createPath","ignore","createElementNS","attr","call","attributes","nodeName","toLowerCase","indexOf","setAttributeNS","nodeValue","_typeAttrs","rect","circle","ellipse","_attrToObj","attrs","props","convertToPath","swap","circ","data","r","ry","rcirc","rycirc","points","w","x2","x3","x4","x5","x6","y2","y3","y4","y5","y6","getBBox","rx","cx","cy","x1","y1","match","shift","setAttribute","rawPathToString","_gsRawPath","parentNode","insertBefore","removeChild","arcToSegment","lastX","lastY","angle","largeArcFlag","sweepFlag","angleRad","cosAngle","sinAngle","TWOPI","dx2","dy2","x1_sq","y1_sq","radiiCheck","rx_sq","ry_sq","sq","coef","cx1","cy1","sx2","sy2","ux","uy","vx","vy","temp","angleStart","acos","angleExtent","isNaN","ceil","angleIncrement","controlLength","ma","mb","mc","md","push","d","m","relativeX","relativeY","twoThirds","elements","errorMessage","j","command","isRelative","startX","startY","difX","difY","beziers","prevCommand","flag1","flag2","sx","sy","ex","ey","closed","charAt","pop","totalPoints","l","sl","gsap","_toArray","_lastLinkedAnchor","_doc","_coreInitted","PluginClass","_getGSAP","registerPlugin","atan2","_PI","_2PI","_angleMin","_angleMax","_bigNum","_numExp","_commands","_log","_bonusValidated","_getAverageXY","_getSize","xMax","xMin","yMax","yMin","centerX","centerY","size","_getTotalSize","samplesPerBezier","inc","k","t","inv","left","top","_sortByComplexity","_sortBySize","sizeA","sizeB","_offsetSegment","shapeIndex","wrap","index","_getTotalMovement","sb","eb","_getClosestShapeIndex","checkReverse","sCenter","eCenter","min","minIndex","copy","_getClosestAnchor","closestDistance","closestX","closestY","dx","dy","_getClosestSegment","bezier","pool","startIndex","sortRatio","minSize","splice","_subdivideSegmentQty","quantity","tally","max","newPointsPerSegment","ax","ay","cp1x","cp1y","cp2x","cp2y","bx","by","floor","_equalizeSegmentQuantity","start","end","fillSafe","dif","longer","shorter","added","sortMethod","shapeIndices","_pathFilter","precompile","_offsetPoints","offset","parseInt","_equalizePointQuantity","factor","nextX","nextY","toFixed","_pointsFilter","startNums","endNums","_buildPointsFilter","_parseShape","shape","forcePath","target","isString","_convertToPath","getAttributeNS","_populateSmoothData","tolerance","limit","smooth","a2","isSmooth","smoothData","_parseOriginFactors","v","_shortAngle","_morphMessage","_tweenRotation","linkedPT","so","_origin","eo","_eOrigin","sa","angleDif","_short","ca","_anchorPT","_next","cl","_initCore","required","plugins","morphSVG","utils","toArray","prototype","MorphSVGPlugin","version","register","core","Plugin","init","tween","targets","cs","nodeType","getComputedStyle","fillRule","origins","origin","pt","isPoly","startSmooth","endSmooth","startSeg","endSeg","precompiled","sData","eData","originFactors","useRotation","prop","defaultMap","_prop","_render","defaultRender","_apply","updateTarget","defaultUpdateTarget","_rnd","pow","precision","_tween","_target","defaultType","smoothTolerance","_rawPath","_controlPT","l1s","l1c","l2s","l2c","add","_props","endProp","ratio","controlPT","anchorPT","rnd","_pt","space","easeInOut","kill","property","pathFilter","pointsFilter","getTotalSize","equalizeSegmentQuantity","_win","_isEdge","_windowExists","_types","round","_parseNum","_getAttributeAsNumber","_getDistance","scaleX","scaleY","_warn","_hasNonScalingStroke","_parse","defaultStart","undefined","_getLength","style","bbox","prevPoint","getScreenCTM","c","_ref","strokeDasharray","getTotalLength","_getPosition","dash","strokeDashoffset","navigator","userAgent","DrawSVGPlugin","overage","_style","_length","_dash","_offset","_offsetPT","_dashPT","strokeLinecap","strokeLinejoin","strokeMiterlimit","_live","lengthRatio","getLength","getPosition","animate","svgEl","replaceImediately","TIMING","setSvgData","DEFAULT_TIMING","newPaths","afterIds","beforeIds","querySelectorAll","allIds","Set","Promise","all","opacity","to","duration","isNew","color","colorFromGroupId","whiteListedColors","includes","appendChild","shouldRemove","remove","allColors","convertToTeX","selections","ending","starting","col","lookupAnimationGroups","animationGroups","startGroups","endGroups","AnimationEditor","playedAnimations","animations","setAnimations","colorIndex","setColorIndex","onKeyPress","addEventListener","removeEventListener","newOnes","animation","animated","inDataBase","anim","animationsIShouldShow","useMemo","findIndex","array","className","backgroundColor","onClick","Animation","setAnimation","f","handleSelection","useCallback","sel","getSelection","anchorNode","focusNode","sString","dataset","eString","anchorOffset","focusOffset","part1","part","part2","newAnimation","mergeSelections","removeAllRanges","handleClick","ev","button","determineSelections","activeSelection","preventDefault","group","splitChars","fontFamily","onMouseUp","onContextMenu","background","AutoMorph","steps","step","setStep","Morph","display","useAnimationDatabase","colors","levels","forEach","_c","currentActive","prev","_s","surrounding","wrapMathBasedOnProps","inline","debug","vw","vh","transition","setTransition","FONT_SCALING_FACTOR","updateSvgData","wrapMath","previousChildren","promise","resolve","update","before","after","inner","marginTop","marginRight","verticalAlign","position","outline","flexGrow","margin","Fragment","withFakeDispatcher","ctx","cb","ReactCurrentDispatcher","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","original","context","readContext","useImperativeHandle","useReducer","initialState","initial","useDebugValue","useResponder","useDeferredValue","useTransition","isComponent","node","findElementsInTree","predicate","found","handleTree","resolved","childs","flattenDeep","getPropsRecursiveUntilSlideComponentIsEncountered","RenderSlide","slide","$$typeof","rest","getSlidesInfo","slides","mockContextes","PresentationContext","slideIndex","slidesInfo","info","slideWithProps","infos","accumulatedInfo","newInfo","sectionSlide","section","hideNavigation","header","getCitations","presenterNotes","tree","notes","note","allLaTeX","morphs","defaultResult","_source","contents","formulas","formula","startGrouped","endGrouped","trees","cite","values","RenderPresentation","embed","PresentationEmbedWrapper","Router","Switch","Route","exact","Storage","PresentationRouteWrapper","mode","PresentationOverview","embedOptions","setSlideIndex","stepIndex","setStepIndex","PresentationUI","setSlideAndStep","useRouteMatch","history","useHistory","notify","generatePath","ws","send","WebSocket","onmessage","useParams","slideIndexString","stepIndexString","compileHost","reactSlides","Children","transitions","setTransitions","getNext","getPrev","dontStepButGoToPrevSlide","next","dontStepButGoToNextSlide","handleKey","Clock","transformOrigin","marginBottom","wrappedSlides","threeSlides","presentation","Tabs","Tab","show","setShow","flatMap","_step","hasSteps","setStyle","updateStyle","zIndex","content","whiteSpace","Show","when","realStyle","isValidElement","cloneElement","Presentation","overflow","Slide","slideStyle","bottom","right","borderRadius","SectionSlide","numSlides","ConclusionSlide","TitleSlide","title","names","names2","date","TableOfContentsSlide","sections","QuestionSlide","Figure","caption","List","childArray","Item","listStyle","Cite","hidden","BibliographySlide","stride","items","dangerouslySetInnerHTML","__html","Box","smallTitle","Qed","OverviewSlide","image","styles","activeSection","padding","fontSize","sectionsubtitle","positionSvg","textSvg","scaleString","scale","textXString","textX","textYString","textY","replaceText","textEle","textContent","matrix","replaceChild","wrapper","startsWith","css","set","seconds","memoizedFetch","src","AnimateSVG","div","matches","g","el","InlineMath","DisplayMath","subtitutions","raw","M","measureText","body","clientWidth","clientHeight","MObject","setChild","setOpacity","setWidth","setTimeout","getRect","offsetLeft","offsetTop","offsetParent","classList","contains","offsetWidth","offsetHeight","parentWidth","parentHeight","addPortal","portal","enlarge","shrink","newTransitions","zoom","Portal","zoomin","zoomout","useResizeObserver","onResize","_internalTimeline","strings","subs","defaultAbbreviations","timeline","abbreviations","translate","sub","fillWithLastUntilHasLength","last","lines","firsts","charactersInterpreted","trimmed","splitted","numbers","nextChar","rangeInBetween","numberOfUnexpandedSteps","expanded","expandedSteps","numberOrNumbers","translated","output","fromEntries","lengths","assign","drawSVG","D","themes","modern","principiae"],"mappings":"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"}